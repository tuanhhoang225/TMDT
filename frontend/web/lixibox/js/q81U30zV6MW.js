if (self.CavalryLogger) { CavalryLogger.start_js(["O121C"]); }

__d("FundsAvailability",[],(function(a,b,c,d,e,f){e.exports={NONE:0,FUNDS_AVAILABILITY_NA:65,FUNDS_AVAILABILITY_IMMEDIATE:73,FUNDS_AVAILABILITY_SAME_DAY:83,FUNDS_AVAILABILITY_NEXT_DAY:78,FUNDS_AVAILABILITY_FIVE_DAY:70,FUNDS_AVAILABILITY_UNKNOWN:85,FUNDS_AVAILABILITY_ONE_THREE_DAY:79,FUNDS_AVAILABILITY_CROSS_BORDER:66,FUNDS_AVAILABILITY_CROSS_BORDER_FAST_FUNDS:67,FUNDS_AVAILABILITY_DOMESTIC:68,FUNDS_AVAILABILITY_DOMESTIC_FAST_FUNDS:69}}),null);
__d("IrisProtocolMessageLifetime",[],(function(a,b,c,d,e,f){e.exports={TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:3e4,TTL_1MINUTE:6e4,TTL_3MINUTES:18e4,TTL_5MINUTES:3e5,TTL_10MINUTES:6e5,TTL_15MINUTES:9e5,TTL_30MINUTES:18e5,TTL_1HOUR:36e5,TTL_2HOURS:72e5,TTL_4HOURS:144e5,TTL_8HOURS:288e5,TTL_12HOURS:432e5,TTL_24HOURS:864e5}}),null);
__d("MercuryAPIArgsSource",[],(function(a,b,c,d,e,f){e.exports={CHAT:"chat",JEWEL:"jewel",MERCURY:"mercury",MERCURYSYNC:"mercury_sync",WEBMESSENGER:"web_messenger",MESSENGER:"messenger"}}),null);
__d("MercuryAudioType",[],(function(a,b,c,d,e,f){e.exports={AudioClip:"fb_voice_message",VoiceMessageWithTranscript:"fb_voice_message_with_transcript"}}),null);
__d("MessageLiveLocationClientSyncProtocolStopReason",[],(function(a,b,c,d,e,f){e.exports={EXPIRED:1,CANCELED:2,ARRIVED:3}}),null);
__d("MessagingTag",[],(function(a,b,c,d,e,f){e.exports={GROUPS:"groups",UNREAD:"unread",FLAGGED:"flagged",ACTION_ARCHIVED:"action:archived",INBOX:"inbox",OTHER:"other",PENDING:"pending",MONTAGE:"montage",PAGES:"pages",PAGE_BACKGROUND:"page_background",EVENT:"event",SENT:"sent",SPAM:"spam",UPDATES:"broadcasts_inbox",BCC:"header:bcc",FILTERED_CONTENT:"filtered_content",FILTERED_CONTENT_BH:"filtered_content_bh",FILTERED_CONTENT_ACCOUNT:"filtered_content_account",FILTERED_CONTENT_QUASAR:"filtered_content_quasar",FILTERED_CONTENT_INVALID_APP:"filtered_content_invalid_app",UNAVAILABLE_ATTACHMENT:"unavailable_attachment",ARCHIVED:"archived",EMAIL:"email",VOICEMAIL:"voicemail",SPAM_SPOOFING:"spam:spoofing",SPOOF_WARNING:"MTA:spoof_warning",SMS_TAG_ROOT:"SMSShortcode:",APP_ID_ROOT:"app_id:",DOMAIN_AUTH_PASS:"MTA:dmarc:pass",DOMAIN_AUTH_FAIL:"MTA:dmarc:fail",MTA_SYSTEM_MESSAGE:"MTA:system_message",EMAIL_MESSAGE:"source:email",ONE_CLICK_MESSAGE:"page_one_click_message",MARKETPLACE:"marketplace",ROOM:"room",PAGE_FOLLOWUP:"page_followup",MESSAGE_REQUEST_AGGREGATION_UNIT:"message_request_aggregation_unit",IRIS_MAPPING:{FOLDER_INVALID:null,FOLDER_INBOX:"inbox",FOLDER_OTHER:"other",FOLDER_SPAM:"spam",FOLDER_PENDING:"pending",FOLDER_MONTAGE:"montage",FOLDER_HIDDEN:"hidden",FOLDER_DISABLED:"disabled",FOLDER_PAGE_BACKGROUND:"page_background",FOLDER_PAGE_DONE:"page_done",FOLDER_BLOCKED:"blocked"}}}),null);
__d("MessengerView",[],(function(a,b,c,d,e,f){e.exports={DETAIL:{COMPOSE:"detail/compose",THREAD:"detail/thread",PAYTHREAD:"detail/paythread",PAYFRIENDPICKER:"detail/payfriendpicker"},MASTER:{PAYMENT:"master/payment",PEOPLE:"master/people",RECENT:"master/recent",SUPPORT:"master/support",SEARCH:"master/search"}}}),null);
__d("PageCommItemStatus",[],(function(a,b,c,d,e,f){e.exports={FOLLOW_UP:"FOLLOW_UP",DONE:"DONE",TODO:"TODO",SPAM:"SPAM"}}),null);
__d("StickerConstants",[],(function(a,b,c,d,e,f){e.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",OZ_PACK_ID:"1456625217993235",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120}}),null);
__d("CallbackManagerController",["ErrorUtils"],(function(a,b,c,d,e,f){__p&&__p();function a(a){"use strict";this.$1=[],this.$2=[undefined],this.$3=a}a.prototype.executeOrEnqueue=function(a,b,c){"use strict";c=c||{};var d=this.$4(b,a,c);if(d)return 0;this.$2.push({fn:b,request:a,options:c});d=this.$2.length-1;this.$1.push(d);return d};a.prototype.unsubscribe=function(a){"use strict";delete this.$2[a]};a.prototype.reset=function(){"use strict";this.$2=[]};a.prototype.getRequest=function(a){"use strict";return this.$2[a]};a.prototype.runPossibleCallbacks=function(a){"use strict";__p&&__p();var b=this.$1;this.$1=[];var c=[];b.forEach(function(b){var d=this.$2[b];if(!d)return;d=this.$3(d.request,babelHelpers["extends"]({},d.options,a));d?c.push({args:d,id:b}):this.$1.push(b)}.bind(this));c.forEach(function(a){var b=a.args;a=a.id;var c=this.$2[a];if(!c)return;delete this.$2[a];this.$5(c.fn,b,c.request)}.bind(this))};a.prototype.$4=function(a,b,c){"use strict";c=this.$3(b,c);c&&this.$5(a,c,b);return!!c};a.prototype.$5=function(a,c,d){"use strict";d={ids:d};b("ErrorUtils").applyWithGuard(a,d,c)};e.exports=a}),18);
__d("KeyedCallbackManager",["CallbackManagerController","ErrorUtils"],(function(a,b,c,d,e,f){__p&&__p();function a(){"use strict";this.$1={},this.$2=new(b("CallbackManagerController"))(this.$3.bind(this))}a.prototype.executeOrEnqueue=function(a,c){"use strict";__p&&__p();if(!(a instanceof Array)){var d=a,e=c;a=[a];c=function(a){e(a[d])}}a=a.filter(function(a){var c=a!==null&&a!==undefined;c||b("ErrorUtils").applyWithGuard(function(){throw new Error("KeyedCallbackManager.executeOrEnqueue: key "+JSON.stringify(a)+" is invalid")});return c});return this.$2.executeOrEnqueue(a,c)};a.prototype.unsubscribe=function(a){"use strict";this.$2.unsubscribe(a)};a.prototype.reset=function(){"use strict";this.$2.reset(),this.$1={}};a.prototype.getUnavailableResources=function(a){"use strict";a=this.$2.getRequest(a);var b=[];a&&(b=a.request.filter(function(a){return!this.$1[a]}.bind(this)));return b};a.prototype.getUnavailableResourcesFromRequest=function(a){"use strict";a=Array.isArray(a)?a:[a];return a.filter(function(a){if(a!==null&&a!==undefined)return!this.$1[a]},this)};a.prototype.addResourcesAndExecute=function(a){"use strict";Object.assign(this.$1,a),this.$2.runPossibleCallbacks()};a.prototype.setResource=function(a,b){"use strict";this.$1[a]=b,this.$2.runPossibleCallbacks()};a.prototype.getResource=function(a){"use strict";return this.$1[a]};a.prototype.getAllResources=function(){"use strict";return this.$1};a.prototype.dumpResources=function(){"use strict";var a={};for(var b in this.$1){var c=this.$1[b];typeof c==="object"&&(c=babelHelpers["extends"]({},c));a[b]=c}return a};a.prototype.$3=function(a){"use strict";var b={};for(var c=0;c<a.length;c++){var d=a[c],e=this.$1[d];if(typeof e=="undefined")return!1;b[d]=e}return[b]};e.exports=a}),18);
__d("BaseAsyncLoader",["KeyedCallbackManager","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g={};function h(a,c,d){__p&&__p();var e=new(b("KeyedCallbackManager"))(),f=!1,g=[];function h(){if(!g.length||f)return;f=!0;b("setTimeoutAcrossTransitions")(j,0)}function i(a){f=!1,a.forEach(e.unsubscribe.bind(e)),h()}function j(){__p&&__p();var b={},c=[];g=g.filter(function(a){var d=e.getUnavailableResources(a);if(d.length){d.forEach(function(a){b[a]=!0});c.push(a);return!0}return!1});var h=Object.keys(b);h.length?d(a,h,c,k.bind(null,c),l.bind(null,c)):f=!1}function k(a,b){b=b.payload[c]||b.payload;e.addResourcesAndExecute(b);i(a)}function l(a){i(a)}return{get:function(a,b){a=e.executeOrEnqueue(a,b);b=e.getUnavailableResources(a);b.length&&(g.push(a),h())},getCachedKeys:function(){return Object.keys(e.getAllResources())},getNow:function(a){return e.getResource(a)||null},set:function(a){e.addResourcesAndExecute(a)}}}function a(a,b){throw new Error("BaseAsyncLoader can't be instantiated")}Object.assign(a.prototype,{_getLoader:function(){g[this._endpoint]||(g[this._endpoint]=h(this._endpoint,this._type,this.send));return g[this._endpoint]},get:function(a,b){return this._getLoader().get(a,b)},getCachedKeys:function(){return this._getLoader().getCachedKeys()},getNow:function(a){return this._getLoader().getNow(a)},reset:function(){g[this._endpoint]=null},set:function(a){this._getLoader().set(a)}});e.exports=a}),18);
__d("AjaxLoader",["AsyncRequest","BaseAsyncLoader","LogHistory"],(function(a,b,c,d,e,f){__p&&__p();var g=b("LogHistory").getInstance("ajax_loader");function a(a,b){this._endpoint=a,this._type=b}Object.assign(a.prototype,b("BaseAsyncLoader").prototype);a.prototype.send=function(a,c,d,e,f){new(b("AsyncRequest"))().setURI(a).setData({ids:c}).setMethod("POST").setReadOnly(!0).setAllowCrossPageTransition(!0).setHandler(function(a){e(a)}).setTimeoutHandler(10*1e3,function(a){f(),g.error("fetch_timeout","{}")}).setErrorHandler(function(a){f(),g.error("fetch_error",JSON.stringify({error_type:a.errorSummary,error_text:a.errorDescription}))}).send()};e.exports=a}),null);
__d("XChatUserInfoAllAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/chat/user_info_all/",{viewer:{type:"Int",required:!0}})}),null);
__d("ShortProfilesBootstrapper",["Promise","AsyncRequest","BanzaiODS","CurrentUser","JSLogger","XChatUserInfoAllAsyncController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=5,h=1e4,i=b("XChatUserInfoAllAsyncController").getURIBuilder().setInt("viewer",b("CurrentUser").getID()).getURI(),j=b("JSLogger").create("short_profiles");function a(a){this.$1=a,this.$2=new(b("Promise"))(function(a,b){this.$3=a,this.$4=b}.bind(this)),this.$5=!1,this.$6=null,this.$7=0,this.$8=0,this.$9=0,this.$10=!1,this.$11=!1}a.prototype.fetchAll=function(){__p&&__p();this.$12();if(this.$5||this.$6)return this.$2;if(this.$7>=g){this.$13();return this.$2}this.$7++;this.$14();this.$6=new(b("AsyncRequest"))(i).setHandler(function(a){this.$6=null,this.$5=!0,this.$15(),this.$1(a.payload),this.$3()}.bind(this)).setErrorHandler(function(){this.$6=null,this.$8++,this.$16()}.bind(this)).setTimeoutHandler(h,function(){this.$6=null,this.$9++,this.$17(),this.fetchAll()}.bind(this)).setAllowCrossPageTransition(!0);this.$6.send();return this.$2};a.prototype.isBootstrapped=function(){return this.$5};a.prototype.isBootstrapping=function(){return!!this.$6};a.prototype.getAttemptCount=function(){return this.$7};a.prototype.getErrorCount=function(){return this.$8};a.prototype.getTimeoutCount=function(){return this.$9};a.prototype.$12=function(){this.$10||(j.log("bootstrap_start"),b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.starts"),this.$10=!0)};a.prototype.$14=function(){j.log("bootstrap_attempt"),b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.attempts")};a.prototype.$15=function(){j.log("bootstrap_success"),b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.successes"),this.$7>1&&b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.successes_after_retries")};a.prototype.$16=function(){j.log("bootstrap_error"),b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.errors")};a.prototype.$17=function(){j.log("bootstrap_timeout"),b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.timeouts")};a.prototype.$13=function(){this.$11||(j.log("bootstrap_giveup"),b("BanzaiODS").bumpEntityKey("chat.web","typeahead.bootstrap.giveups"),this.$11=!0,this.$4())};e.exports=a}),null);
__d("XChatUserInfoAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/chat/user_info/",{ids:{type:"IntVector",defaultValue:[]}})}),null);
__d("ShortProfiles",["AjaxLoader","Arbiter","JSLogger","ShortProfilesBootstrapper","XChatUserInfoAsyncController","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=null,h=new(b("AjaxLoader"))(b("XChatUserInfoAsyncController").getURIBuilder().getURI().toString(),"profiles"),i={get:function(a,b){this.getMulti([a],function(c){return b(c[a],a)})},getMulti:function(a,c){h.get(a,c||b("emptyFunction"))},getNow:function(a){return h.getNow(a)||null},getMultiNow:function(a){var b={};a.forEach(function(a){return b[a]=i.getNow(a)});return b},getCachedProfileIDs:function(){return h.getCachedKeys()},hasAll:function(){return!!g&&g.isBootstrapped()},fetchAll:function(){g||(g=new(b("ShortProfilesBootstrapper"))(function(a){h.set(a)}));return g.fetchAll()},set:function(a,b){var c={};c[a]=b;this.setMulti(c)},setMulti:function(a){h.set(a)}};b("Arbiter").subscribe(b("JSLogger").DUMP_EVENT,function(a,c){a=i.getCachedProfileIDs();var d=b("JSLogger").getEntries(function(a){return a.cat=="short_profiles"||a.cat=="chat_typeahead"});c.chat_typeahead={bootstrapped:g&&g.isBootstrapped(),bootstrapping:g&&g.isBootstrapping(),bootstrap_attempts:g&&g.getAttemptCount(),bootstrap_errors:g&&g.getErrorCount(),bootstrap_timeouts:g&&g.getTimeoutCount(),entries:a,entry_count:a.length,history:d}});e.exports=i}),null);
__d("EmoticonEmojiList",[],(function(a,b,c,d,e,f){e.exports={names:{":)":"slightsmile",":-)":"slightsmile",":]":"slightsmile","=)":"smile","(:":"slightsmile","(=":"smile",":(":"frown",":-(":"frown",":[":"frown","=(":"frown",")=":"frown",";-P":"winktongue",";P":"winktongue",";-p":"winktongue",";p":"winktongue",":poop:":"poop",":P":"tongue",":-P":"tongue",":-p":"tongue",":p":"tongue","=P":"tongue","=p":"tongue","=D":"grin",":-D":"slightgrin",":D":"slightgrin",":o":"gasp",":-O":"gasp",":O":"gasp",":-o":"gasp",";)":"wink",";-)":"wink","8-)":"glasses","8)":"glasses","B-)":"glasses","B)":"glasses",">:(":"grumpy",">:-(":"grumpy",":/":"unsure",":-/":"unsure",":\\":"unsure",":-\\":"unsure","=/":"unsure","=\\":"unsure",":'(":"cry",":'-(":"cry",":\u2019(":"cry",":\u2019-(":"cry","3:)":"devil","3:-)":"devil","O:)":"angel","O:-)":"angel","0:)":"angel","0:-)":"angel",":*":"kiss",":-*":"kiss",";-*":"winkkiss",";*":"winkkiss","<3":"heart","&lt;3":"heart","\u2665":"heart","^_^":"kiki","^~^":"kiki","-_-":"expressionless",":-|":"squint",":|":"squint",">:o":"upset",">:O":"upset",">:-O":"upset",">:-o":"upset",">_<":"persevere",">.<":"persevere",'<(")':"penguin",O_O:"flushface",o_o:"flushface","0_0":"flushface",T_T:"crying","T-T":"crying",ToT:"crying","T.T":"crying","-3-":"flushkiss","'-_-":"sweating","\u2019-_-":"sweating","(y)":"like",":like:":"like","(Y)":"like","(n)":"dislike","(N)":"dislike"},emote2emojis:{slightsmile:"1f642",smile:"1f60a",frown:"1f61e",winktongue:"1f61c",poop:"1f4a9",tongue:"1f61b",slightgrin:"1f600",grin:"1f603",gasp:"1f62e",wink:"1f609",glasses:"1f60e",grumpy:"1f620",unsure:"1f615",cry:"1f622",devil:"1f608",angel:"1f607",kiss:"1f617",winkkiss:"1f618",heart:"2764",kiki:"1f60a",expressionless:"1f611",squint:"1f610",upset:"1f620",persevere:"1f623",penguin:"1f427",flushface:"1f633",crying:"1f62d",flushkiss:"1f61a",sweating:"1f613",like:"f0000",dislike:"1f44e"},symbols:{slightsmile:":)",smile:"=)",frown:":(",winktongue:";-P",poop:":poop:",tongue:":P",slightgrin:":D",grin:"=D",gasp:":o",wink:";)",glasses:"8-)",grumpy:">:(",unsure:":/",cry:":'(",devil:"3:)",angel:"O:)",kiss:":*",winkkiss:";*",heart:"<3",kiki:"^_^",expressionless:"-_-",squint:":-|",upset:">:o",persevere:">_<",penguin:'<(")',flushface:"O_O",crying:"T_T",flushkiss:"-3-",sweating:"'-_-",like:"(y)",dislike:"(n)"},regexp:/(^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))([\s\'\".,!?]|<br>|$)/,noncapturingRegexp:/(?:^|[\s\'\".])(:\)(?!\))|:\-\)(?!\))|:\]|=\)(?!\))|\(:|\(=|:\(|:\-\(|:\[|=\(|\)=|;P|;\-P|;\-p|;p|:poop:|:P|:\-P|:\-p|:p|=P|=p|=D|:\-D|:D|:o|:\-O|:O|:\-o|;\)(?!\))|;\-\)(?!\))|8\-\)(?!\))|B\-\)(?!\))|B\)(?!\))|8\)(?!\))|>:\(|>:\-\(|:\/|:\-\/|:\\|:\-\\|=\/|=\\|:\'\(|:\'\-\(|:\u2019\(|:\u2019\-\(|3:\)(?!\))|3:\-\)(?!\))|O:\)(?!\))|O:\-\)(?!\))|0:\)(?!\))|0:\-\)(?!\))|:\*|:\-\*|;\*|;\-\*|<3|&lt;3|\u2665|\^_\^|\^~\^|\-_\-|:\-\||:\||>:o|>:O|>:\-O|>:\-o|>_<|>\.<|<\(\"\)(?!\))|O_O|o_o|0_0|T_T|T\-T|ToT|T\.T|\-3\-|\'\-_\-|\u2019\-_\-|\(y\)(?!\))|:like:|\(Y\)(?!\))|\(n\)(?!\))|\(N\)(?!\)))(?:[\s\'\".,!?]|<br>|$)/}}),null);
__d("MessengerHotlikeEmoji.bs",[],(function(a,b,c,d,e,f){"use strict";var g="f0000";function a(a){return a===g}f.hotlike_key=g;f.isMessengerHotlike=a}),null);
__d("Utf16",[],(function(a,b,c,d,e,f){a={decode:function(a){switch(a.length){case 1:return a.charCodeAt(0);case 2:return 65536|(a.charCodeAt(0)-55296)*1024|a.charCodeAt(1)-56320;default:return null}},encode:function(a){if(a<65536)return String.fromCharCode(a);else return String.fromCharCode(55296+(a-65536>>10))+String.fromCharCode(56320+a%1024)}};e.exports=a}),null);
__d("messengerIterateEmoji",["MessengerSupportedEmoji","ifRequired"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e){__p&&__p();var f=String(a);while(f){a=b("ifRequired")("MessengerSupportedEmojiUtils",function(a){return a.getEmojiMatchObj(f)},function(){return b("MessengerSupportedEmoji").getEmojiMatchObj(f)});if(a){var g=a.offset+a.length,h=f.substr(0,a.is_supported?a.offset:g);d(h);a.is_supported&&c(a.emoji_str,a.emoji_key,e);h=f.substr(g);f=h}else break}d(f)}e.exports=a}),null);
__d("messengerIterateEmoticons",["EmoticonEmojiList"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e){var f,g,h;a=String(a);while(a){var i=b("EmoticonEmojiList").regexp.exec(a);if(i)f=i.index+i[1].length,g=a.substr(0,f),i=i[2],f=a.substr(f+i.length),h=b("EmoticonEmojiList").names[i],d(g),c(i,h,e),a=f;else break}d(a)}e.exports=a}),null);
__d("MessengerTextWithEmoticons.react",["cx","fbt","BaseTextWithDecoration.react","EmojiImageURL","EmoticonEmojiList","MessengerHotlikeEmoji.bs","Image.react","React","gkx","messengerIterateEmoji","messengerIterateEmoticons"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;function j(a,c,d,e){var f=e?128:16;a=b("gkx")("AT7ffoM8gf91Fer7cUMkwGH62Vum20vkKo_AIqUOx27bu9y21PoFYcSzgDJj_KAeh5RgHmHKzv6c5n2RlIxDAfXE")&&!a&&!b("MessengerHotlikeEmoji.bs").isMessengerHotlike(d)?b("EmojiImageURL").getFBEmojiURL(d,f):b("EmojiImageURL").getMessengerURL(d,f);d=e?"_1ift _5m3a":"_1ift _2560";return b("React").createElement(b("Image.react"),{alt:c,className:d,src:a})}function k(a,c,d){var e=d?128:16,f=b("EmoticonEmojiList").emote2emojis[c],g=f?b("gkx")("AT7ffoM8gf91Fer7cUMkwGH62Vum20vkKo_AIqUOx27bu9y21PoFYcSzgDJj_KAeh5RgHmHKzv6c5n2RlIxDAfXE")&&!b("MessengerHotlikeEmoji.bs").isMessengerHotlike(f)?b("EmojiImageURL").getFBEmojiURL(f,e):b("EmojiImageURL").getMessengerURL(f,e):null;if(g){f=String.fromCodePoint(parseInt(f,e));e=d?"_1ift _5m3a":"_1ift _2560";return b("React").createElement(b("Image.react"),{alt:f,className:e,src:g})}d=h._("{emoticonName} emoticon",[h._param("emoticonName",c)]);return b("React").createElement("span",{"aria-label":d},a)}function l(a,b,c){return function(d,e,f){var g=function(c,d,a){e(b(c,d,a))};a(String(d),g,f,c)}}i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.shouldComponentUpdate=function(a){return a.text!==this.props.text};a.prototype.render=function(){var a=[l(b("messengerIterateEmoji"),j.bind(null,!!this.props.forceMessengerEmoji),this.props.customSize),l(b("messengerIterateEmoticons"),k,this.props.customSize)];return b("React").createElement(b("BaseTextWithDecoration.react"),babelHelpers["extends"]({},this.props,{text:this.props.text,decorators:a}))};function a(){i.apply(this,arguments)}a.propTypes={text:c.string,customSize:c.bool,forceMessengerEmoji:c.bool};e.exports=a}),null);
__d("MessengerTextWithEntities.react",["Link.react","React","BaseTextWithEntities.react","MessengerTextWithEmoticons.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;function h(a){return a.replace(/<3\b|&hearts;/g,"\u2665")}c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){if(this.props.renderEmoticons||this.props.renderEmoji)return b("React").createElement(b("MessengerTextWithEmoticons.react"),{text:a,customSize:this.props.customSize,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji});else return h(a)}.bind(this),this.$2=function(a,c){if(this.props.interpolator)return this.props.interpolator(a,c);else return b("React").createElement(b("Link.react"),{href:c.entity},a)}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("BaseTextWithEntities.react"),babelHelpers["extends"]({},this.props,{aggregatedRanges:this.props.aggregatedRanges,imageRanges:this.props.imageRanges,metaRanges:this.props.metaRanges,rangeRenderer:this.$2,ranges:this.props.ranges,text:this.props.text,textRenderer:this.$1}))};e.exports=a}),null);
__d("EventReminderConstants",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({INITIAL:"initial",GOING:"going",WATCHED:"watched",UNWATCHED:"unwatched"});b=Object.freeze({ASSOCIATED_EVENT:"ASSOCIATED_EVENT"});c=Object.freeze({GOING:"GOING",DECLINED:"DECLINED",INVITED:"INVITED"});d=Object.freeze({NO_ERROR:"NO_ERROR",PAST_TIME:"PAST_TIME",AFTER_ONE_YEAR:"AFTER_ONE_YEAR"});e.exports={EventGuestStates:a,EventPlanType:b,GuestStates:c,TimeErrorType:d}}),null);
__d("IgnoreMessagesTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:IgnoreMessagesLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:IgnoreMessagesLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:IgnoreMessagesLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setPlatform=function(a){this.$1.platform=a;return this};a.prototype.setThreadID=function(a){this.$1.thread_id=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={event:!0,platform:!0,thread_id:!0,vc:!0};e.exports=a}),null);
__d("MercurySyncHolesTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setDifference=function(a){this.$1.difference=a;return this};a.prototype.setSeqID=function(a){this.$1.seq_id=a;return this};a.prototype.setTopicType=function(a){this.$1.topic_type=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={difference:!0,seq_id:!0,topic_type:!0,vc:!0};e.exports=a}),null);
__d("MessengerLiveChatPluginTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MessengerLiveChatPluginLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MessengerLiveChatPluginLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MessengerLiveChatPluginLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppID=function(a){this.$1.app_id=a;return this};a.prototype.setAttribution=function(a){this.$1.attribution=a;return this};a.prototype.setCallsite=function(a){this.$1.callsite=a;return this};a.prototype.setDebugData=function(a){this.$1.debug_data=a;return this};a.prototype.setDeltaType=function(a){this.$1.delta_type=a;return this};a.prototype.setDeviceParam=function(a){this.$1.device_param=a;return this};a.prototype.setDomainSource=function(a){this.$1.domain_source=a;return this};a.prototype.setDuration=function(a){this.$1.duration=a;return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setEventTimestamp=function(a){this.$1.event_timestamp=a;return this};a.prototype.setExceptionMessage=function(a){this.$1.exception_message=a;return this};a.prototype.setExceptionStacktrace=function(a){this.$1.exception_stacktrace=a;return this};a.prototype.setExceptionType=function(a){this.$1.exception_type=a;return this};a.prototype.setGateway=function(a){this.$1.gateway=a;return this};a.prototype.setLoggedInGreeting=function(a){this.$1.logged_in_greeting=a;return this};a.prototype.setLoggedOutGreeting=function(a){this.$1.logged_out_greeting=a;return this};a.prototype.setPageID=function(a){this.$1.page_id=a;return this};a.prototype.setRefererURI=function(a){this.$1.referer_uri=a;return this};a.prototype.setRequestHeaders=function(a){this.$1.request_headers=a;return this};a.prototype.setRequestID=function(a){this.$1.request_id=a;return this};a.prototype.setRequestParam=function(a){this.$1.request_param=a;return this};a.prototype.setSyncToken=function(a){this.$1.sync_token=a;return this};a.prototype.setThemeColor=function(a){this.$1.theme_color=a;return this};a.prototype.setUserFbid=function(a){this.$1.user_fbid=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={app_id:!0,attribution:!0,callsite:!0,debug_data:!0,delta_type:!0,device_param:!0,domain_source:!0,duration:!0,event:!0,event_timestamp:!0,exception_message:!0,exception_stacktrace:!0,exception_type:!0,gateway:!0,logged_in_greeting:!0,logged_out_greeting:!0,page_id:!0,referer_uri:!0,request_headers:!0,request_id:!0,request_param:!0,sync_token:!0,theme_color:!0,user_fbid:!0,vc:!0};e.exports=a}),null);
__d("MqttWsClientTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MqttWsClientLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setDeltasInBatch=function(a){this.$1.deltas_in_batch=a;return this};a.prototype.setFirstSeqID=function(a){this.$1.first_seq_id=a;return this};a.prototype.setLastSeqID=function(a){this.$1.last_seq_id=a;return this};a.prototype.setSeqID=function(a){this.$1.seq_id=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={deltas_in_batch:!0,first_seq_id:!0,last_seq_id:!0,seq_id:!0,vc:!0};e.exports=a}),null);
__d("MercuryMessageClientState",[],(function(a,b,c,d,e,f){a=Object.freeze({DO_NOT_SEND_TO_SERVER:"do_not_send_to_server",SEND_TO_SERVER:"send_to_server"});e.exports=a}),null);
__d("MercuryActionType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({LOG_MESSAGE:"ma-type:log-message",USER_GENERATED_MESSAGE:"ma-type:user-generated-message",ADD_GROUP_ADMINS:"ma-type:add_group_admins",REMOVE_GROUP_ADMINS:"ma-type:remove_group_admins",CHANGE_READ_STATUS:"ma-type:change_read_status",MARK_THREAD_SEEN:"ma-type:mark_thread_seen",CHANGE_MUTE_SETTINGS:"ma-type:change-mute-settings",SEND_MESSAGE:"ma-type:send-message",DELETE_MESSAGES:"ma-type:delete-messages",DELETE_THREAD:"ma-type:delete-thread",UPDATE_SNIPPET:"ma-type:update-snippet",CHANGE_ARCHIVED_STATUS:"ma-type:change-archived-status",CHANGE_PAGE_FOLLOW_UP_STATUS:"ma-type:change-page-follow-up-status",CHANGE_FOLDER:"ma-type:change-folder",ADD_PARTICIPANTS:"ma-type:add-participants",CANCEL_ATTACHMENT_PLACEHOLDER:"ma-type:cancel-attachment-placeholder",CONFIRM_ATTACHMENT_PLACEHOLDER:"ma-type:confirm-attachment-placeholder",CHANGE_FLAG:"ma-type:change_flag",MOVE_PENDING_TO_INBOX:"ma-type:move_pending_to_inbox",CREATE_PAGE_ADMIN_NOTE:"ma-type:create-page-admin-note",REPLACE_MESSAGE:"ma-type:replace-message",UPDATE_CUSTOM_LIKE:"ma-type:update_custom_like",UNWRAP_MESSAGE:"ma-type:unwrap-message",JOINABLE_MODE:"ma-type:joinable-mode",APPROVAL_MODE:"ma-type:approval-mode",APPROVAL_QUEUE:"ma-type:approval-queue",IS_PIN_PROTECTED:"ma-type:is_pin_protected",REACTION_UPDATE:"ma-type:reaction-update",LIVE_LOCATION_UPDATE:"ma-type:live-location-update",UPDATE_RTC_CALL_DATA:"ma-type:update-rtc-call-data",UPDATE_COMM_STATUS:"ma-type:update-comm-status",EVENT_RSVP_CHANGED:"ma-type:event-rsvp-changed",BLOCK_STATUS_CHANGED:"ma-type:block-status-changed",UPDATE_COMM_ITEM_OWNER:"ma-type:update-comm-item-owner",MONTAGE_DIRECT_EXPIRE:"ma-type:montage-direct-expire",GROUPS_SYNC_STATUS_CHANGED:"ma-type:groups-sync-status-changed",GROUPS_SYNC_METADATA_UPDATE:"ma-type:groups-sync-metadata-update"})}),null);
__d("MercurySingletonMixin",["CurrentUser"],(function(a,b,c,d,e,f){a={_getInstances:function(){this._instances||(this._instances={});return this._instances},get:function(){return this.getForFBID(b("CurrentUser").getID())},getForFBID:function(a){var b=this._getInstances();b[a]||(b[a]=new this(a));return b[a]}};e.exports=a}),null);
__d("MercuryMessageActions",["Bootloader","ChatConfig","MercuryActionType","MercuryDispatcher","MercuryMessageObject","MercuryPayloadSource","MercuryServerRequests","MercurySingletonMixin"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=b("MercuryMessageObject").getForFBID(this.$1),this.__serverRequests=b("MercuryServerRequests").getForFBID(this.$1),this.__dispatcher=b("MercuryDispatcher").getForFBID(this.$1)}a.prototype.send=function(a,c,d){c=c||Function.prototype,this.$2.normalizeNewMessage(a),this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload(babelHelpers["extends"]({},a),b("MercuryPayloadSource").CLIENT_SEND_MESSAGE)),this.__serverRequests.sendNewMessage(a,d),c(a.thread_id)};a.prototype.resend=function(a,b){a=babelHelpers["extends"]({},a);this.$2.normalizeResendMessage(a);this.send(a,undefined,b)};a.prototype.addAttachmentPlaceholder=function(a,c,d){this.$2.normalizeAddAttachmentPlaceholder(a,c,d),this.$2.normalizeNewMessage(a),this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload(babelHelpers["extends"]({},a),b("MercuryPayloadSource").CLIENT_SEND_MESSAGE))};a.prototype.cancelAttachmentPlaceholder=function(a,c){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({upload_id:a,upload_data:c,action_type:b("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER},b("MercuryPayloadSource").CLIENT_SEND_MESSAGE))};a.prototype.confirmAttachmentPlaceholder=function(a,c){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({upload_id:a,upload_data:c,action_type:b("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER},b("MercuryPayloadSource").CLIENT_SEND_MESSAGE))};a.prototype["delete"]=function(a,c,d){this.__dispatcher.handleUpdate(this.$3(a,c,b("MercuryActionType").DELETE_MESSAGES,d||b("MercuryPayloadSource").CLIENT_DELETE_MESSAGES))};a.prototype.unwrap=function(a){this.__dispatcher.handleUpdate(this.__constructClientSingleMessagePayload({thread_id:a.thread_id,unwrapped_message_id:a.message_id,action_type:b("MercuryActionType").UNWRAP_MESSAGE},b("MercuryPayloadSource").CLIENT_UNWRAP_MESSAGE))};a.prototype.__constructClientSingleMessagePayload=function(a,b){return{actions:[a],from_client:!0,payload_source:b}};a.prototype.$4=function(a,b){return{actions:[a],from_client:!1,payload_source:b}};a.prototype.$3=function(a,b,c,d){return{actions:[{action_type:c,thread_id:a,message_ids:b}],from_client:!0,payload_source:d}};Object.assign(a,b("MercurySingletonMixin"));e.exports=a}),null);
__d("EmojiLikeConstants",["EmojiStaticConfig"],(function(a,b,c,d,e,f){"use strict";a=b("EmojiStaticConfig").sizeMap;c=Object.freeze({XSMALL:"xsmall",SMALL:"small",MEDIUM:"medium",LARGE:"large"});d={dp16:"xsmall",dp32:"small",dp64:"medium",db64:"medium",dp128:"large"};f=Object.freeze({PICKER:"picker",HOT_LIKE:"hot_like"});b=[983040];var g="hot_emoji_source",h="hot_emoji_size",i="emoji_like",j="\ud83d\udc4d",k=[128077];e.exports={FB_THUMBS_UP_EMOJI:b,size:c,sizeMap:a,sizeMapTransfer:d,source:f,SOURCE_TAG_PREFIX:g,TAG_PREFIX_NEW:h,TAG_PREFIX_OLD:i,THUMBS_UP_EMOJI:j,THUMBS_UP_EMOJI_CODES:k}}),null);
__d("MercuryIDs",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={isValid:function(a){return!a||typeof a!=="string"?!1:/^\w{3,12}:.+/.test(a)},isValidThreadID:function(a){if(!g.isValid(a))return!1;a=g.tokenize(a);switch(a.type){case"user":case"group":case"support":case"thread":case"root":case"pending":return!0;default:return!1}},tokenize:function(a){if(!a||!g.isValid(a))throw new Error("bad_id_format "+String(a));var b=a.indexOf(":");return{type:a.substr(0,b),value:a.substr(b+1)}},getUserIDFromParticipantID:function(a){if(!g.isValid(a))throw new Error("bad_id_format "+a);a=g.tokenize(a);var b=a.type;a=a.value;return b==="fbid"?a:null},getParticipantIDFromUserID:function(a){if(isNaN(a))throw new Error("Not a user ID: "+a);return"fbid:"+a},getUserIDFromThreadID:function(a){return!this.isCanonical(a)?null:this.tokenize(a).value},getThreadIDFromUserID:function(a){return"user:"+a},getThreadIDFromThreadFBID:function(a){return"thread:"+a},getThreadIDFromSupportInboxItemID:function(a){return"support:"+a},getThreadFBIDFromThreadID:function(a){return this.tokenize(a).value},getThreadKeyfromThreadIDUserID:function(a,b){__p&&__p();if(!a||!g.isValid(a))throw new Error("bad_id_format "+String(a));var c=this.tokenize(a).type;a=this.tokenize(a).value;if(c!=="user")return"g"+a;c="";var d="";if(a.length!==b.length)a.length>b.length?(c=a,d=b):(c=b,d=a);else if(b===a)return b+"u"+a;else{var e=0;while(e<a.length&&e<b.length)if(a[e]===b[e])e++;else{a[e]>b[e]?(c=a,d=b):(c=b,d=a);break}}return d+"u"+c},getThreadIDFromParticipantID:function(a){a=this.getUserIDFromParticipantID(a);return a?this.getThreadIDFromUserID(a):null},getParticipantIDFromFromThreadID:function(a){a=this.getUserIDFromThreadID(a);return a?this.getParticipantIDFromUserID(a):null},getSupportInboxItemIDFromThreadID:function(a){return this.tokenize(a).value},isCanonical:function(a){return this.isValid(a)&&this.tokenize(a).type==="user"},isGroupChat:function(a){return this.isValid(a)&&this.tokenize(a).type!=="user"},isLocalThread:function(a){return this.isValid(a)&&this.tokenize(a).type==="root"}};e.exports=g}),null);
__d("MercuryLogMessageType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SUBSCRIBE:"log:subscribe",UNSUBSCRIBE:"log:unsubscribe",VIDEO_CALL:"log:video-call",PHONE_CALL:"log:phone-call",THREAD_NAME:"log:thread-name",THREAD_IMAGE:"log:thread-image",SERVER_ERROR:"log:error-msg",LIVE_LISTEN:"log:live-listen",WALLPAPER:"log:wallpaper",ORION:"log:orion",SWITCH_TO_WORK:"log:switch",PAGE_REPLY:"log:page-reply",GENERIC_ADMIN_TEXT:"log:generic-admin-text"})}),null);
__d("MercurySourceType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHAT_ORCA:"source:chat:orca",CHAT_LIGHT_SPEED:"source:chat:light_speed",CHAT_IPHONE:"source:chat:iphone",CHAT_JABBER:"source:chat:jabber",CHAT_MEEBO:"source:chat:meebo",CHAT_WEB:"source:chat:web",CHAT_TEST:"source:chat:test",CHAT_FORWARD_DIALOG:"source:chat:forward",CHAT:"source:chat",CONTACT_ADD_MUTATION:"source:contact_add:graphql_mutation",CONTACT_ADD_CYMK:"source:contact_add:cymk_suggestion",CUSTOMER_CHAT_PLUGIN:"source:discovery:customer_chat_plugin",EMAIL:"source:email",EVENT_MESSAGE_BLAST:"source:event_message_blast",EVENT_TICKETING:"source:event_ticket",EVENT_REMINDERS:"source:event_reminders",FUNDRAISER_MESSAGE_BLAST:"source:fundraiser_message_blast",GENERIC_ADMIN_TEXT:"source:generic_admin_text",GIGABOXX_API:"source:gigaboxx:api",GIGABOXX_BLAST:"source:gigaboxx:blast",GIGABOXX_EMAIL_REPLY:"source:gigaboxx:emailreply",GIGABOXX_MOBILE:"source:gigaboxx:mobile",GIGABOXX_WAP:"source:gigaboxx:wap",GIGABOXX_WEB:"source:gigaboxx:web",INVITE:"source:invite",LEIA:"source:leia",MESSENGER_WEB:"source:messenger:web",MESSENGER_WEB_SEARCH:"source:messenger:web_search",SAM_UFI:"source:sam:ufi",SHARE_DIALOG:"source:share:dialog",SEND_PLUGIN:"source:sendplugin",SMS:"source:sms",TEST:"source:test",TITAN_WAP:"source:titan:wap",TITAN_M_BASIC:"source:titan:m_basic",TITAN_M_FREE:"source:titan:m_free_basic",TITAN_M_JAPAN:"source:titan:m_japan",TITAN_M_MINI:"source:titan:m_mini",TITAN_M_TOUCH:"source:titan:m_touch",TITAN_M_APP:"source:titan:m_app",TITAN_M_TABLET:"source:titan:m_tablet",TITAN_M_ZERO:"source:titan:m_zero",TITAN_M_TALK:"source:titan:m_talk",TITAN_WEB:"source:titan:web",TITAN_FACEWEB_ANDROID:"source:titan:faceweb_android",TITAN_FACEWEB_BUFFY:"source:titan:faceweb_buffy",TITAN_FACEWEB_IPAD:"source:titan:faceweb_ipad",TITAN_FACEWEB_IPHONE:"source:titan:faceweb_iphone",TITAN_FACEWEB_UNKNOWN:"source:titan:faceweb_unknown",TITAN_API:"source:titan:api",TITAN_API_MOBILE:"source:titan:api_mobile",TITAN_ORCA:"source:titan:orca",TITAN_EMAIL_REPLY:"source:titan:emailreply",MOBILE:"source:mobile",PAGE_PLATFORM_API:"source:page_platform_api",PAGE_UNIFIED_INBOX:"source:page_unified_inbox",UNKNOWN:"source:unknown",WEB:"source:web",HELPCENTER:"source:helpcenter",NEW_SHARE_DIALOG:"source:share:dialog:new",PAID_PROMOTION:"source:paid_promotion",BUFFY_SMS:"source:buffy:sms",WEBRTC_MOBILE:"source:webrtc:mobile",MESSENGER_COMMERCE:"source:messenger:commerce",MESSENGER_BOT:"source:bot",MESSENGER_EMPLOYEE_ONLY_BOT:"source:bot:employee_only",MESSENGER_OMNIM:"source:messenger:omnim",PAGES_PRIVATE_REPLY:"source:pages:private_reply",MESSENGER_FORWARD_DIALOG:"source:messenger:forward",MESSENGER_AD:"source:messenger:ad",MARKETPLACE:"source:marketplace",MARKETPLACE_BOT:"source:marketplace:bot",MESSENGER_LEAD_GEN:"source:messenger:lead_gen",PAGES_MESSAGE_SHORTLINK:"source:pages:message_shortlink",STICKER_SUBSCRIBE:"source:messenger:sticker_subscribe",PHOTO_TAG:"source:messenger:photo_tag",INTERNAL_TEST_PENDING:"source:internal:test_pending",JOB_SEARCH_APPLICATION:"source:job_search:application",MESSENGER_JOINABLE_LINK:"source:messenger:joinable_link",MESSENGER_ADD_WITH_APPROVAL:"source:messenger:add_with_approval",MESSENGER_SMS_BRIDGE_CONVERT:"source:messenger:sms_bridge_conversion",TINCAN_ORCA:"source:tincan:orca",TINCAN_IOS:"source:tincan:ios",TINCAN_UNKNOWN:"source:tincan:unknown",FACEBOOK_GROUPS_CHANNELS:"source:groups:channels",GROUP_COMMERCE:"source:group_commerce",INTERNAL_TOOL:"source:internal:tool",PAGES_PLATFORM:"source:pages:platform",PAGES_RECOMMENDATION:"source:pages:recommendation",PAGES_ORDER_MANAGEMENT:"source:pages:order_management",PAGE_AUTO_RESPONSE:"source:pages:auto_response",PAGES_INVITE:"source:pages:invite",PAGES_CHAT_EXTENSION:"source:pages:chat_extension",PAGES_COMPOSER:"source:pages:composer",SAVED_CHAT_EXTENSION:"source:saved:chat_extension",CREATOR_PAGE_INITIATE_TO_CREATOR_PAGE:"source:pages:creator_page_initiate_to_creator_page",LIVE_VIDEO_CHAT:"source:live_video_chat",GEMSTONE:"source:gemstone",FRIENDING_ADMIN_BUMP:"source:messenger_growth:friending_admin_bump",NEW_MESSENGER_USER_ADMIN_BUMP:"source:messenger_growth:new_messenger_user_admin_bump",EVENT_UPCOMING_BUMP:"source:messenger_growth:event_upcoming_bump",PHOTO_TAG_BUMP:"source:messenger_growth:photo_tag_bump",WALL_POST_BUMP:"source:messenger_growth:wall_post_bump",CUSTOMIZATION_UPSELL_BUMP:"source:messenger_growth:customization_upsell_bump",PAGE_COMMENT_MSG:"source:pages:question_triggered_convo",COMMENT_PIVOT:"source:messenger_growth:comment_pivot",PAGE_HOVERCARD:"source:pages:hovercard",INSTANT_GAMES:"source:instant_games",PAGE_EMAIL_REPLY:"source:pages:email_reply",PAGE_HOME_PAGE_PANEL:"source:page_home_page_panel",GROUPSYNC_MESSENGER_GROUP_CREATE:"source:groupsync:messenger_group_create",GROUPSYNC_SYNC_FROM_FB:"source:groupsync:sync_from_fb",GROUPSYNC_NAMING:"source:groupsync:naming",GROUPSYNC_THREAD_INFO_SYNC_FROM_FB:"source:groupsync:thread_info_sync",WORK_GROUP_SYNCED_CHAT_CREATION:"source:work:groupchat:creation",PAGE_PQI_MESSAGE:"source:pages:pqi_message",PAGE_PLUGIN_MESSAGE:"source:pages:page_plugin_message"})}),null);
__d("MercuryAssert",["MercuryIDs"],(function(a,b,c,d,e,f){__p&&__p();e.exports={isParticipantID:function(a){if(!b("MercuryIDs").isValid(a))throw new Error("bad_participant_id "+a)},allParticipantIDs:function(a){a.forEach(this.isParticipantID)},isUserParticipantID:function(a){var c=b("MercuryIDs").tokenize(a);if(c.type!="fbid")throw new Error("bad_user_id "+a)},isEmailParticipantID:function(a){var c=b("MercuryIDs").tokenize(a);if(c.type!="email")throw new Error("bad_email_id "+a)},allThreadID:function(a){a.forEach(this.isThreadID)},isThreadID:function(a){if(!b("MercuryIDs").isValid(a))throw new Error("bad_thread_id "+a)}}}),null);
__d("MercuryViewer",["CurrentUser","MercuryAssert"],(function(a,b,c,d,e,f){"use strict";var g="fbid:"+b("CurrentUser").getID();a={getID:function(){return g},isViewer:function(a){b("MercuryAssert").isParticipantID(a);return a===g}};e.exports=a}),null);
__d("EmojiFormat",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return a.split("_").map(function(a){return parseInt(a,16)})}function b(a){return a.map(function(a){return a.toString(16)}).join("_")}function c(a){var b="";for(var c=0;c<a.length;c++)b+=String.fromCodePoint(a[c]);return b}function d(a){a=this.codeStringToCodeArray(a);return this.codeArrayToUnicode(a)}e.exports={codeArrayToCodeString:b,codeArrayToUnicode:c,codeStringToCodeArray:a,codeStringToUnicode:d}}),null);
__d("EmojiFormat.bs",["EmojiFormat"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return a.length}d=b("EmojiFormat").codeStringToCodeArray;function c(a){return b("EmojiFormat").codeArrayToCodeString(a)}e=b("EmojiFormat").codeArrayToUnicode;var g=b("EmojiFormat").codeStringToUnicode;f.numSegments=a;f.codeStringToCodeArray=d;f.codeArrayToCodeString=c;f.codeArrayToUnicode=e;f.codeStringToUnicode=g}),null);
__d("bs_caml_builtin_exceptions",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=["Out_of_memory",0];b=["Sys_error",-1];c=["Failure",-2];d=["Invalid_argument",-3];e=["End_of_file",-4];var g=["Division_by_zero",-5],h=["Not_found",-6],i=["Match_failure",-7],j=["Stack_overflow",-8],k=["Sys_blocked_io",-9],l=["Assert_failure",-10],m=["Undefined_recursive_module",-11];a.tag=248;b.tag=248;c.tag=248;d.tag=248;e.tag=248;g.tag=248;h.tag=248;i.tag=248;j.tag=248;k.tag=248;l.tag=248;m.tag=248;f.out_of_memory=a;f.sys_error=b;f.failure=c;f.invalid_argument=d;f.end_of_file=e;f.division_by_zero=g;f.not_found=h;f.match_failure=i;f.stack_overflow=j;f.sys_blocked_io=k;f.assert_failure=l;f.undefined_recursive_module=m}),null);
__d("bs_caml_array",["bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(b,c,a){var d=new Array(a),e=0;c=c;while(e<a)d[e]=b[c],e=e+1|0,c=c+1|0;return d}function g(a,b){while(!0){var c=b,d=a;if(c){b=c[1];a=c[0].length+d|0;continue}else return d}}function h(a,b,c){__p&&__p();while(!0){var d=c,e=b;if(d){var f=d[0],g=f.length;e=e;var h=0;while(h<g)a[e]=f[h],e=e+1|0,h=h+1|0;c=d[1];b=e;continue}else return 0}}function c(a){var b=g(0,a);b=new Array(b);h(b,0,a);return b}function d(a,c,d){if(c<0||c>=a.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"index out of bounds"];else{a[c]=d;return 0}}function e(a,c){if(c<0||c>=a.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"index out of bounds"];else return a[c]}function i(a,b){var c=new Array(a);for(var d=0,a=a-1|0;d<=a;++d)c[d]=b;return c}function j(a){var b=new Array(a);for(var c=0,a=a-1|0;c<=a;++c)b[c]=0;return b}function k(b,c,d,e,a){if(e<=c){for(var f=0,h=a-1|0;f<=h;++f)d[f+e|0]=b[f+c|0];return 0}else{for(var f=a-1|0;f>=0;--f)d[f+e|0]=b[f+c|0];return 0}}function l(a){return a.slice(0)}f.caml_array_dup=l;f.caml_array_sub=a;f.caml_array_concat=c;f.caml_make_vect=i;f.caml_make_float_vect=j;f.caml_array_blit=k;f.caml_array_get=e;f.caml_array_set=d}),null);
__d("MessengerEmojiTransitionMapping.bs",["bs_caml_array","EmojiFormat.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){switch(a){case"1f3c3":case"1f3c4":case"1f3ca":case"1f3cb":case"1f3cc":case"1f46e":case"1f46f":case"1f471":case"1f473":case"1f477":case"1f481":case"1f482":case"1f486":case"1f487":case"1f575":case"1f645":case"1f646":case"1f647":case"1f64b":case"1f64d":case"1f64e":case"1f6a3":case"1f6b4":case"1f6b5":case"1f6b6":case"26f9":return!0;default:return!1}}function h(a){var c=b("bs_caml_array").caml_array_get(a,a.length-1|0)===65039;if(c)return b("bs_caml_array").caml_array_get(a,a.length-1|0);else return 0}function i(a){if(b("bs_caml_array").caml_array_get(a,a.length-1|0)===65039)return a;else{a=a.slice(0);return a.concat([65039])}}function j(a){var b=h(a)===0;if(b)return a;else return a.slice(0,a.length-1|0)}function k(a){if(a===9792)return!0;else return a===9794}function l(a){a=j(a);if(a.length<=1||!k(b("bs_caml_array").caml_array_get(a,a.length-1|0)))return 0;else return b("bs_caml_array").caml_array_get(a,a.length-1|0)}function m(a){var b=h(a),c=b===0;c=c?l(a):l(a.slice(0,a.length-1|0));if(c!==0){c=b===0;if(c)return a.slice(0,a.length-2|0);else return i(a.slice(0,a.length-3|0))}else return a}function n(a,b){__p&&__p();if(b!==0){var c=h(a),d=c===0;d=d?a.slice(0):a.slice(0,a.length-1|0);var e=l(d);if(e!==0)return a;else{e=d.concat([8205,b]);d=c===0;if(d)return e;else return e.concat([c])}}else return a}function a(a){return n(a,9792)}function c(a){return m(j(a))}function d(a){return g(b("EmojiFormat.bs").codeArrayToCodeString(m(j(a))))}function e(a){a=b("EmojiFormat.bs").codeArrayToCodeString(m(j(a)));switch(a){case"1f46a":case"1f48f":case"1f491":return!0;default:return!1}}var o=65039,p=9792,q=9794,r=8205;f.emoji_modifier_code=o;f.gender_female=p;f.gender_male=q;f.zero_join=r;f.emoji=g;f.getEmojiModifier=h;f.addEmojiModifier=i;f.removeEmojiModifier=j;f.isGenderModifier=k;f.getGender=l;f.removeGender=m;f.applyGender=n;f.makeFemale=a;f.removeAllModifiers=c;f.hasGender=d;f.isBlacklisted=e}),null);
__d("XChatRemoveParticipantAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/chat/remove_participants/",{elem_id:{type:"String"},uid:{type:"Int"},tid:{type:"String"}})}),null);
__d("XGroupsJoinChatController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groups/join_chat/",{link_hash:{type:"String"}})}),null);
__d("XMercuryThreadLikeIconController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/like_icon/",{emoji:{type:"String",defaultValue:""}})}),null);
__d("XMessagingBlockMessagesController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/block_messages/",{})}),null);
__d("XMessagingGroupJoinThroughHashController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/join_through_hash/",{link_hash:{type:"String"}})}),null);
__d("XMessagingGroupJoinThroughPrivateLinkController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/join_through_invite/",{link_hash:{type:"String"}})}),null);
__d("XMessagingGroupJoinableAcceptController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/joinable_accept/",{thread_fbid:{type:"String"},user_id:{type:"Int"}})}),null);
__d("XMessagingGroupJoinableInviteController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/joinable_invite/",{thread_fbid:{type:"String"},user_ids:{type:"IntSet"}})}),null);
__d("XMessagingGroupJoinableRejectController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/joinable_reject/",{thread_fbid:{type:"String"},user_id:{type:"Int"}})}),null);
__d("XMessagingGroupSetApprovalController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/set_approval_mode/",{set_mode:{type:"Enum",enumType:0},thread_fbid:{type:"String"}})}),null);
__d("XMessagingSaveAdminsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/save_admins/",{elem_id:{type:"String"},parent_elem_id:{type:"String"},thread_fbid:{type:"String"},admin_ids:{type:"FBIDSet"},add:{type:"Bool",defaultValue:!1}})}),null);
__d("XMessagingSaveNicknameController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/save_thread_nickname/",{source:{type:"Enum",required:!0,enumType:1}})}),null);
__d("XMessagingSaveThreadColorController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/save_thread_color/",{source:{type:"Enum",required:!0,enumType:1}})}),null);
__d("XMessagingSaveThreadEmojiController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/save_thread_emoji/",{source:{type:"Enum",required:!0,enumType:1}})}),null);
__d("XMessagingUnblockMessagesController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/unblock_messages/",{})}),null);
__d("XNFXIgnoreMessagesActionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/nfx/ignore_messages/",{thread_fbid:{type:"Int",required:!0},location:{type:"Enum",required:!0,enumType:1},__asyncDialog:{type:"Int"}})}),null);
__d("XNFXMessengerBlockActionController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/nfx/block_messages/",{thread_fbid:{type:"Int",required:!0},location:{type:"Enum",required:!0,enumType:1},__asyncDialog:{type:"Int"}})}),null);
__d("MercuryThreadActions",["cssVar","AsyncDialog","AsyncRequest","CurrentUser","EmojiLikeConstants","IgnoreMessagesTypedLogger","MercuryActionType","MercuryAPIArgsSource","MercuryDispatcher","MercuryIDs","MercuryLogMessageType","MercuryMessengerBlockingUtils","MercuryPayloadSource","MercuryParticipants","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonMixin","MercurySourceType","MercuryThreadIDMap","MercuryThreads","MercuryViewer","MercuryMessageActions","MessengerActions","MercuryMessageObject","MessagingTag","MessengerEmojiTransitionMapping.bs","MessengerGroupsSyncStatus","MessengerGroupsSyncStatusChangeMutationWebGraphQLMutation","PageCommItemStatus","ReloadPage","URI","WebGraphQL","XChatRemoveParticipantAsyncController","XGroupsJoinChatController","XMercuryThreadLikeIconController","XMessagingGroupJoinableAcceptController","XMessagingGroupJoinableInviteController","XMessagingGroupJoinableRejectController","XMessagingGroupJoinThroughHashController","XMessagingGroupJoinThroughPrivateLinkController","XMessagingGroupSetApprovalController","XMessagingSaveAdminsController","XMessagingSaveNicknameController","XMessagingSaveThreadColorController","XMessagingSaveThreadEmojiController","XNFXMessengerBlockActionController","XMessagingBlockMessagesController","XMessagingUnblockMessagesController","XNFXIgnoreMessagesActionController","ex","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("MercuryThreadIDMap").get(),i=b("MercuryThreads").get(),j=b("MercuryMessageActions").get(),k=b("MercuryMessageObject").get();function a(a){this.$1=a,this.__serverRequests=b("MercuryServerRequests").getForFBID(this.$1),this.__dispatcher=b("MercuryDispatcher").getForFBID(this.$1),this.__payloadPreprocessor=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1)}a.prototype.markRead=function(a,b){this.batchMarkRead([a],b)};a.prototype.batchMarkRead=function(a,b){this.__dispatcher.handleUpdate(this.$2(a,!0,b))};a.prototype.markUnread=function(a,b){this.batchMarkUnread([a],b)};a.prototype.batchMarkUnread=function(a,b){this.__dispatcher.handleUpdate(this.$2(a,!1,b))};a.prototype.markSeen=function(a,c){this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").MARK_THREAD_SEEN,b("MercuryPayloadSource").CLIENT_MARK_THREAD_SEEN,{persistent:c}))};a.prototype.archive=function(a,b){this.batchArchive([a],b)};a.prototype.batchArchive=function(a,b){a.forEach(function(a){this.__serverRequests.changeThreadArchivedStatus(a,!0,b)}.bind(this)),this.__dispatcher.handleUpdate(this.$3(a,!0))};a.prototype.unarchive=function(a,b){this.batchUnarchive([a],b)};a.prototype.batchUnarchive=function(a,b){a.forEach(function(a){this.__serverRequests.changeThreadArchivedStatus(a,!1,b)}.bind(this)),this.__dispatcher.handleUpdate(this.$3(a,!1))};a.prototype.markPageFollowUp=function(a,b){this.batchMarkPageFollowUp([a],b)};a.prototype.batchMarkPageFollowUp=function(a,b){a.forEach(function(a){this.__serverRequests.changeThreadPageFollowUpStatus(a,!0,b)}.bind(this)),this.__dispatcher.handleUpdate(this.$4(a,!0))};a.prototype.unmarkPageFollowUp=function(a,b){this.batchUnmarkPageFollowUp([a],b)};a.prototype.batchUnmarkPageFollowUp=function(a,b){a.forEach(function(a){this.__serverRequests.changeThreadPageFollowUpStatus(a,!1,b)}.bind(this)),this.__dispatcher.handleUpdate(this.$4(a,!1))};a.prototype.markSpam=function(a,b){this.batchMarkSpam([a],b)};a.prototype.batchMarkSpam=function(a,c){a.forEach(function(a){this.__serverRequests.markThreadSpam(a,c)}.bind(this)),this.__dispatcher.handleUpdate(this.$5(a,b("MessagingTag").SPAM))};a.prototype.unmarkSpam=function(a,b){this.batchUnmarkSpam([a],b)};a.prototype.batchUnmarkSpam=function(a,c){a.forEach(function(a){this.__serverRequests.unmarkThreadSpam(a,c)}.bind(this)),this.__dispatcher.handleUpdate(this.$5(a,b("MessagingTag").INBOX))};a.prototype.changeFolder=function(a,b){this.batchChangeFolder([a],b)};a.prototype.batchChangeFolder=function(a,b){a.forEach(function(a){this.__serverRequests.changeThreadFolder(a,b)}.bind(this)),this.__dispatcher.handleUpdate(this.$5(a,b))};a.prototype["delete"]=function(a,b){this.batchDelete([a],b)};a.prototype.batchDelete=function(a,c){this.__serverRequests.deleteThreads(a,c),this.__dispatcher.handleUpdate(this.__constructClientPayload(a,b("MercuryActionType").DELETE_THREAD,b("MercuryPayloadSource").CLIENT_DELETE_THREAD))};a.prototype.unmute=function(a){this.updateMuteSetting(a,0)};a.prototype.updateMuteSetting=function(a,c){this.__serverRequests.changeMutingOnThread(a,c),this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").CHANGE_MUTE_SETTINGS,b("MercuryPayloadSource").CLIENT_CHANGE_MUTE_SETTINGS,{mute_until:c}))};a.prototype.updateMentionsMuteSetting=function(a,c){c=c?1:0;this.__serverRequests.changeMentionsMutingOnThread(a,c);this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").CHANGE_MUTE_SETTINGS,b("MercuryPayloadSource").CLIENT_CHANGE_MUTE_SETTINGS,{mentions_mute_mode:c}))};a.prototype.updateReactionsMuteSetting=function(a,c){c=c?1:0;this.__serverRequests.changeReactionsMutingOnThread(a,c);this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").CHANGE_MUTE_SETTINGS,b("MercuryPayloadSource").CLIENT_CHANGE_MUTE_SETTINGS,{reactions_mute_mode:c}))};a.prototype.blockMessages=function(a,c){var d="";i.getThreadMeta(a,function(a){a=b("MercuryParticipants").getNow(b("MercuryIDs").getParticipantIDFromUserID(a.other_user_fbid));d=a&&a.short_name});var e=b("XNFXMessengerBlockActionController").getURIBuilder().setInt("thread_fbid",b("MercuryIDs").getUserIDFromThreadID(a)).setEnum("location","www_chat_head").getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(e),function(e){e.subscribe("confirm",function(){e.hide(),c&&c(d),this.changeFolder(a,b("MessagingTag").OTHER)}.bind(this))}.bind(this))};a.prototype.unblockMessages=function(a){var c=b("MercuryIDs").getUserIDFromThreadID(a);if(c===null)throw new Error(b("ex")("Expected user ID to unblock messages for, got null"));c=JSON.stringify({reportable_ent_token:c,initial_action_name:b("MercuryMessengerBlockingUtils").block_messages});new(b("AsyncRequest"))(new(b("URI"))("/ajax/nfx/messenger_undo_block").addQueryData({story_location:"messenger",context:c})).send();this.changeFolder(a,b("MessagingTag").INBOX)};a.prototype.ignoreMessages=function(a,c){c=b("XNFXIgnoreMessagesActionController").getURIBuilder().setInt("thread_fbid",a).setEnum("location","www_chat_head").getURI();b("AsyncDialog").send(new(b("AsyncRequest"))(c))};a.prototype.blockOnMessengerDotCom=function(a){var c=b("XMessagingBlockMessagesController").getURIBuilder().getURI();new(b("IgnoreMessagesTypedLogger"))().setEvent("block_confirmed").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(a)).setPlatform("messengerdotcom").log();new(b("AsyncRequest"))(c).setMethod("POST").setData({fbid:b("MercuryIDs").getUserIDFromThreadID(a)}).send()};a.prototype.blockIgnoreOnMessengerDotCom=function(a,c,d){a&&b("MessengerActions").selectThread(null),this.changeFolder(c,b("MessagingTag").OTHER),this.blockOnMessengerDotCom(c),d&&d()};a.prototype.unblockOnMessengerDotCom=function(a){var c=b("XMessagingUnblockMessagesController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData({fbid:b("MercuryIDs").getUserIDFromThreadID(a)}).send();this.changeFolder(a,b("MessagingTag").INBOX)};a.prototype.leaveGroup=function(a){i.isEmptyLocalThread(a)||j.send(k.constructLogMessageObject(b("MercurySourceType").TITAN_WEB,a,b("MercuryLogMessageType").UNSUBSCRIBE,{removed_participants:[b("MercuryViewer").getID()]}),null,b("MercuryAPIArgsSource").WEBMESSENGER)};a.prototype.deleteSyncedGroup=function(a){var c=i.getThreadMetaNow(a);if(!c)return;if(c.groups_sync_status!=b("MessengerGroupsSyncStatus").OPT_IN)return;h.getServerIDFromClientID(a,function(a){a={client_mutation_id:"0",actor_id:b("CurrentUser").getID(),thread_fbid:a,groups_sync_status:b("MessengerGroupsSyncStatus").OPT_OUT};b("WebGraphQL").exec(new(b("MessengerGroupsSyncStatusChangeMutationWebGraphQLMutation"))({data:a}))})};a.prototype.removeFromGroup=function(a,c){if(!i.isEmptyLocalThread(a)){var d=b("XChatRemoveParticipantAsyncController").getURIBuilder().getURI();a={tid:a,uid:c};new(b("AsyncRequest"))(d).setMethod("POST").setData(a).send()}};a.prototype.changeThreadColor=function(a,c,d){if(i.isEmptyLocalThread(a))return;h.getServerIDFromClientID(a,function(a){var e={};c!="#0084ff"&&(e.color_choice=c);e.thread_or_other_fbid=a;a=b("XMessagingSaveThreadColorController").getURIBuilder().setEnum("source",d).getURI();new(b("AsyncRequest"))(a).setMethod("POST").setData(e).send()})};a.prototype.changeThreadEmoji=function(a,c,d){if(i.isEmptyLocalThread(a))return;h.getServerIDFromClientID(a,function(a){var e={},f=String.fromCodePoint.apply(String,c);b("gkx")("AT7ffoM8gf91Fer7cUMkwGH62Vum20vkKo_AIqUOx27bu9y21PoFYcSzgDJj_KAeh5RgHmHKzv6c5n2RlIxDAfXE")&&b("MessengerEmojiTransitionMapping.bs").hasGender(c)&&(f=String.fromCodePoint.apply(String,b("MessengerEmojiTransitionMapping.bs").removeAllModifiers(c)));f!==String.fromCodePoint(b("EmojiLikeConstants").FB_THUMBS_UP_EMOJI)&&f!==String.fromCodePoint(b("EmojiLikeConstants").THUMBS_UP_EMOJI_CODES)&&(e.emoji_choice=f);e.thread_or_other_fbid=a;f=b("XMessagingSaveThreadEmojiController").getURIBuilder().setEnum("source",d).getURI();new(b("AsyncRequest"))(f).setMethod("POST").setData(e).send()})};a.prototype.changeThreadNicknames=function(a,c,d,e){if(i.isEmptyLocalThread(a))return;h.getServerIDFromClientID(a,function(a){a={thread_or_other_fbid:a,participant_id:c,nickname:d};var f=b("XMessagingSaveNicknameController").getURIBuilder().setEnum("source",e).getURI();new(b("AsyncRequest"))(f).setMethod("POST").setData(a).send()})};a.prototype.setApprovalMode=function(a,c){var d=b("XMessagingGroupSetApprovalController").getURIBuilder().getURI();new(b("AsyncRequest"))(d).setMethod("POST").setData({set_mode:a,thread_fbid:c.thread_fbid}).send()};a.prototype.changeGroupAdmins=function(a,c,d){a={thread_fbid:a,admin_ids:c,add:d};c=b("XMessagingSaveAdminsController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).send()};a.prototype.joinThroughHash=function(a){a={link_hash:a};var c=b("XMessagingGroupJoinThroughHashController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).send()};a.prototype.joinThroughPrivateLink=function(a){a={link_hash:a};var c=b("XMessagingGroupJoinThroughPrivateLinkController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).send()};a.prototype.chatJoinThroughHash=function(a){a={link_hash:a};var c=b("XGroupsJoinChatController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).setHandler(function(a){return b("ReloadPage").now()}).send()};a.prototype.inviteToJoinableGroup=function(a,c){a={thread_fbid:a,user_ids:c};c=b("XMessagingGroupJoinableInviteController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).send()};a.prototype.acceptToJoinableGroup=function(a,c){a={thread_fbid:a,user_id:c};c=b("XMessagingGroupJoinableAcceptController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).send()};a.prototype.rejectToJoinableGroup=function(a,c){a={thread_fbid:a,user_id:c};c=b("XMessagingGroupJoinableRejectController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setMethod("POST").setData(a).send()};a.prototype.addParticipants=function(a,c){this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").ADD_PARTICIPANTS,b("MercuryPayloadSource").CLIENT_ADD_PARTICIPANTS,{participants:c}))};a.prototype.updateCustomLike=function(a,c){c=b("XMercuryThreadLikeIconController").getURIBuilder().setString("emoji",c).getURI();new(b("AsyncRequest"))().setURI(c).setHandler(function(c){this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").UPDATE_CUSTOM_LIKE,b("MercuryPayloadSource").CLIENT_CHANGE_CUSTOM_LIKE,{custom_like:c.getPayload()}))}.bind(this)).send()};a.prototype.movePendingToInbox=function(a){this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").MOVE_PENDING_TO_INBOX,b("MercuryPayloadSource").CLIENT_MOVE_PENDING_TO_INBOX))};a.prototype.updateSnippet=function(a,c){this.__dispatcher.handleUpdate(this.__constructClientPayload([a],b("MercuryActionType").UPDATE_SNIPPET,b("MercuryPayloadSource").CLIENT_UPDATE_SNIPPET,{deleted_ids:c}))};a.prototype.updateCommStatus=function(a,c){this.__dispatcher.handleUpdate(this.$6(a,c));c=c===b("PageCommItemStatus").DONE;this.__dispatcher.handleUpdate(this.$3(a,c))};a.prototype.updateCommItemOwner=function(a,b,c,d){this.__dispatcher.handleUpdate(this.$7(a,b,c,d))};a.prototype.$2=function(a,c,d){return this.__constructClientPayload(a,b("MercuryActionType").CHANGE_READ_STATUS,b("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS,{mark_as_read:c,source:d})};a.prototype.$7=function(a,c,d,e){return this.__constructClientPayload(a,b("MercuryActionType").UPDATE_COMM_ITEM_OWNER,b("MercuryPayloadSource").UPDATE_COMM_ITEM_OWNER,{id:d,name:c,profile_pic_uri:e})};a.prototype.$3=function(a,c){return this.__constructClientPayload(a,b("MercuryActionType").CHANGE_ARCHIVED_STATUS,b("MercuryPayloadSource").CLIENT_CHANGE_ARCHIVED_STATUS,{archived:c})};a.prototype.$4=function(a,c){return this.__constructClientPayload(a,b("MercuryActionType").CHANGE_PAGE_FOLLOW_UP_STATUS,b("MercuryPayloadSource").CLIENT_CHANGE_PAGE_FOLLOW_UP_STATUS,{is_page_follow_up:c})};a.prototype.$6=function(a,c){return this.__constructClientPayload(a,b("MercuryActionType").UPDATE_COMM_STATUS,b("MercuryPayloadSource").CLIENT_UPDATE_COMM_STATUS,{comm_status:c})};a.prototype.$5=function(a,c){return this.__constructClientPayload(a,b("MercuryActionType").CHANGE_FOLDER,b("MercuryPayloadSource").CLIENT_CHANGE_FOLDER,{new_folder:c})};a.prototype.__constructClientPayload=function(a,b,c,d){return{actions:a.map(function(a){return babelHelpers["extends"]({action_type:b,thread_id:a},d)}),from_client:!0,payload_source:c}};Object.assign(a,b("MercurySingletonMixin"));e.exports=a}),null);
__d("MercuryTypeaheadConstants",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({COMPOSER_FRIENDS_MAX:4,COMPOSER_FB4C_MAX:8,COMPOSER_NON_FRIENDS_MAX:2,COMPOSER_MESSENGER_ONLY_CONTACT_MAX:4,COMPOSER_SHOW_MORE_LIMIT:2,COMPOSER_THREADS_INITIAL_LIMIT:2,COMPOSER_CHATTAB_MAX:5,COMPOSER_PAGES_MAX:5,COMPOSER_WM_MAX:23,USER_TYPE:"user",PAGE_TYPE:"page",THREAD_TYPE:"thread",HEADER_TYPE:"header",SEARCH_TYPE:"search",FRIEND_TYPE:"friend",NON_FRIEND_TYPE:"non_friend",FB4C_TYPE:"fb4c",MEETING_ROOM_PAGE_TYPE:"meeting_room_page",COMMERCE_PAGE_TYPE:"commerce_page",INTERNAL_BOT_PAGE_TYPE:"internal_bot_page",GAME_TYPE:"game",WORKPLACE_BOT_CATEGORY_TYPE:"WORKPLACE_BOT",VALID_EMAIL:"^([A-Z0-9._%+-]+@((?!facebook\\.com))[A-Z0-9.-]+\\.[A-Z]{2,4}|(([A-Z._%+-]+[A-Z0-9._%+-]*)|([A-Z0-9._%+-]+[A-Z._%+-]+[A-Z0-9._%+-]*))@(?:facebook\\.com))$"})}),null);
__d("MessengerDispatcher",["Dispatcher_DEPRECATED"],(function(a,b,c,d,e,f){"use strict";e.exports=new(b("Dispatcher_DEPRECATED"))()}),null);
__d("MessengerActions",["invariant","Bootloader","EventProfiler","LogHistory","MercuryIDs","MercuryTypeaheadConstants","MessengerDispatcher","MessengerURISerializer","MessengerView","URI","goURI","keyMirror"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("keyMirror")({CANCEL_FILE_UPLOAD:null,EMPTY_FILES:null,LINK_PREVIEW:null,LOADED_SHARE_DATA:null,LOADING_SHARE_DATA:null,REMOVE_SHARE_PREVIEW:null,PREPARE_FILES_FOR_SEND:null,REPLACE_STATE:null,SELECT_THREAD:null,UPDATE_MDOT_ME:null,UPDATE_THREAD_TAG:null,UPLOAD_FILE_FAILED:null,UPLOADED_FILE:null}),i=b("LogHistory").getInstance("messenger_actions"),j={Types:h,changeDetailView:function(a){l(function(b){return b.detailView!==a?{detailView:a}:null})},changeMasterView:function(a){l(function(c){if(c.masterView!==a){var d={masterView:a};c.masterView===b("MessengerView").MASTER.SEARCH&&(d.query=undefined,b("Bootloader").loadModules(["MessengerContentSearchFunnelLogger","MessengerContentSearchFunnelLoggerConstants"],function(a,b){a&&a.endFunnel(b.FUNNEL_LOGGER_TAGS.END_WITH_BACK_BUTTON)},"MessengerActions"));return d}return null})},selectAggregation:function(a){l(function(c){return{detailView:b("MessengerView").MASTER.RECENT,threadIDs:a,mid:null}})},selectThread:function(a,c){__p&&__p();if(c===b("MercuryTypeaheadConstants").MEETING_ROOM_PAGE_TYPE){!a&&g(0);c=b("MercuryIDs").getUserIDFromThreadID(a);!c&&g(0);var d=new(b("URI"))(),e=d.getQualifiedURI().getSubdomain();d.setDomain("facebook.com").setSubdomain(e).setPath("/"+c).setProtocol("https");window.open(d,"_blank");return}b("EventProfiler").tagCurrentActiveInteractionsAs("MessengerThreadSwitch");b("MessengerDispatcher").dispatch({type:h.SELECT_THREAD,threadID:a});l(function(c){return c.activeThreadID!==a?{activeThreadID:a,detailView:b("MessengerView").DETAIL.THREAD,mid:null}:null})},changeState:function(a){b("MessengerDispatcher").dispatch({type:h.REPLACE_STATE,nextState:a})},changeMDotMeReferral:function(){var a=arguments.length<=0||arguments[0]===undefined?null:arguments[0],c=arguments.length<=1||arguments[1]===undefined?null:arguments[1];b("MessengerDispatcher").dispatch({type:j.Types.UPDATE_MDOT_ME,refCode:a,refThreadID:c})},changeThreadTag:function(){var a=arguments.length<=0||arguments[0]===undefined?null:arguments[0],c=arguments.length<=1||arguments[1]===undefined?null:arguments[1];b("MessengerDispatcher").dispatch({type:j.Types.UPDATE_THREAD_TAG,messagingTags:a,threadID:c})},changeFolder:function(a){l(function(b){return b.folder!==a?{folder:a}:null})},changeFilter:function(a){l(function(b){return b.filter!==a?{filter:a}:null})},changeQuery:function(a){l(function(b){return b.query!==a?{query:a}:null})},changeQueryAll:function(a){l(function(c){return c.queryAll!==a?{query:a,masterView:b("MessengerView").MASTER.SEARCH}:null})},changeMid:function(a){l(function(b){return b.mid!==a?{mid:a}:null})},changeID:function(a){l(function(b){return b.extraQueryParams.id!==a?{extraQueryParams:babelHelpers["extends"]({},b.extraQueryParams,{id:a})}:null})},prepareFilesForSend:function(a,c,d){i.debug("Add files from "+d,a);if(!a)return;b("MessengerDispatcher").dispatch({type:j.Types.PREPARE_FILES_FOR_SEND,threadID:a,files:c})},uploadedFile:function(a,c,d){if(!a)return;b("MessengerDispatcher").dispatch({type:j.Types.UPLOADED_FILE,threadID:a,uploadID:c,payload:d})},cancelFileUpload:function(a,c){if(!a)return;b("MessengerDispatcher").dispatch({type:j.Types.CANCEL_FILE_UPLOAD,threadID:a,uploadID:c})},uploadFileFailed:function(a,c){if(!a)return;b("MessengerDispatcher").dispatch({type:j.Types.UPLOAD_FILE_FAILED,threadID:a,uploadID:c})},cleanFiles:function(a){i.debug("clean files",a);if(!a)return;b("MessengerDispatcher").dispatch({type:j.Types.EMPTY_FILES,threadID:a})},loadingPreview:function(a,c){b("MessengerDispatcher").dispatch({type:j.Types.LINK_PREVIEW,threadID:a,match:c})},loadingShareData:function(a){b("MessengerDispatcher").dispatch({type:j.Types.LOADING_SHARE_DATA,threadID:a})},loadedShareData:function(a,c){b("MessengerDispatcher").dispatch({type:j.Types.LOADED_SHARE_DATA,threadID:a,attachmentData:c})},removeSharePreview:function(a){b("MessengerDispatcher").dispatch({type:j.Types.REMOVE_SHARE_PREVIEW,threadID:a})}};function k(a,b){return a.detailView==null}function l(a){var c=b("MessengerURISerializer").deserialize(new(b("URI"))(window.location.href));a=a(c);var d=k(c,a);a&&b("goURI")(b("MessengerURISerializer").serialize(Object.assign(c,a)),!1,d)}e.exports=j}),null);
__d("bs_caml_exceptions",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[0];function a(a){a[1]=g[0];g[0]+=1;return a}function h(){g[0]+=1;return g[0]}function b(a){var b=h(0);a=[a,b];a.tag=248;return a}function c(a){if(a===undefined)return!1;else if(a.tag===248)return!0;else{a=a[0];if(a!==undefined)return a.tag===248;else return!1}}f.caml_set_oo_id=a;f.get_id=h;f.create=b;f.isCamlExceptionOrOpenVariant=c}),null);
__d("bs_js_exn",["bs_caml_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("bs_caml_exceptions").create("Js_exn.Error");function a(a){if(b("bs_caml_exceptions").isCamlExceptionOrOpenVariant(a))return a;else return[g,a]}function c(a){throw new Error(a)}function d(a){throw new EvalError(a)}function e(a){throw new RangeError(a)}function h(a){throw new ReferenceError(a)}function i(a){throw new SyntaxError(a)}function j(a){throw new TypeError(a)}function k(a){throw new URIError(a)}f.$$Error=g;f.internalToOCamlException=a;f.raiseError=c;f.raiseEvalError=d;f.raiseRangeError=e;f.raiseReferenceError=h;f.raiseSyntaxError=i;f.raiseTypeError=j;f.raiseUriError=k}),null);
__d("bs_block",[],(function(a,b,c,d,e,f){"use strict";function a(a,b){b.tag=a;return b}f.__=a}),null);
__d("bs_js_types",["bs_block"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();if(typeof a==="undefined")return[0,a];else if(a===null)return[1,a];else if(typeof a==="number")return[3,a];else if(typeof a==="string")return[4,a];else if(typeof a==="boolean")return[2,a];else if(typeof a==="function")return[5,a];else if(typeof a==="object")return[6,a];else return[7,a]}function c(a){__p&&__p();var c=typeof a;if(c==="undefined")return 3;else if(a===null)return 2;else if(c==="number")return b("bs_block").__(0,[a]);else if(c==="string")return b("bs_block").__(1,[a]);else if(c==="boolean")if(a===!0)return 1;else return 0;else if(c==="function")return b("bs_block").__(2,[a]);else if(c==="object")return b("bs_block").__(3,[a]);else return b("bs_block").__(4,[a])}function d(a,b){switch(b){case 0:return typeof a==="undefined";case 1:return a===null;case 2:return typeof a==="boolean";case 3:return typeof a==="number";case 4:return typeof a==="string";case 5:return typeof a==="function";case 6:return typeof a==="object";case 7:return typeof a==="symbol"}}f.reify_type=a;f.test=d;f.classify=c}),null);
__d("bs_caml_int32",["bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){if(c===0)throw b("bs_caml_builtin_exceptions").division_by_zero;else return a/c|0}function c(a,c){if(c===0)throw b("bs_caml_builtin_exceptions").division_by_zero;else return a%c}function d(a){return(a&255)<<8|(a&65280)>>>8}function e(a){return(a&255)<<24|(a&65280)<<8|(a&16711680)>>>8|(a&4278190080)>>>24}var g=Math.imul||function(a,b){b|=0;return((a>>16)*b<<16)+(a&65535)*b|0},h=e;f.div=a;f.mod_=c;f.caml_bswap16=d;f.caml_int32_bswap=e;f.caml_nativeint_bswap=h;f.imul=g}),null);
__d("bs_caml_primitive",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){if(a<b)return-1;else if(a===b)return 0;else return 1}function b(a,b){if(a)if(b)return 0;else return 1;else if(b)return-1;else return 0}function c(a,b){if(a===b)return 0;else if(a<b)return-1;else if(a>b||a===a)return 1;else if(b===b)return-1;else return 0}function d(a,b){if(a===b)return 0;else if(a<b)return-1;else return 1}function e(a,b){if(a)return b;else return a}function g(a,b){if(a<b)return a;else return b}function h(a,b){if(a<b)return a;else return b}function i(a,b){if(a<b)return a;else return b}function j(a,b){if(a<b)return a;else return b}function k(a,b){if(a<b)return a;else return b}function l(a,b){if(a)return a;else return b}function m(a,b){if(a>b)return a;else return b}function n(a,b){if(a>b)return a;else return b}function o(a,b){if(a>b)return a;else return b}function p(a,b){if(a>b)return a;else return b}function q(a,b){if(a>b)return a;else return b}var r=a,s=a;f.caml_int_compare=a;f.caml_bool_compare=b;f.caml_float_compare=c;f.caml_nativeint_compare=r;f.caml_string_compare=d;f.caml_int32_compare=s;f.caml_bool_min=e;f.caml_int_min=g;f.caml_float_min=h;f.caml_string_min=i;f.caml_nativeint_min=j;f.caml_int32_min=k;f.caml_bool_max=l;f.caml_int_max=m;f.caml_float_max=n;f.caml_string_max=o;f.caml_nativeint_max=p;f.caml_int32_max=q}),null);
__d("bs_caml_obj",["bs_block","bs_caml_primitive","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){b=new Array(b);b.tag=a;return b}function c(a){var b=a.length|0,c=new Array(b);for(var d=0,b=b-1|0;d<=b;++d)c[d]=a[d];c.tag=a.tag|0;return c}function d(a,c){__p&&__p();var d=a.length|0;if(c<=0||c>d)throw[b("bs_caml_builtin_exceptions").invalid_argument,"Obj.truncate"];else if(d!==c){for(var e=c,d=d-1|0;e<=d;++e)a[e]=0;a.length=c;return 0}else return 0}function e(a){return b("bs_block").__(250,[a])}function g(a,b){var c=b.length|0;for(var d=0,c=c-1|0;d<=c;++d)a[d]=b[d];d=b.tag|0;if(d!==0){a.tag=d;return 0}else return 0}var h=function(a,b){for(var c in a)b(c)};function i(a,c){__p&&__p();while(!0){var d=c,e=a;if(e===d)return 0;else{var f=typeof e,g=typeof d;if(f==="string")return b("bs_caml_primitive").caml_string_compare(e,d);else{var j=f==="number",k=g==="number";if(j)if(k)return b("bs_caml_primitive").caml_int_compare(e,d);else return-1;else if(k)return 1;else if(f==="boolean"||f==="undefined"||e===null){j=e;k=d;if(j===k)return 0;else if(j<k)return-1;else return 1}else if(f==="function"||g==="function")throw[b("bs_caml_builtin_exceptions").invalid_argument,"compare: functional value"];else{j=e.tag|0;k=d.tag|0;if(j===250){a=e[0];continue}else if(k===250){c=d[0];continue}else if(j===248)return b("bs_caml_primitive").caml_int_compare(e[1],d[1]);else if(j===251)throw[b("bs_caml_builtin_exceptions").invalid_argument,"equal: abstract value"];else if(j!==k)if(j<k)return-1;else return 1;else{f=e.length|0;g=d.length|0;if(f===g)if(Array.isArray(e)){j=e;k=d;var l=0,m=f;while(!0){var n=l;if(n===m)return 0;else{var o=i(j[n],k[n]);if(o!==0)return o;else{l=n+1|0;continue}}}}else{o=e;n=d;l=[0];j=[0];var p=function(b,c){__p&&__p();var d=b[2],a=b[1];if(!Object.prototype.hasOwnProperty.call(a,c)||i(b[0][c],a[c])>0){b=d[0];if(b)if(c<b[0]){d[0]=[c];return 0}else return 0;else{d[0]=[c];return 0}}else return 0};k=[o,n,j];m=function(a){return function(b){return p(a,b)}}(k);k=[n,o,l];k=function(a){return function(b){return p(a,b)}}(k);h(o,m);h(n,k);o=l[0];m=j[0];if(o)if(m)return b("bs_caml_primitive").caml_string_compare(o[0],m[0]);else return-1;else if(m)return 1;else return 0}else if(f<g){n=e;k=d;l=0;j=f;while(!0){o=l;if(o===j)return-1;else{m=i(n[o],k[o]);if(m!==0)return m;else{l=o+1|0;continue}}}}else{f=e;m=d;o=0;l=g;while(!0){n=o;if(n===l)return 1;else{k=i(f[n],m[n]);if(k!==0)return k;else{o=n+1|0;continue}}}}}}}}}}function j(a,c){__p&&__p();while(!0){var d=c,e=a;if(e===d)return!0;else{var f=typeof e;if(f==="string"||f==="number"||f==="boolean"||f==="undefined"||e===null)return!1;else{var g=typeof d;if(f==="function"||g==="function")throw[b("bs_caml_builtin_exceptions").invalid_argument,"equal: functional value"];else if(g==="number"||g==="undefined"||d===null)return!1;else{f=e.tag|0;g=d.tag|0;if(f===250){a=e[0];continue}else if(g===250){c=d[0];continue}else if(f===248)return e[1]===d[1];else if(f===251)throw[b("bs_caml_builtin_exceptions").invalid_argument,"equal: abstract value"];else if(f!==g)return!1;else{f=e.length|0;g=d.length|0;if(f===g)if(Array.isArray(e)){g=e;var i=d,k=0;f=f;while(!0){var l=k;if(l===f)return!0;else if(j(g[l],i[l])){k=l+1|0;continue}else return!1}}else{l=e;k=d;g=[!0];i=function(a,b){return function(c){if(Object.prototype.hasOwnProperty.call(a,c))return 0;else{b[0]=!1;return 0}}}(k,g);f=function(a,b,c){return function(d){if(!Object.prototype.hasOwnProperty.call(a,d)||!j(b[d],a[d])){c[0]=!1;return 0}else return 0}}(l,k,g);h(l,i);g[0]&&h(k,f);return g[0]}else return!1}}}}}}function k(a,b){if(b!==null)return j(a,b);else return a===b}function l(a,b){if(b!==undefined)return j(a,b);else return a===b}function m(a,b){if(b==null)return a===b;else return j(a,b)}function n(a,b){return!j(a,b)}function o(a,b){return i(a,b)>=0}function p(a,b){return i(a,b)>0}function q(a,b){return i(a,b)<=0}function r(a,b){return i(a,b)<0}function s(a,b){if(i(a,b)<=0)return a;else return b}function t(a,b){if(i(a,b)>=0)return a;else return b}f.caml_obj_block=a;f.caml_obj_dup=c;f.caml_obj_truncate=d;f.caml_lazy_make_forward=e;f.caml_update_dummy=g;f.caml_compare=i;f.caml_equal=j;f.caml_equal_null=k;f.caml_equal_undefined=l;f.caml_equal_nullable=m;f.caml_notequal=n;f.caml_greaterequal=o;f.caml_greaterthan=p;f.caml_lessthan=r;f.caml_lessequal=q;f.caml_min=s;f.caml_max=t}),null);
__d("bs_caml_string",["bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return String.fromCharCode(a)}function c(a,c){if(c>=a.length||c<0)throw[b("bs_caml_builtin_exceptions").invalid_argument,"index out of bounds"];else return a.charCodeAt(c)}function d(a){if(a<0)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.create"];else{var c=new Array(a);for(var d=0,a=a-1|0;d<=a;++d)c[d]=0;return c}}function e(a,b,c,d){if(c>0){for(var e=b,c=(c+b|0)-1|0;e<=c;++e)a[e]=d;return 0}else return 0}function g(a,b,c,d,e){__p&&__p();if(e>0){var f=a.length-b|0;if(e<=f){for(var g=0,h=e-1|0;g<=h;++g)c[d+g|0]=a.charCodeAt(b+g|0);return 0}else{for(var g=0,h=f-1|0;g<=h;++g)c[d+g|0]=a.charCodeAt(b+g|0);for(var g=f,b=e-1|0;g<=b;++g)c[d+g|0]=0;return 0}}else return 0}function h(a,b,c,d,e){__p&&__p();if(e>0)if(a===c){var f=a,g=b,h=d,i=e;if(g<h){var j=(f.length-h|0)-1|0,k=i-1|0;k=j>k?k:j;for(var j=k;j>=0;--j)f[h+j|0]=f[g+j|0];return 0}else if(g>h){k=(f.length-g|0)-1|0;j=i-1|0;i=k>j?j:k;for(var j=0;j<=i;++j)f[h+j|0]=f[g+j|0];return 0}else return 0}else{k=a.length-b|0;if(e<=k){for(var g=0,h=e-1|0;g<=h;++g)c[d+g|0]=a[b+g|0];return 0}else{for(var j=0,i=k-1|0;j<=i;++j)c[d+j|0]=a[b+j|0];for(var f=k,g=e-1|0;f<=g;++f)c[d+f|0]=0;return 0}}else return 0}function i(a){var b=a.length,c=new Array(b);for(var d=0,b=b-1|0;d<=b;++d)c[d]=a.charCodeAt(d);return c}function j(a){__p&&__p();var b=a,c=0;a=a.length;var d="",e=a;if(c===0&&a<=4096&&a===b.length)return String.fromCharCode.apply(null,b);else{c=0;while(e>0){a=e<1024?e:1024;var f=new Array(a);h(b,c,f,0,a);d=d+String.fromCharCode.apply(null,f);e=e-a|0;c=c+a|0}return d}}function k(a){var b=a.length,c=new Array(b);for(var d=0,b=b-1|0;d<=b;++d)c[d]=a[d];return j(c)}function l(a){if(a>31)return a<127;else return!1}function m(a,b){return a.charCodeAt(b)+(a.charCodeAt(b+1|0)<<8)|0}function n(a,b){return((a.charCodeAt(b)+(a.charCodeAt(b+1|0)<<8)|0)+(a.charCodeAt(b+2|0)<<16)|0)+(a.charCodeAt(b+3|0)<<24)|0}function o(a,c){if(c<0||c>=a.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"index out of bounds"];else return a.charCodeAt(c)}f.bytes_of_string=i;f.bytes_to_string=j;f.caml_is_printable=l;f.caml_string_of_char_array=k;f.caml_string_get=c;f.caml_create_string=d;f.caml_fill_string=e;f.caml_blit_string=g;f.caml_blit_bytes=h;f.caml_string_get16=m;f.caml_string_get32=n;f.string_of_char=a;f.get=o}),null);
__d("bs_char",["bs_caml_string","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){if(a<0||a>255)throw[b("bs_caml_builtin_exceptions").invalid_argument,"Char.chr"];else return a}function c(a){__p&&__p();var c=0;if(a>=40)if(a!==92)c=a>=127?1:2;else return"\\\\";else if(a>=32)if(a>=39)return"\\'";else c=2;else if(a>=14)c=1;else switch(a){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:c=1;break;case 13:return"\\r"}switch(c){case 1:c=b("bs_caml_string").caml_create_string(4);c[0]=92;c[1]=48+(a/100|0)|0;c[2]=48+(a/10|0)%10|0;c[3]=48+a%10|0;return b("bs_caml_string").bytes_to_string(c);case 2:c=b("bs_caml_string").caml_create_string(1);c[0]=a;return b("bs_caml_string").bytes_to_string(c)}}function d(a){if(a>=65&&a<=90||a>=192&&a<=214||a>=216&&a<=222)return a+32|0;else return a}function e(a){if(a>=97&&a<=122||a>=224&&a<=246||a>=248&&a<=254)return a-32|0;else return a}function g(a,b){return a-b|0}f.chr=a;f.escaped=c;f.lowercase=d;f.uppercase=e;f.compare=g}),null);
__d("bs_curry",["bs_caml_array"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c){__p&&__p();while(!0){var d=c,e=a,f=e.length;f=f===0?1:f;var h=d.length;h=f-h|0;if(h===0)return e.apply(null,d);else if(h<0){c=b("bs_caml_array").caml_array_sub(d,f,-h|0);a=e.apply(null,b("bs_caml_array").caml_array_sub(d,0,f));continue}else return function(b,a){return function(c){return g(b,a.concat([c]))}}(e,d)}}function h(a,b,c){__p&&__p();if(c>7||c<0)return g(a,[b]);else switch(c){case 0:case 1:return a(b);case 2:return function(c){return a(b,c)};case 3:return function(c,d){return a(b,c,d)};case 4:return function(c,d,e){return a(b,c,d,e)};case 5:return function(c,d,e,f){return a(b,c,d,e,f)};case 6:return function(c,d,e,f,g){return a(b,c,d,e,f,g)};case 7:return function(c,d,e,f,g,h){return a(b,c,d,e,f,g,h)}}}function i(a,b){var c=a.length;if(c===1)return a(b);else return h(a,b,c)}function a(a){var b=a.length;if(b===1)return a;else return function(b){return i(a,b)}}function j(a,b,c,d){__p&&__p();if(d>7||d<0)return g(a,[b,c]);else switch(d){case 0:case 1:return g(a(b),[c]);case 2:return a(b,c);case 3:return function(d){return a(b,c,d)};case 4:return function(d,e){return a(b,c,d,e)};case 5:return function(d,e,f){return a(b,c,d,e,f)};case 6:return function(d,e,f,g){return a(b,c,d,e,f,g)};case 7:return function(d,e,f,g,h){return a(b,c,d,e,f,g,h)}}}function k(a,b,c){var d=a.length;if(d===2)return a(b,c);else return j(a,b,c,d)}function c(a){var b=a.length;if(b===2)return a;else return function(b,c){return k(a,b,c)}}function l(a,b,c,d,e){__p&&__p();var f=0;if(e>7||e<0)return g(a,[b,c,d]);else switch(e){case 0:case 1:f=1;break;case 2:return g(a(b,c),[d]);case 3:return a(b,c,d);case 4:return function(e){return a(b,c,d,e)};case 5:return function(e,f){return a(b,c,d,e,f)};case 6:return function(e,f,g){return a(b,c,d,e,f,g)};case 7:return function(e,f,g,h){return a(b,c,d,e,f,g,h)}}if(f===1)return g(a(b),[c,d])}function m(a,b,c,d){var e=a.length;if(e===3)return a(b,c,d);else return l(a,b,c,d,e)}function d(a){var b=a.length;if(b===3)return a;else return function(b,c,d){return m(a,b,c,d)}}function n(a,b,c,d,e,f){__p&&__p();var h=0;if(f>7||f<0)return g(a,[b,c,d,e]);else switch(f){case 0:case 1:h=1;break;case 2:return g(a(b,c),[d,e]);case 3:return g(a(b,c,d),[e]);case 4:return a(b,c,d,e);case 5:return function(f){return a(b,c,d,e,f)};case 6:return function(f,g){return a(b,c,d,e,f,g)};case 7:return function(f,g,h){return a(b,c,d,e,f,g,h)}}if(h===1)return g(a(b),[c,d,e])}function o(a,b,c,d,e){var f=a.length;if(f===4)return a(b,c,d,e);else return n(a,b,c,d,e,f)}function e(a){var b=a.length;if(b===4)return a;else return function(b,c,d,e){return o(a,b,c,d,e)}}function p(a,b,c,d,e,f,h){__p&&__p();var i=0;if(h>7||h<0)return g(a,[b,c,d,e,f]);else switch(h){case 0:case 1:i=1;break;case 2:return g(a(b,c),[d,e,f]);case 3:return g(a(b,c,d),[e,f]);case 4:return g(a(b,c,d,e),[f]);case 5:return a(b,c,d,e,f);case 6:return function(g){return a(b,c,d,e,f,g)};case 7:return function(g,h){return a(b,c,d,e,f,g,h)}}if(i===1)return g(a(b),[c,d,e,f])}function q(a,b,c,d,e,f){var g=a.length;if(g===5)return a(b,c,d,e,f);else return p(a,b,c,d,e,f,g)}function r(a){var b=a.length;if(b===5)return a;else return function(b,c,d,e,f){return q(a,b,c,d,e,f)}}function s(a,b,c,d,e,f,h,i){__p&&__p();var j=0;if(i>7||i<0)return g(a,[b,c,d,e,f,h]);else switch(i){case 0:case 1:j=1;break;case 2:return g(a(b,c),[d,e,f,h]);case 3:return g(a(b,c,d),[e,f,h]);case 4:return g(a(b,c,d,e),[f,h]);case 5:return g(a(b,c,d,e,f),[h]);case 6:return a(b,c,d,e,f,h);case 7:return function(g){return a(b,c,d,e,f,h,g)}}if(j===1)return g(a(b),[c,d,e,f,h])}function t(a,b,c,d,e,f,g){var h=a.length;if(h===6)return a(b,c,d,e,f,g);else return s(a,b,c,d,e,f,g,h)}function u(a){var b=a.length;if(b===6)return a;else return function(b,c,d,e,f,g){return t(a,b,c,d,e,f,g)}}function v(a,b,c,d,e,f,h,i,j){__p&&__p();var k=0;if(j>7||j<0)return g(a,[b,c,d,e,f,h,i]);else switch(j){case 0:case 1:k=1;break;case 2:return g(a(b,c),[d,e,f,h,i]);case 3:return g(a(b,c,d),[e,f,h,i]);case 4:return g(a(b,c,d,e),[f,h,i]);case 5:return g(a(b,c,d,e,f),[h,i]);case 6:return g(a(b,c,d,e,f,h),[i]);case 7:return a(b,c,d,e,f,h,i)}if(k===1)return g(a(b),[c,d,e,f,h,i])}function w(a,b,c,d,e,f,g,h){var i=a.length;if(i===7)return a(b,c,d,e,f,g,h);else return v(a,b,c,d,e,f,g,h,i)}function x(a){var b=a.length;if(b===7)return a;else return function(b,c,d,e,f,g,h){return w(a,b,c,d,e,f,g,h)}}function y(a,b,c,d,e,f,h,i,j,k){__p&&__p();var l=0;if(k>7||k<0)return g(a,[b,c,d,e,f,h,i,j]);else switch(k){case 0:case 1:l=1;break;case 2:return g(a(b,c),[d,e,f,h,i,j]);case 3:return g(a(b,c,d),[e,f,h,i,j]);case 4:return g(a(b,c,d,e),[f,h,i,j]);case 5:return g(a(b,c,d,e,f),[h,i,j]);case 6:return g(a(b,c,d,e,f,h),[i,j]);case 7:return g(a(b,c,d,e,f,h,i),[j])}if(l===1)return g(a(b),[c,d,e,f,h,i,j])}function z(a,b,c,d,e,f,g,h,i){var j=a.length;if(j===8)return a(b,c,d,e,f,g,h,i);else return y(a,b,c,d,e,f,g,h,i,j)}function A(a){var b=a.length;if(b===8)return a;else return function(b,c,d,e,f,g,h,i){return z(a,b,c,d,e,f,g,h,i)}}f.app=g;f.curry_1=h;f._1=i;f.__1=a;f.curry_2=j;f._2=k;f.__2=c;f.curry_3=l;f._3=m;f.__3=d;f.curry_4=n;f._4=o;f.__4=e;f.curry_5=p;f._5=q;f.__5=r;f.curry_6=s;f._6=t;f.__6=u;f.curry_7=v;f._7=w;f.__7=x;f.curry_8=y;f._8=z;f.__8=A}),null);
__d("bs_caml_utils",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=String.prototype.repeat&&function(a,b){return b.repeat(a)}||function(a,b){__p&&__p();if(b.length==0||a==0)return"";if(b.length*a>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var c="";for(;;){(a&1)==1&&(c+=b);a>>>=1;if(a==0)break;b+=b}return c};f.repeat=a}),null);
__d("bs_caml_int64",["bs_caml_int32","bs_caml_utils","bs_caml_primitive","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=[-2147483648,0],h=[2147483647,1],i=[0,1],j=[0,0],k=[-1,4294967295];function l(a){return(a&2147483648)!==0}function m(a,b){var c=b[1],d=a[1],e=d+c&4294967295;d=l(d)&&(l(c)||!l(e))||l(c)&&!l(e)?1:0;c=a[0]+b[0]+d&4294967295;return[c,e>>>0]}function n(a){var b=a[0]^-1;a=a[1]^-1;return[b,a>>>0]}function o(a,b){if(a[0]===b[0])return a[1]===b[1];else return!1}function a(a,b){if(b!==null)return o(a,b);else return!1}function c(a,b){if(b!==undefined)return o(a,b);else return!1}function d(a,b){if(b==null)return!1;else return o(a,b)}function p(a){if(o(a,g))return g;else return m(n(a),i)}function e(a,b){return m(a,p(b))}function q(a,b){if(b===0)return a;else{var c=a[1];if(b>=32)return[c<<(b-32|0),0];else{a=c>>>(32-b|0)|a[0]<<b;return[a,c<<b>>>0]}}}function r(a,b){__p&&__p();if(b===0)return a;else{var c=a[0],d=b-32|0;if(d===0)return[0,c>>>0];else if(d>0){var e=c>>>d;return[0,e>>>0]}else{e=c>>>b;c=c<<(-d|0)|a[1]>>>b;return[e,c>>>0]}}}function s(a,b){__p&&__p();if(b===0)return a;else{var c=a[0];if(b<32){var d=c>>b;a=c<<(32-b|0)|a[1]>>>b;return[d,a>>>0]}else{d=c>>(b-32|0);return[c>=0?0:-1,d>>>0]}}}function t(a){if(a[0]!==0||a[1]!==0)return!1;else return!0}function u(a,b){__p&&__p();while(!0){var c=b,d=a,e=0,f,h=d[0],i=0,k=0,l;if(h!==0||d[1]!==0)l=4;else return j;if(l===4)if(c[0]!==0||c[1]!==0)k=3;else return j;k===3&&(h!==-2147483648||d[1]!==0?i=2:(f=c[1],e=1));if(i===2){l=c[0];k=d[1];i=0;l!==-2147483648||c[1]!==0?i=3:(f=k,e=1);if(i===3){i=c[1];if(h<0)if(l<0){b=p(c);a=p(d);continue}else return p(u(p(d),c));else if(l<0)return p(u(d,p(c)));else{d=h>>>16;c=h&65535;h=k>>>16;k=k&65535;var m=l>>>16;l=l&65535;var n=i>>>16;i=i&65535;var o,q,r,s=k*i;r=(s>>>16)+h*i;q=r>>>16;r=(r&65535)+k*n;q=q+(r>>>16)+c*i;o=q>>>16;q=(q&65535)+h*n;o+=q>>>16;q=(q&65535)+k*l;o+=q>>>16;q=q&65535;o=o+(d*i+c*n+h*l+k*m)&65535;d=q|o<<16;i=s&65535|(r&65535)<<16;return[d,i>>>0]}}}if(e===1)if((f&1)===0)return j;else return g}}function v(a){var c=b("bs_caml_int32").caml_int32_bswap(a[1]);a=b("bs_caml_int32").caml_int32_bswap(a[0]);return[c,a>>>0]}function w(a,b){return[a[0]^b[0],(a[1]^b[1])>>>0]}function x(a,b){return[a[0]|b[0],(a[1]|b[1])>>>0]}function y(a,b){return[a[0]&b[0],(a[1]&b[1])>>>0]}function z(a,b){var c=b[0],d=a[0];if(d>c)return!0;else if(d<c)return!1;else return a[1]>=b[1]}function A(a,b){return!o(a,b)}function B(a,b){return!z(a,b)}function C(a,b){if(a[0]>b[0])return!0;else if(a[0]<b[0])return!1;else return a[1]>b[1]}function D(a,b){return!C(a,b)}function E(a,b){if(z(a,b))return b;else return a}function F(a,b){if(C(a,b))return a;else return b}function G(a){return a[0]*4294967296+a[1]}var H=Math.pow(2,32),I=Math.pow(2,63),J=-Math.pow(2,63);function K(a){__p&&__p();if(isNaN(a)||!isFinite(a))return j;else if(a<=J)return g;else if(a+1>=I)return h;else if(a<0)return p(K(-a));else{var b=a/H|0;a=a%H|0;return[b,a>>>0]}}function L(a,c){__p&&__p();while(!0){var d=c,e=a,f=e[0],h=0,l;if(d[0]!==0||d[1]!==0)l=2;else throw b("bs_caml_builtin_exceptions").division_by_zero;if(l===2)if(f!==-2147483648)if(f!==0||e[1]!==0)h=1;else return j;else if(e[1]!==0)h=1;else if(o(d,i)||o(d,k))return e;else if(o(d,g))return i;else{l=d[0];var n=s(e,1);n=q(L(n,d),1);var r;if(n[0]!==0||n[1]!==0)r=3;else if(l<0)return i;else return p(i);if(r===3){l=u(d,n);r=m(e,p(l));return m(n,L(r,d))}}if(h===1){l=d[0];if(l!==-2147483648||d[1]!==0)n=2;else return j;if(n===2)if(f<0)if(l<0){c=p(d);a=p(e);continue}else return p(L(p(e),d));else if(l<0)return p(L(e,p(d)));else{r=j;h=e;while(z(h,d)){n=b("bs_caml_primitive").caml_float_max(1,Math.floor(G(h)/G(d)));f=Math.ceil(Math.log(n)/Math.LN2);l=f<=48?1:Math.pow(2,f-48);e=K(n);f=u(e,d);while(f[0]<0||C(f,h))n-=l,e=K(n),f=u(e,d);t(e)&&(e=i);r=m(r,e);h=m(h,p(f))}return r}}}}function M(a,b){b=u(L(a,b),b);return m(a,p(b))}function N(a,b){var c=L(a,b);b=u(c,b);return[c,m(a,p(b))]}function O(a,c){var d=b("bs_caml_primitive").caml_nativeint_compare(a[0],c[0]);if(d===0)return b("bs_caml_primitive").caml_nativeint_compare(a[1],c[1]);else return d}function P(a){return[a<0?-1:0,a>>>0]}function Q(a){return a[1]|0}function R(a){__p&&__p();var c=function(a){return(a>>>0).toString(16)},d=a[0],e=a[1],f;if(d!==0||e!==0)f=1;else return"0";if(f===1)if(e!==0)if(d!==0){f=c(a[1]);e=8-f.length|0;if(e<=0)return c(a[0])+f;else return c(a[0])+(b("bs_caml_utils").repeat(e,"0")+f)}else return c(a[1]);else return c(a[0])+"00000000"}function S(a){return[2147483647&a[0],a[1]]}function T(a){a=new Int32Array([a[1],a[0]]);return new Float64Array(a.buffer)[0]}function U(a){a=new Float64Array([a]);a=new Int32Array(a.buffer);var b=a[1];b=b;a=a[0];a=a;return[b,a>>>0]}function V(a,b){var c=a.charCodeAt(b+4|0)<<32|a.charCodeAt(b+5|0)<<40|a.charCodeAt(b+6|0)<<48|a.charCodeAt(b+7|0)<<56;a=a.charCodeAt(b)|a.charCodeAt(b+1|0)<<8|a.charCodeAt(b+2|0)<<16|a.charCodeAt(b+3|0)<<24;return[c,a>>>0]}f.min_int=g;f.max_int=h;f.one=i;f.zero=j;f.not=n;f.of_int32=P;f.to_int32=Q;f.add=m;f.neg=p;f.sub=e;f.lsl_=q;f.lsr_=r;f.asr_=s;f.is_zero=t;f.mul=u;f.xor=w;f.or_=x;f.and_=y;f.swap=v;f.ge=z;f.eq=o;f.neq=A;f.lt=B;f.gt=C;f.le=D;f.equal_null=a;f.equal_undefined=c;f.equal_nullable=d;f.min=E;f.max=F;f.to_float=G;f.of_float=K;f.div=L;f.mod_=M;f.div_mod=N;f.compare=O;f.to_hex=R;f.discard_sign=S;f.float_of_bits=T;f.bits_of_float=U;f.get64=V}),null);
__d("bs_caml_format",["bs_curry","bs_caml_int32","bs_caml_int64","bs_caml_utils","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){throw[b("bs_caml_builtin_exceptions").failure,a]}function h(a){__p&&__p();if(a>=65)if(a>=97)if(a>=123)return-1;else return a-87|0;else if(a>=91)return-1;else return a-55|0;else if(a>57||a<48)return-1;else return a-48|0}function i(a){switch(a){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}function j(a){var b=1,c=2,d=0;a[d]==="-"&&(b=-1,d=d+1|0);var e=a.charCodeAt(d);a=a.charCodeAt(d+1|0);e===48&&(a>=89?a!==98?a!==111?a===120&&(c=1,d=d+2|0):(c=0,d=d+2|0):(c=3,d=d+2|0):a!==66?a!==79?a>=88&&(c=1,d=d+2|0):(c=0,d=d+2|0):(c=3,d=d+2|0));return[d,b,c]}function a(a){__p&&__p();var c=j(a),d=c[0],e=i(c[2]),f=4294967295,g=a.length,k=d<g?a.charCodeAt(d):0;k=h(k);if(k<0||k>=e)throw[b("bs_caml_builtin_exceptions").failure,"int_of_string"];var l=function(c,d){__p&&__p();while(!0){var i=d,j=c;if(i===g)return j;else{var k=a.charCodeAt(i);if(k===95){d=i+1|0;continue}else{k=h(k);if(k<0||k>=e)throw[b("bs_caml_builtin_exceptions").failure,"int_of_string"];else{j=e*j+k;if(j>f)throw[b("bs_caml_builtin_exceptions").failure,"int_of_string"];else{d=i+1|0;c=j;continue}}}}}};c=c[1]*l(k,d+1|0);l=c|0;if(e===10&&c!==l)throw[b("bs_caml_builtin_exceptions").failure,"int_of_string"];return l}function c(a){__p&&__p();var c=j(a),d=c[2],e=c[0],f=b("bs_caml_int64").of_int32(i(d));c=b("bs_caml_int64").of_int32(c[1]);var g;switch(d){case 0:g=[536870911,4294967295];break;case 1:g=[268435455,4294967295];break;case 2:g=[429496729,2576980377];break;case 3:g=[2147483647,4294967295];break}var k=a.length;d=e<k?a.charCodeAt(e):0;d=b("bs_caml_int64").of_int32(h(d));if(b("bs_caml_int64").lt(d,[0,0])||b("bs_caml_int64").ge(d,f))throw[b("bs_caml_builtin_exceptions").failure,"int64_of_string"];var l=function(c,d){__p&&__p();while(!0){var e=d,i=c;if(e===k)return i;else{var j=a.charCodeAt(e);if(j===95){d=e+1|0;continue}else{j=b("bs_caml_int64").of_int32(h(j));if(b("bs_caml_int64").lt(j,[0,0])||b("bs_caml_int64").ge(j,f)||b("bs_caml_int64").gt(i,g))throw[b("bs_caml_builtin_exceptions").failure,"int64_of_string"];else{i=b("bs_caml_int64").add(b("bs_caml_int64").mul(f,i),j);d=e+1|0;c=i;continue}}}}};c=b("bs_caml_int64").mul(c,l(d,e+1|0));l=b("bs_caml_int64").or_(c,[0,0]);if(b("bs_caml_int64").eq(f,[0,10])&&b("bs_caml_int64").neq(c,l))throw[b("bs_caml_builtin_exceptions").failure,"int64_of_string"];return l}function k(a){switch(a){case 0:return 8;case 1:return 16;case 2:return 10}}function l(a){if(a>=65&&a<=90||a>=192&&a<=214||a>=216&&a<=222)return a+32|0;else return a}function m(a){__p&&__p();var c=a.length;if(c>31)throw[b("bs_caml_builtin_exceptions").invalid_argument,"format_int: format too long"];var d=["+","-"," ",!1,2,!1,0,!1,1,-1,"f"],e=0;while(!0){var f=e;if(f>=c)return d;else{var g=a.charCodeAt(f),h=0;if(g>=69)if(g>=88)if(g>=121)h=1;else switch(g-88|0){case 0:d[4]=1;d[7]=!0;e=f+1|0;continue;case 13:case 14:case 15:h=5;break;case 12:case 17:h=4;break;case 23:d[4]=0;e=f+1|0;continue;case 29:d[4]=2;e=f+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:h=1;break;case 32:d[4]=1;e=f+1|0;continue}else if(g>=72)h=1;else{d[5]=!0;d[7]=!0;d[10]=String.fromCharCode(l(g));e=f+1|0;continue}else{var i=g-32|0;if(i>25||i<0)h=1;else switch(i){case 3:d[3]=!0;e=f+1|0;continue;case 0:case 11:h=2;break;case 13:d[0]="-";e=f+1|0;continue;case 14:d[9]=0;i=f+1|0;while(function(b){return function(){var c=a.charCodeAt(b)-48|0;return c>=0&&c<=9}}(i)())d[9]=(b("bs_caml_int32").imul(d[9],10)+a.charCodeAt(i)|0)-48|0,i=i+1|0;e=i;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 15:h=1;break;case 16:d[2]="0";e=f+1|0;continue;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:h=3;break}}switch(h){case 1:e=f+1|0;continue;case 2:d[1]=String.fromCharCode(g);e=f+1|0;continue;case 3:d[6]=0;i=f;while(function(b){return function(){var c=a.charCodeAt(b)-48|0;return c>=0&&c<=9}}(i)())d[6]=(b("bs_caml_int32").imul(d[6],10)+a.charCodeAt(i)|0)-48|0,i=i+1|0;e=i;continue;case 4:d[5]=!0;d[4]=2;e=f+1|0;continue;case 5:d[5]=!0;d[10]=String.fromCharCode(g);e=f+1|0;continue}}}}function n(a,b){__p&&__p();var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7];a=a[8];var k=b.length;h&&(a<0||d!=="-")&&(k=k+1|0);f&&(g===0?k=k+1|0:g===1&&(k=k+2|0));var l="";if(c==="+"&&e===" ")for(var m=k,n=i-1|0;m<=n;++m)l=l+e;h&&(a<0?l=l+"-":d!=="-"&&(l=l+d));f&&g===0&&(l=l+"0");f&&g===1&&(l=l+"0x");if(c==="+"&&e==="0")for(var m=k,n=i-1|0;m<=n;++m)l=l+e;l=j?l+b.toUpperCase():l+b;if(c==="-")for(var h=k,a=i-1|0;h<=a;++h)l=l+" ";return l}function d(a,c){__p&&__p();if(a==="%d")return String(c);else{a=m(a);a=a;c=c;c=c<0?a[5]?(a[8]=-1,-c):c>>>0:c;c=c.toString(k(a[4]));if(a[9]>=0){a[2]=" ";var d=a[9]-c.length|0;d>0&&(c=b("bs_caml_utils").repeat(d,"0")+c)}return n(a,c)}}function e(a,c){__p&&__p();a=m(a);c=a[5]&&b("bs_caml_int64").lt(c,[0,0])?(a[8]=-1,b("bs_caml_int64").neg(c)):c;var d="",e=a[4];switch(e){case 0:e=[0,8];var f="01234567";if(b("bs_caml_int64").lt(c,[0,0])){var g=b("bs_caml_int64").discard_sign(c);g=b("bs_caml_int64").div_mod(g,e);var h=b("bs_caml_int64").add([268435456,0],g[0]);g=g[1];d=String.fromCharCode(f.charCodeAt(g[1]|0))+d;while(b("bs_caml_int64").neq(h,[0,0])){var i=b("bs_caml_int64").div_mod(h,e);h=i[0];g=i[1];d=String.fromCharCode(f.charCodeAt(g[1]|0))+d}}else{i=b("bs_caml_int64").div_mod(c,e);g=i[0];h=i[1];d=String.fromCharCode(f.charCodeAt(h[1]|0))+d;while(b("bs_caml_int64").neq(g,[0,0])){i=b("bs_caml_int64").div_mod(g,e);g=i[0];h=i[1];d=String.fromCharCode(f.charCodeAt(h[1]|0))+d}}break;case 1:d=b("bs_caml_int64").to_hex(c)+d;break;case 2:i=[0,10];h="0123456789";if(b("bs_caml_int64").lt(c,[0,0])){f=b("bs_caml_int64").discard_sign(c);g=b("bs_caml_int64").div_mod(f,i);e=b("bs_caml_int64").div_mod(b("bs_caml_int64").add([0,8],g[1]),i);f=b("bs_caml_int64").add(b("bs_caml_int64").add([214748364,3435973836],g[0]),e[0]);g=e[1];d=String.fromCharCode(h.charCodeAt(g[1]|0))+d;while(b("bs_caml_int64").neq(f,[0,0])){e=b("bs_caml_int64").div_mod(f,i);f=e[0];g=e[1];d=String.fromCharCode(h.charCodeAt(g[1]|0))+d}}else{e=b("bs_caml_int64").div_mod(c,i);g=e[0];f=e[1];d=String.fromCharCode(h.charCodeAt(f[1]|0))+d;while(b("bs_caml_int64").neq(g,[0,0])){c=b("bs_caml_int64").div_mod(g,i);g=c[0];f=c[1];d=String.fromCharCode(h.charCodeAt(f[1]|0))+d}}break}if(a[9]>=0){a[2]=" ";e=a[9]-d.length|0;e>0&&(d=b("bs_caml_utils").repeat(e,"0")+d)}return n(a,d)}function o(a,b){__p&&__p();a=m(a);var c=a[9]<0?6:a[9],d=b<0?(a[8]=-1,-b):b;b="";if(isNaN(d))b="nan",a[2]=" ";else if(isFinite(d)){var e=a[10];switch(e){case"e":b=d.toExponential(c);e=b.length;b[e-3|0]==="e"&&(b=b.slice(0,e-1|0)+("0"+b.slice(e-1|0)));break;case"f":b=d.toFixed(c);break;case"g":var f=c!==0?c:1;b=d.toExponential(f-1|0);e=b.indexOf("e");c=Number(b.slice(e+1|0))|0;if(c<-4||d>=1e21||d.toFixed().length>f){var g=e-1|0;while(b[g]==="0")g=g-1|0;b[g]==="."&&(g=g-1|0);b=b.slice(0,g+1|0)+b.slice(e);g=b.length;b[g-3|0]==="e"&&(b=b.slice(0,g-1|0)+("0"+b.slice(g-1|0)))}else{var h=f;if(c<0)h=h-(c+1|0)|0,b=d.toFixed(h);else while(function(){b=d.toFixed(h);return b.length>(f+1|0)}())h=h-1|0;if(h!==0){e=b.length-1|0;while(b[e]==="0")e=e-1|0;b[e]==="."&&(e=e-1|0);b=b.slice(0,e+1|0)}}break;default:}}else b="inf",a[2]=" ";return n(a,b)}var p=function(b,a){__p&&__p();var c=+b;if(b.length>0&&c===c)return c;b=b.replace(/_/g,"");c=+b;if(b.length>0&&c===c||/^[+-]?nan$/i.test(b))return c;if(/^ *0x[0-9a-f_]+p[+-]?[0-9_]+/i.test(b)){var d=b.indexOf("p");d=d==-1?b.indexOf("P"):d;var e=+b.substring(d+1);c=+b.substring(0,d);return c*Math.pow(2,e)}if(/^\+?inf(inity)?$/i.test(b))return Infinity;if(/^-inf(inity)?$/i.test(b))return-Infinity;a("float_of_string")};function q(a){return b("bs_curry")._2(p,a,g)}var r=d,s=d,t=a,u=a;f.caml_format_float=o;f.caml_format_int=d;f.caml_nativeint_format=r;f.caml_int32_format=s;f.caml_float_of_string=q;f.caml_int64_format=e;f.caml_int_of_string=a;f.caml_int32_of_string=t;f.caml_int64_of_string=c;f.caml_nativeint_of_string=u}),null);
__d("bs_caml_io",["bs_curry","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){return a+b}var g=["",function(a,b){__p&&__p();a=b.length-1|0;if(typeof process!=="undefined"&&process.stdout&&process.stdout.write)return process.stdout.write(b);else if(b[a]==="\n"){!1;return 0}else{!1;return 0}}],h=["",function(a,b){a=b.length-1|0;if(b[a]==="\n"){!1;return 0}else{!1;return 0}}];function c(){throw[b("bs_caml_builtin_exceptions").failure,"caml_ml_open_descriptor_in not implemented"]}function d(){throw[b("bs_caml_builtin_exceptions").failure,"caml_ml_open_descriptor_out not implemented"]}function i(a){if(a[0]!==""){b("bs_curry")._2(a[1],a,a[0]);a[0]="";return 0}else return 0}var j=function(a){return typeof process!=="undefined"&&process.stdout&&(process.stdout.write(a),!0)};function k(a,b,c,d){__p&&__p();b=c===0&&d===b.length?b:b.slice(c,d);if(typeof process!=="undefined"&&process.stdout&&process.stdout.write&&a===g)return process.stdout.write(b);else{c=b.lastIndexOf("\n");if(c<0){a[0]=a[0]+b;return 0}else{a[0]=a[0]+b.slice(0,c+1|0);i(a);a[0]=a[0]+b.slice(c+1|0);return 0}}}function e(a,b){return k(a,String.fromCharCode(b),0,1)}function l(a,c,d,e){throw[b("bs_caml_builtin_exceptions").failure,"caml_ml_input ic not implemented"]}function m(){throw[b("bs_caml_builtin_exceptions").failure,"caml_ml_input_char not implemnted"]}function n(){return[g,[h,0]]}var o=undefined;f.$caret=a;f.stdin=o;f.stdout=g;f.stderr=h;f.caml_ml_open_descriptor_in=c;f.caml_ml_open_descriptor_out=d;f.caml_ml_flush=i;f.node_std_output=j;f.caml_ml_output=k;f.caml_ml_output_char=e;f.caml_ml_input=l;f.caml_ml_input_char=m;f.caml_ml_out_channels_list=n}),null);
__d("bs_caml_missing_polyfill",[],(function(a,b,c,d,e,f){"use strict";function a(a){a=a+" not implemented by BuckleScript yet\n";throw new Error(a)}f.not_implemented=a}),null);
__d("bs_caml_sys",["bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){var c=typeof process==="undefined"?undefined:process;if(c!==undefined){c=c.env[a];if(c!==undefined)return c;else throw b("bs_caml_builtin_exceptions").not_found}else throw b("bs_caml_builtin_exceptions").not_found}function c(){var a=typeof process==="undefined"?undefined:process;if(a!==undefined)return a.uptime();else return-1}function d(){return[((Date.now()|0)^4294967295)*Math.random()|0]}function e(){return 127}function g(){var a=typeof process==="undefined"?undefined:process;if(a!==undefined)return a.cwd();else return"/"}function h(){var a=typeof process==="undefined"?undefined:process;if(a!==undefined)if(a.argv==null)return["",[""]];else return[a.argv[0],a.argv];else return["",[""]]}function i(a){var b=typeof process==="undefined"?undefined:process;if(b!==undefined)return b.exit(a);else return 0}function j(){throw[b("bs_caml_builtin_exceptions").failure,"caml_sys_is_directory not implemented"]}function k(){throw[b("bs_caml_builtin_exceptions").failure,"caml_sys_file_exists not implemented"]}f.caml_sys_getenv=a;f.caml_sys_time=c;f.caml_sys_random_seed=d;f.caml_sys_system_command=e;f.caml_sys_getcwd=g;f.caml_sys_get_argv=h;f.caml_sys_exit=i;f.caml_sys_is_directory=j;f.caml_sys_file_exists=k}),null);
__d("bs_camlinternalFormatBasics",["bs_block"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){__p&&__p();if(typeof a==="number")return 0;else switch(a.tag|0){case 0:return b("bs_block").__(0,[g(a[0])]);case 1:return b("bs_block").__(1,[g(a[0])]);case 2:return b("bs_block").__(2,[g(a[0])]);case 3:return b("bs_block").__(3,[g(a[0])]);case 4:return b("bs_block").__(4,[g(a[0])]);case 5:return b("bs_block").__(5,[g(a[0])]);case 6:return b("bs_block").__(6,[g(a[0])]);case 7:return b("bs_block").__(7,[g(a[0])]);case 8:return b("bs_block").__(8,[a[0],g(a[1])]);case 9:var c=a[0];return b("bs_block").__(9,[c,c,g(a[2])]);case 10:return b("bs_block").__(10,[g(a[0])]);case 11:return b("bs_block").__(11,[g(a[0])]);case 12:return b("bs_block").__(12,[g(a[0])]);case 13:return b("bs_block").__(13,[g(a[0])]);case 14:return b("bs_block").__(14,[g(a[0])])}}function h(a,c){__p&&__p();if(typeof a==="number")return c;else switch(a.tag|0){case 0:return b("bs_block").__(0,[h(a[0],c)]);case 1:return b("bs_block").__(1,[h(a[0],c)]);case 2:return b("bs_block").__(2,[h(a[0],c)]);case 3:return b("bs_block").__(3,[h(a[0],c)]);case 4:return b("bs_block").__(4,[h(a[0],c)]);case 5:return b("bs_block").__(5,[h(a[0],c)]);case 6:return b("bs_block").__(6,[h(a[0],c)]);case 7:return b("bs_block").__(7,[h(a[0],c)]);case 8:return b("bs_block").__(8,[a[0],h(a[1],c)]);case 9:return b("bs_block").__(9,[a[0],a[1],h(a[2],c)]);case 10:return b("bs_block").__(10,[h(a[0],c)]);case 11:return b("bs_block").__(11,[h(a[0],c)]);case 12:return b("bs_block").__(12,[h(a[0],c)]);case 13:return b("bs_block").__(13,[h(a[0],c)]);case 14:return b("bs_block").__(14,[h(a[0],c)])}}function i(a,c){__p&&__p();if(typeof a==="number")return c;else switch(a.tag|0){case 0:return b("bs_block").__(0,[i(a[0],c)]);case 1:return b("bs_block").__(1,[i(a[0],c)]);case 2:return b("bs_block").__(2,[a[0],i(a[1],c)]);case 3:return b("bs_block").__(3,[a[0],i(a[1],c)]);case 4:return b("bs_block").__(4,[a[0],a[1],a[2],i(a[3],c)]);case 5:return b("bs_block").__(5,[a[0],a[1],a[2],i(a[3],c)]);case 6:return b("bs_block").__(6,[a[0],a[1],a[2],i(a[3],c)]);case 7:return b("bs_block").__(7,[a[0],a[1],a[2],i(a[3],c)]);case 8:return b("bs_block").__(8,[a[0],a[1],a[2],i(a[3],c)]);case 9:return b("bs_block").__(9,[i(a[0],c)]);case 10:return b("bs_block").__(10,[i(a[0],c)]);case 11:return b("bs_block").__(11,[a[0],i(a[1],c)]);case 12:return b("bs_block").__(12,[a[0],i(a[1],c)]);case 13:return b("bs_block").__(13,[a[0],a[1],i(a[2],c)]);case 14:return b("bs_block").__(14,[a[0],a[1],i(a[2],c)]);case 15:return b("bs_block").__(15,[i(a[0],c)]);case 16:return b("bs_block").__(16,[i(a[0],c)]);case 17:return b("bs_block").__(17,[a[0],i(a[1],c)]);case 18:return b("bs_block").__(18,[a[0],i(a[1],c)]);case 19:return b("bs_block").__(19,[i(a[0],c)]);case 20:return b("bs_block").__(20,[a[0],a[1],i(a[2],c)]);case 21:return b("bs_block").__(21,[a[0],i(a[1],c)]);case 22:return b("bs_block").__(22,[i(a[0],c)]);case 23:return b("bs_block").__(23,[a[0],i(a[1],c)]);case 24:return b("bs_block").__(24,[a[0],a[1],i(a[2],c)])}}f.concat_fmtty=h;f.erase_rel=g;f.concat_fmt=i}),null);
__d("bs_pervasives",["bs_curry","bs_caml_io","bs_caml_sys","bs_caml_format","bs_caml_string","bs_caml_exceptions","bs_caml_missing_polyfill","bs_caml_builtin_exceptions","bs_camlinternalFormatBasics"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){throw[b("bs_caml_builtin_exceptions").failure,a]}function c(a){throw[b("bs_caml_builtin_exceptions").invalid_argument,a]}var g=b("bs_caml_exceptions").create("Pervasives.Exit");function d(a){if(a>=0)return a;else return-a|0}function e(a){return a^-1}var h=-2147483648;function i(a){if(a<0||a>255)throw[b("bs_caml_builtin_exceptions").invalid_argument,"char_of_int"];else return a}function j(a){if(a)return"true";else return"false"}function k(a){switch(a){case"false":return!1;case"true":return!0;default:throw[b("bs_caml_builtin_exceptions").invalid_argument,"bool_of_string"]}}function l(a){__p&&__p();var c=a.length,d=0;while(!0){var e=d;if(e>=c)return a+".";else{var f=b("bs_caml_string").get(a,e);if(f>=48)if(f>=58)return a;else{d=e+1|0;continue}else if(f!==45)return a;else{d=e+1|0;continue}}}}function m(a){return l(b("bs_caml_format").caml_format_float("%.12g",a))}function n(a,b){if(a)return[a[0],n(a[1],b)];else return b}var o=b("bs_caml_io").stdin,p=b("bs_caml_io").stdout,q=b("bs_caml_io").stderr;function r(a,c,d){return b("bs_caml_io").caml_ml_open_descriptor_out(b("bs_caml_missing_polyfill").not_implemented("caml_sys_open"))}function s(a){return r([1,[3,[4,[7,0]]]],438,a)}function t(a){return r([1,[3,[4,[6,0]]]],438,a)}function u(){__p&&__p();var a=b("bs_caml_io").caml_ml_out_channels_list(0);while(!0){var c=a;if(c){try{b("bs_caml_io").caml_ml_flush(c[0])}catch(a){}a=c[1];continue}else return 0}}function v(a,c){return b("bs_caml_io").caml_ml_output(a,c,0,c.length)}function w(a,c){return b("bs_caml_io").caml_ml_output(a,c,0,c.length)}function x(a,c,d,e){if(d<0||e<0||d>(c.length-e|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"output"];else return b("bs_caml_io").caml_ml_output(a,c,d,e)}function y(a,c,d,e){if(d<0||e<0||d>(c.length-e|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"output_substring"];else return b("bs_caml_io").caml_ml_output(a,c,d,e)}function z(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_output_value")}function A(a){b("bs_caml_io").caml_ml_flush(a);return b("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}function B(a){try{b("bs_caml_io").caml_ml_flush(a)}catch(a){}try{return b("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}catch(a){return 0}}function C(a,c,d){return b("bs_caml_io").caml_ml_open_descriptor_in(b("bs_caml_missing_polyfill").not_implemented("caml_sys_open"))}function D(a){return C([0,[7,0]],0,a)}function E(a){return C([0,[6,0]],0,a)}function F(a,c,d,e){if(d<0||e<0||d>(c.length-e|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"input"];else return b("bs_caml_missing_polyfill").not_implemented("caml_ml_input")}function G(a,c,d,e){__p&&__p();while(!0){a=e;c=d;if(a<=0)return 0;else{var f=b("bs_caml_missing_polyfill").not_implemented("caml_ml_input");if(f===0)throw b("bs_caml_builtin_exceptions").end_of_file;else{e=a-f|0;d=c+f|0;continue}}}}function H(a,c,d,e){if(d<0||e<0||d>(c.length-e|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"really_input"];else return G(a,c,d,e)}function I(a,c){var d=b("bs_caml_string").caml_create_string(c);H(a,d,0,c);return b("bs_caml_string").bytes_to_string(d)}function J(a){__p&&__p();var c=function(a,c,d){__p&&__p();while(!0){var e=d,f=c;if(e){var g=e[0],h=g.length;b("bs_caml_string").caml_blit_bytes(g,0,a,f-h|0,h);d=e[1];c=f-h|0;continue}else return a}},d=function(d,e){__p&&__p();while(!0){var f=e,g=d,h=b("bs_caml_missing_polyfill").not_implemented("caml_ml_input_scan_line");if(h===0)if(g)return c(b("bs_caml_string").caml_create_string(f),f,g);else throw b("bs_caml_builtin_exceptions").end_of_file;else if(h>0){var i=b("bs_caml_string").caml_create_string(h-1|0);b("bs_caml_missing_polyfill").not_implemented("caml_ml_input");b("bs_caml_io").caml_ml_input_char(a);if(g){var j=(f+h|0)-1|0;return c(b("bs_caml_string").caml_create_string(j),j,[i,g])}else return i}else{j=b("bs_caml_string").caml_create_string(-h|0);b("bs_caml_missing_polyfill").not_implemented("caml_ml_input");e=f-h|0;d=[j,g];continue}}};return b("bs_caml_string").bytes_to_string(d(0,0))}function K(){try{return b("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}catch(a){return 0}}function L(a){return b("bs_caml_io").caml_ml_output_char(p,a)}function M(a){return w(p,a)}function N(a){return v(p,a)}function O(a){return w(p,String(a))}function P(a){return w(p,l(b("bs_caml_format").caml_format_float("%.12g",a)))}function Q(){b("bs_caml_io").caml_ml_output_char(p,10);return b("bs_caml_io").caml_ml_flush(p)}function R(a){return b("bs_caml_io").caml_ml_output_char(q,a)}function S(a){return w(q,a)}function T(a){return v(q,a)}function U(a){return w(q,String(a))}function V(a){return w(q,l(b("bs_caml_format").caml_format_float("%.12g",a)))}function W(){b("bs_caml_io").caml_ml_output_char(q,10);return b("bs_caml_io").caml_ml_flush(q)}function X(){b("bs_caml_io").caml_ml_flush(p);return J(o)}function aa(){return b("bs_caml_format").caml_int_of_string((b("bs_caml_io").caml_ml_flush(p),J(o)))}function ba(){return b("bs_caml_format").caml_float_of_string((b("bs_caml_io").caml_ml_flush(p),J(o)))}function ca(a){return a[1]}function da(a,c){return[b("bs_camlinternalFormatBasics").concat_fmt(a[0],c[0]),a[1]+("%,"+c[1])]}var Y=[u];function ea(a){var c=Y[0];Y[0]=function(){b("bs_curry")._1(a,0);return b("bs_curry")._1(c,0)};return 0}function Z(){return b("bs_curry")._1(Y[0],0)}function fa(a){Z(0);return b("bs_caml_sys").caml_sys_exit(a)}var ga=2147483647,ha=2220446049250313e-31,ia=b("bs_caml_io").caml_ml_flush,ja=b("bs_caml_io").caml_ml_output_char,ka=b("bs_caml_io").caml_ml_output_char;function la(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_output_int")}function ma(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_out")}function na(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_out")}function oa(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size")}function pa(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_set_binary_mode")}var qa=b("bs_caml_io").caml_ml_input_char,ra=b("bs_caml_io").caml_ml_input_char;function sa(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_input_int")}function ta(){return b("bs_caml_missing_polyfill").not_implemented("caml_input_value")}function ua(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_in")}function va(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_in")}function wa(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size")}function xa(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_close_channel")}function ya(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_set_binary_mode")}function $(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_out_64")}function za(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_out_64")}function Aa(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size_64")}function Ba(a,c){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_seek_in_64")}function Ca(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_pos_in_64")}function Da(){return b("bs_caml_missing_polyfill").not_implemented("caml_ml_channel_size_64")}$=[$,za,Aa,Ba,Ca,Da];f.invalid_arg=c;f.failwith=a;f.Exit=g;f.abs=d;f.max_int=ga;f.min_int=h;f.lnot=e;f.epsilon_float=ha;f.char_of_int=i;f.string_of_bool=j;f.bool_of_string=k;f.string_of_float=m;f.$at=n;f.stdin=o;f.stdout=p;f.stderr=q;f.print_char=L;f.print_string=M;f.print_bytes=N;f.print_int=O;f.print_float=P;f.print_newline=Q;f.prerr_char=R;f.prerr_string=S;f.prerr_bytes=T;f.prerr_int=U;f.prerr_float=V;f.prerr_newline=W;f.read_line=X;f.read_int=aa;f.read_float=ba;f.open_out=s;f.open_out_bin=t;f.open_out_gen=r;f.flush=ia;f.flush_all=u;f.output_char=ja;f.output_string=w;f.output_bytes=v;f.output=x;f.output_substring=y;f.output_byte=ka;f.output_binary_int=la;f.output_value=z;f.seek_out=ma;f.pos_out=na;f.out_channel_length=oa;f.close_out=A;f.close_out_noerr=B;f.set_binary_mode_out=pa;f.open_in=D;f.open_in_bin=E;f.open_in_gen=C;f.input_char=qa;f.input_line=J;f.input=F;f.really_input=H;f.really_input_string=I;f.input_byte=ra;f.input_binary_int=sa;f.input_value=ta;f.seek_in=ua;f.pos_in=va;f.in_channel_length=wa;f.close_in=xa;f.close_in_noerr=K;f.set_binary_mode_in=ya;f.LargeFile=$;f.string_of_format=ca;f.$caret$caret=da;f.exit=fa;f.at_exit=ea;f.valid_float_lexem=l;f.unsafe_really_input=G;f.do_at_exit=Z}),null);
__d("bs_list",["bs_curry","bs_caml_obj","bs_pervasives","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){__p&&__p();var b=0;a=a;while(!0){var c=a,d=b;if(c){a=c[1];b=d+1|0;continue}else return d}}function a(a){if(a)return a[0];else throw[b("bs_caml_builtin_exceptions").failure,"hd"]}function c(a){if(a)return a[1];else throw[b("bs_caml_builtin_exceptions").failure,"tl"]}function d(a,c){__p&&__p();if(c<0)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.nth"];else{a=a;c=c;while(!0){var d=c,e=a;if(e)if(d===0)return e[0];else{c=d-1|0;a=e[1];continue}else throw[b("bs_caml_builtin_exceptions").failure,"nth"]}}}function h(a,b){while(!0){var c=b,d=a;if(d){b=[d[0],c];a=d[1];continue}else return c}}function e(a){return h(a,0)}function i(a){if(a)return b("bs_pervasives").$at(a[0],i(a[1]));else return 0}function j(a,c){if(c){var d=b("bs_curry")._1(a,c[0]);return[d,j(a,c[1])]}else return 0}function k(a,c,d){if(d){var e=b("bs_curry")._2(c,a,d[0]);return[e,k(a+1|0,c,d[1])]}else return 0}function l(a,b){return k(0,a,b)}function m(a,c){__p&&__p();var d=0;c=c;while(!0){var e=c,f=d;if(e){c=e[1];d=[b("bs_curry")._1(a,e[0]),f];continue}else return f}}function n(a,c){while(!0){var d=c;if(d){b("bs_curry")._1(a,d[0]);c=d[1];continue}else return 0}}function o(a,c){__p&&__p();var d=0;a=a;c=c;while(!0){var e=c,f=d;if(e){b("bs_curry")._2(a,f,e[0]);c=e[1];d=f+1|0;continue}else return 0}}function p(a,c,d){while(!0){var e=d,f=c;if(e){d=e[1];c=b("bs_curry")._2(a,f,e[0]);continue}else return f}}function q(a,c,d){if(c)return b("bs_curry")._2(a,c[0],q(a,c[1],d));else return d}function r(a,c,d){if(c)if(d){var e=b("bs_curry")._2(a,c[0],d[0]);return[e,r(a,c[1],d[1])]}else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.map2"];else if(d)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.map2"];else return 0}function s(a,c,d){__p&&__p();var e=0;c=c;d=d;while(!0){var f=d,g=c,h=e;if(g)if(f){d=f[1];c=g[1];e=[b("bs_curry")._2(a,g[0],f[0]),h];continue}else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.rev_map2"];else if(f)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.rev_map2"];else return h}}function t(a,c,d){__p&&__p();while(!0){var e=d,f=c;if(f)if(e){b("bs_curry")._2(a,f[0],e[0]);d=e[1];c=f[1];continue}else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.iter2"];else if(e)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.iter2"];else return 0}}function u(a,c,d,e){__p&&__p();while(!0){var f=e,g=d,h=c;if(g)if(f){e=f[1];d=g[1];c=b("bs_curry")._3(a,h,g[0],f[0]);continue}else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.fold_left2"];else if(f)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.fold_left2"];else return h}}function v(a,c,d,e){if(c)if(d)return b("bs_curry")._3(a,c[0],d[0],v(a,c[1],d[1],e));else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.fold_right2"];else if(d)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.fold_right2"];else return e}function w(a,c){__p&&__p();while(!0){var d=c;if(d)if(b("bs_curry")._1(a,d[0])){c=d[1];continue}else return!1;else return!0}}function x(a,c){__p&&__p();while(!0){var d=c;if(d)if(b("bs_curry")._1(a,d[0]))return!0;else{c=d[1];continue}else return!1}}function y(a,c,d){__p&&__p();while(!0){var e=d,f=c;if(f)if(e)if(b("bs_curry")._2(a,f[0],e[0])){d=e[1];c=f[1];continue}else return!1;else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.for_all2"];else if(e)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.for_all2"];else return!0}}function z(a,c,d){__p&&__p();while(!0){var e=d,f=c;if(f)if(e)if(b("bs_curry")._2(a,f[0],e[0]))return!0;else{d=e[1];c=f[1];continue}else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.exists2"];else if(e)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.exists2"];else return!1}}function A(a,c){__p&&__p();while(!0){var d=c;if(d)if(b("bs_caml_obj").caml_equal(d[0],a))return!0;else{c=d[1];continue}else return!1}}function B(a,b){__p&&__p();while(!0){var c=b;if(c)if(c[0]===a)return!0;else{b=c[1];continue}else return!1}}function C(a,c){__p&&__p();while(!0){var d=c;if(d){var e=d[0];if(b("bs_caml_obj").caml_equal(e[0],a))return e[1];else{c=d[1];continue}}else throw b("bs_caml_builtin_exceptions").not_found}}function D(a,c){__p&&__p();while(!0){var d=c;if(d){var e=d[0];if(e[0]===a)return e[1];else{c=d[1];continue}}else throw b("bs_caml_builtin_exceptions").not_found}}function E(a,c){__p&&__p();while(!0){var d=c;if(d)if(b("bs_caml_obj").caml_equal(d[0][0],a))return!0;else{c=d[1];continue}else return!1}}function F(a,b){__p&&__p();while(!0){var c=b;if(c)if(c[0][0]===a)return!0;else{b=c[1];continue}else return!1}}function G(a,c){if(c){var d=c[1];c=c[0];if(b("bs_caml_obj").caml_equal(c[0],a))return d;else return[c,G(a,d)]}else return 0}function H(a,b){if(b){var c=b[1];b=b[0];if(b[0]===a)return c;else return[b,H(a,c)]}else return 0}function I(a,c){__p&&__p();while(!0){var d=c;if(d){var e=d[0];if(b("bs_curry")._1(a,e))return e;else{c=d[1];continue}}else throw b("bs_caml_builtin_exceptions").not_found}}function J(a){__p&&__p();return function(c){__p&&__p();var d=0;c=c;while(!0){var e=c,f=d;if(e){var g=e[1];e=e[0];if(b("bs_curry")._1(a,e)){c=g;d=[e,f];continue}else{c=g;continue}}else return h(f,0)}}}function K(a,c){__p&&__p();var d=0,e=0;c=c;while(!0){var f=c,g=e,i=d;if(f){var j=f[1];f=f[0];if(b("bs_curry")._1(a,f)){c=j;d=[f,i];continue}else{c=j;e=[f,g];continue}}else return[h(i,0),h(g,0)]}}function L(a){if(a){var b=a[0];a=L(a[1]);return[[b[0],a[0]],[b[1],a[1]]]}else return[0,0]}function M(a,c){if(a)if(c)return[[a[0],c[0]],M(a[1],c[1])];else throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.combine"];else if(c)throw[b("bs_caml_builtin_exceptions").invalid_argument,"List.combine"];else return 0}function N(a,c,d){if(c)if(d){var e=d[0],f=c[0];if(b("bs_curry")._2(a,f,e)<=0)return[f,N(a,c[1],d)];else return[e,N(a,c,d[1])]}else return c;else return d}function O(a,c){__p&&__p();while(!0){var d=c,e=a;if(e===0)return d;else if(d){c=d[1];a=e-1|0;continue}else throw[b("bs_caml_builtin_exceptions").assert_failure,["list.ml",223,11]]}}function P(c,d){__p&&__p();var a=function(d,a){__p&&__p();var f;if(d!==2)if(d!==3||!a)f=1;else{var g=a[1];if(g){var i=g[1];if(i){i=i[0];g=g[0];var j=a[0];if(b("bs_curry")._2(c,j,g)<=0)if(b("bs_curry")._2(c,g,i)<=0)return[j,[g,[i,0]]];else if(b("bs_curry")._2(c,j,i)<=0)return[j,[i,[g,0]]];else return[i,[j,[g,0]]];else if(b("bs_curry")._2(c,j,i)<=0)return[g,[j,[i,0]]];else if(b("bs_curry")._2(c,g,i)<=0)return[g,[i,[j,0]]];else return[i,[g,[j,0]]]}else f=1}else f=1}else if(a){i=a[1];if(i){g=i[0];j=a[0];if(b("bs_curry")._2(c,j,g)<=0)return[j,[g,0]];else return[g,[j,0]]}else f=1}else f=1;if(f===1){i=d>>1;g=d-i|0;j=O(i,a);f=e(i,a);d=e(g,j);i=f;a=d;g=0;while(!0){j=g;f=a;d=i;if(d)if(f){var k=f[0],l=d[0];if(b("bs_curry")._2(c,l,k)>0){g=[l,j];i=d[1];continue}else{g=[k,j];a=f[1];continue}}else return h(d,j);else return h(f,j)}}},e=function(e,d){__p&&__p();var f;if(e!==2)if(e!==3||!d)f=1;else{var g=d[1];if(g){var i=g[1];if(i){i=i[0];g=g[0];var j=d[0];if(b("bs_curry")._2(c,j,g)>0)if(b("bs_curry")._2(c,g,i)>0)return[j,[g,[i,0]]];else if(b("bs_curry")._2(c,j,i)>0)return[j,[i,[g,0]]];else return[i,[j,[g,0]]];else if(b("bs_curry")._2(c,j,i)>0)return[g,[j,[i,0]]];else if(b("bs_curry")._2(c,g,i)>0)return[g,[i,[j,0]]];else return[i,[g,[j,0]]]}else f=1}else f=1}else if(d){i=d[1];if(i){g=i[0];j=d[0];if(b("bs_curry")._2(c,j,g)>0)return[j,[g,0]];else return[g,[j,0]]}else f=1}else f=1;if(f===1){i=e>>1;g=e-i|0;j=O(i,d);f=a(i,d);e=a(g,j);i=f;d=e;g=0;while(!0){j=g;f=d;e=i;if(e)if(f){var k=f[0],l=e[0];if(b("bs_curry")._2(c,l,k)<=0){g=[l,j];i=e[1];continue}else{g=[k,j];d=f[1];continue}}else return h(e,j);else return h(f,j)}}},f=g(d);if(f<2)return d;else return a(f,d)}function Q(c,d){__p&&__p();var a=function(d,a){__p&&__p();var f;if(d!==2)if(d!==3||!a)f=1;else{var g=a[1];if(g){var i=g[1];if(i){i=i[0];g=g[0];var j=a[0],k=b("bs_curry")._2(c,j,g);if(k===0){var l=b("bs_curry")._2(c,g,i);if(l===0)return[g,0];else if(l<0)return[g,[i,0]];else return[i,[g,0]]}else if(k<0){l=b("bs_curry")._2(c,g,i);if(l===0)return[j,[g,0]];else if(l<0)return[j,[g,[i,0]]];else{k=b("bs_curry")._2(c,j,i);if(k===0)return[j,[g,0]];else if(k<0)return[j,[i,[g,0]]];else return[i,[j,[g,0]]]}}else{l=b("bs_curry")._2(c,j,i);if(l===0)return[g,[j,0]];else if(l<0)return[g,[j,[i,0]]];else{k=b("bs_curry")._2(c,g,i);if(k===0)return[g,[j,0]];else if(k<0)return[g,[i,[j,0]]];else return[i,[g,[j,0]]]}}}else f=1}else f=1}else if(a){l=a[1];if(l){k=l[0];i=a[0];g=b("bs_curry")._2(c,i,k);if(g===0)return[i,0];else if(g<0)return[i,[k,0]];else return[k,[i,0]]}else f=1}else f=1;if(f===1){j=d>>1;l=d-j|0;g=O(j,a);k=e(j,a);i=e(l,g);f=k;d=i;j=0;while(!0){a=j;l=d;g=f;if(g)if(l){k=l[1];i=l[0];var m=g[1],n=g[0],o=b("bs_curry")._2(c,n,i);if(o===0){j=[n,a];d=k;f=m;continue}else if(o>0){j=[n,a];f=m;continue}else{j=[i,a];d=k;continue}}else return h(g,a);else return h(l,a)}}},e=function(e,d){__p&&__p();var f;if(e!==2)if(e!==3||!d)f=1;else{var g=d[1];if(g){var i=g[1];if(i){i=i[0];g=g[0];var j=d[0],k=b("bs_curry")._2(c,j,g);if(k===0){var l=b("bs_curry")._2(c,g,i);if(l===0)return[g,0];else if(l>0)return[g,[i,0]];else return[i,[g,0]]}else if(k>0){l=b("bs_curry")._2(c,g,i);if(l===0)return[j,[g,0]];else if(l>0)return[j,[g,[i,0]]];else{k=b("bs_curry")._2(c,j,i);if(k===0)return[j,[g,0]];else if(k>0)return[j,[i,[g,0]]];else return[i,[j,[g,0]]]}}else{l=b("bs_curry")._2(c,j,i);if(l===0)return[g,[j,0]];else if(l>0)return[g,[j,[i,0]]];else{k=b("bs_curry")._2(c,g,i);if(k===0)return[g,[j,0]];else if(k>0)return[g,[i,[j,0]]];else return[i,[g,[j,0]]]}}}else f=1}else f=1}else if(d){l=d[1];if(l){k=l[0];i=d[0];g=b("bs_curry")._2(c,i,k);if(g===0)return[i,0];else if(g>0)return[i,[k,0]];else return[k,[i,0]]}else f=1}else f=1;if(f===1){j=e>>1;l=e-j|0;g=O(j,d);k=a(j,d);i=a(l,g);f=k;e=i;j=0;while(!0){d=j;l=e;g=f;if(g)if(l){k=l[1];i=l[0];var m=g[1],n=g[0],o=b("bs_curry")._2(c,n,i);if(o===0){j=[n,d];e=k;f=m;continue}else if(o<0){j=[n,d];f=m;continue}else{j=[i,d];e=k;continue}}else return h(g,d);else return h(l,d)}}},f=g(d);if(f<2)return d;else return a(f,d)}var R=b("bs_pervasives").$at,S=i,T=J,U=P,V=P;f.length=g;f.hd=a;f.tl=c;f.nth=d;f.rev=e;f.append=R;f.rev_append=h;f.concat=S;f.flatten=i;f.iter=n;f.iteri=o;f.map=j;f.mapi=l;f.rev_map=m;f.fold_left=p;f.fold_right=q;f.iter2=t;f.map2=r;f.rev_map2=s;f.fold_left2=u;f.fold_right2=v;f.for_all=w;f.exists=x;f.for_all2=y;f.exists2=z;f.mem=A;f.memq=B;f.find=I;f.filter=T;f.find_all=J;f.partition=K;f.assoc=C;f.assq=D;f.mem_assoc=E;f.mem_assq=F;f.remove_assoc=G;f.remove_assq=H;f.split=L;f.combine=M;f.sort=U;f.stable_sort=P;f.fast_sort=V;f.sort_uniq=Q;f.merge=N}),null);
__d("bs_bytes",["bs_char","bs_list","bs_curry","bs_caml_obj","bs_caml_int32","bs_caml_string","bs_caml_primitive","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){var d=b("bs_caml_string").caml_create_string(a);b("bs_caml_string").caml_fill_string(d,0,a,c);return d}function c(a,c){var d=b("bs_caml_string").caml_create_string(a);for(var e=0,a=a-1|0;e<=a;++e)d[e]=b("bs_curry")._1(c,e);return d}var g=[];function h(a){var c=a.length,d=b("bs_caml_string").caml_create_string(c);b("bs_caml_string").caml_blit_bytes(a,0,d,0,c);return d}function d(a){return b("bs_caml_string").bytes_to_string(h(a))}function e(a){return h(b("bs_caml_string").bytes_of_string(a))}function i(a,c,d){if(c<0||d<0||c>(a.length-d|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.sub / Bytes.sub"];else{var e=b("bs_caml_string").caml_create_string(d);b("bs_caml_string").caml_blit_bytes(a,c,e,0,d);return e}}function j(a,c,d){return b("bs_caml_string").bytes_to_string(i(a,c,d))}function k(a,c,d){d=(a.length+c|0)+d|0;var e=b("bs_caml_string").caml_create_string(d);c=c<0?[-c|0,0]:[0,c];var f=c[1];c=c[0];d=b("bs_caml_primitive").caml_int_min(a.length-c|0,d-f|0);d>0&&b("bs_caml_string").caml_blit_bytes(a,c,e,f,d);return e}function l(a,c,d,e){if(c<0||d<0||c>(a.length-d|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.fill / Bytes.fill"];else return b("bs_caml_string").caml_fill_string(a,c,d,e)}function m(a,c,d,e,f){if(f<0||c<0||c>(a.length-f|0)||e<0||e>(d.length-f|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"Bytes.blit"];else return b("bs_caml_string").caml_blit_bytes(a,c,d,e,f)}function n(a,c,d,e,f){if(f<0||c<0||c>(a.length-f|0)||e<0||e>(d.length-f|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.blit / Bytes.blit_string"];else return b("bs_caml_string").caml_blit_string(a,c,d,e,f)}function o(a,c){for(var d=0,e=c.length-1|0;d<=e;++d)b("bs_curry")._1(a,c[d]);return 0}function p(a,c){for(var d=0,e=c.length-1|0;d<=e;++d)b("bs_curry")._2(a,d,c[d]);return 0}function q(a,c){__p&&__p();if(c){var d=c[0],e=[0],f=[0];b("bs_list").iter(function(a){e[0]=e[0]+1|0;f[0]=f[0]+a.length|0;return 0},c);var h=b("bs_caml_string").caml_create_string(f[0]+b("bs_caml_int32").imul(a.length,e[0]-1|0)|0);b("bs_caml_string").caml_blit_bytes(d,0,h,0,d.length);var i=[d.length];b("bs_list").iter(function(c){b("bs_caml_string").caml_blit_bytes(a,0,h,i[0],a.length);i[0]=i[0]+a.length|0;b("bs_caml_string").caml_blit_bytes(c,0,h,i[0],c.length);i[0]=i[0]+c.length|0;return 0},c[1]);return h}else return g}function r(a,c){var d=a.length,e=c.length,f=b("bs_caml_string").caml_create_string(d+e|0);b("bs_caml_string").caml_blit_bytes(a,0,f,0,d);b("bs_caml_string").caml_blit_bytes(c,0,f,d,e);return f}function s(a){a=a-9|0;if(a>4||a<0)if(a!==23)return!1;else return!0;else if(a!==2)return!0;else return!1}function t(a){var b=a.length,c=0;while(c<b&&s(a[c]))c=c+1|0;b=b-1|0;while(b>=c&&s(a[b]))b=b-1|0;if(b>=c)return i(a,c,(b-c|0)+1|0);else return g}function u(a){__p&&__p();var c=0;for(var d=0,e=a.length-1|0;d<=e;++d){var f=a[d];if(f>=32){var g=f-34|0;g=g>58||g<0?g>=93?4:1:g>57||g<1?2:1}else g=f>=11?f!==13?4:2:f>=8?2:4;c=c+g|0}if(c===a.length)return h(a);else{f=b("bs_caml_string").caml_create_string(c);c=0;for(var g=0,d=a.length-1|0;g<=d;++g){e=a[g];var i=0;if(e>=35)e!==92?e>=127?i=1:f[c]=e:i=2;else if(e>=32)e>=34?i=2:f[c]=e;else if(e>=14)i=1;else switch(e){case 8:f[c]=92;c=c+1|0;f[c]=98;break;case 9:f[c]=92;c=c+1|0;f[c]=116;break;case 10:f[c]=92;c=c+1|0;f[c]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:i=1;break;case 13:f[c]=92;c=c+1|0;f[c]=114;break}switch(i){case 1:f[c]=92;c=c+1|0;f[c]=48+(e/100|0)|0;c=c+1|0;f[c]=48+(e/10|0)%10|0;c=c+1|0;f[c]=48+e%10|0;break;case 2:f[c]=92;c=c+1|0;f[c]=e;break}c=c+1|0}return f}}function v(a,c){var d=c.length;if(d===0)return c;else{var e=b("bs_caml_string").caml_create_string(d);for(var f=0,d=d-1|0;f<=d;++f)e[f]=b("bs_curry")._1(a,c[f]);return e}}function w(a,c){var d=c.length;if(d===0)return c;else{var e=b("bs_caml_string").caml_create_string(d);for(var f=0,d=d-1|0;f<=d;++f)e[f]=b("bs_curry")._2(a,f,c[f]);return e}}function x(a){return v(b("bs_char").uppercase,a)}function y(a){return v(b("bs_char").lowercase,a)}function z(a,c){if(c.length===0)return c;else{var d=h(c);d[0]=b("bs_curry")._1(a,c[0]);return d}}function A(a){return z(b("bs_char").uppercase,a)}function B(a){return z(b("bs_char").lowercase,a)}function C(a,c,d,e){__p&&__p();while(!0){var f=d;if(f>=c)throw b("bs_caml_builtin_exceptions").not_found;else if(a[f]===e)return f;else{d=f+1|0;continue}}}function D(a,b){return C(a,a.length,0,b)}function E(a,c,d){var e=a.length;if(c<0||c>e)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.index_from / Bytes.index_from"];else return C(a,e,c,d)}function F(a,c,d){__p&&__p();while(!0){var e=c;if(e<0)throw b("bs_caml_builtin_exceptions").not_found;else if(a[e]===d)return e;else{c=e-1|0;continue}}}function G(a,b){return F(a,a.length-1|0,b)}function H(a,c,d){if(c<-1||c>=a.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.rindex_from / Bytes.rindex_from"];else return F(a,c,d)}function I(a,c,d){var e=a.length;if(c<0||c>e)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.contains_from / Bytes.contains_from"];else try{C(a,e,c,d);return!0}catch(a){if(a===b("bs_caml_builtin_exceptions").not_found)return!1;else throw a}}function J(a,b){return I(a,0,b)}function K(a,c,d){if(c<0||c>=a.length)throw[b("bs_caml_builtin_exceptions").invalid_argument,"String.rcontains_from / Bytes.rcontains_from"];else try{F(a,c,d);return!0}catch(a){if(a===b("bs_caml_builtin_exceptions").not_found)return!1;else throw a}}var L=b("bs_caml_obj").caml_compare,M=b("bs_caml_string").bytes_to_string,N=b("bs_caml_string").bytes_of_string;f.make=a;f.init=c;f.empty=g;f.copy=h;f.of_string=e;f.to_string=d;f.sub=i;f.sub_string=j;f.extend=k;f.fill=l;f.blit=m;f.blit_string=n;f.concat=q;f.cat=r;f.iter=o;f.iteri=p;f.map=v;f.mapi=w;f.trim=t;f.escaped=u;f.index=D;f.rindex=G;f.index_from=E;f.rindex_from=H;f.contains=J;f.contains_from=I;f.rcontains_from=K;f.uppercase=x;f.lowercase=y;f.capitalize=A;f.uncapitalize=B;f.compare=L;f.unsafe_to_string=M;f.unsafe_of_string=N}),null);
__d("bs_string",["bs_list","bs_bytes","bs_caml_int32","bs_caml_string","bs_caml_primitive"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){return b("bs_caml_string").bytes_to_string(b("bs_bytes").make(a,c))}function c(a,c){return b("bs_caml_string").bytes_to_string(b("bs_bytes").init(a,c))}function d(a){return b("bs_caml_string").bytes_to_string(b("bs_bytes").copy(b("bs_caml_string").bytes_of_string(a)))}function e(a,c,d){return b("bs_caml_string").bytes_to_string(b("bs_bytes").sub(b("bs_caml_string").bytes_of_string(a),c,d))}function g(a,c){__p&&__p();if(c){var d=c[0],e=[0],f=[0];b("bs_list").iter(function(a){e[0]=e[0]+1|0;f[0]=f[0]+a.length|0;return 0},c);var g=b("bs_caml_string").caml_create_string(f[0]+b("bs_caml_int32").imul(a.length,e[0]-1|0)|0);b("bs_caml_string").caml_blit_string(d,0,g,0,d.length);var h=[d.length];b("bs_list").iter(function(c){b("bs_caml_string").caml_blit_string(a,0,g,h[0],a.length);h[0]=h[0]+a.length|0;b("bs_caml_string").caml_blit_string(c,0,g,h[0],c.length);h[0]=h[0]+c.length|0;return 0},c[1]);return b("bs_caml_string").bytes_to_string(g)}else return""}function h(a,c){return b("bs_bytes").iter(a,b("bs_caml_string").bytes_of_string(c))}function i(a,c){return b("bs_bytes").iteri(a,b("bs_caml_string").bytes_of_string(c))}function j(a,c){return b("bs_caml_string").bytes_to_string(b("bs_bytes").map(a,b("bs_caml_string").bytes_of_string(c)))}function k(a,c){return b("bs_caml_string").bytes_to_string(b("bs_bytes").mapi(a,b("bs_caml_string").bytes_of_string(c)))}function l(a){a=a-9|0;if(a>4||a<0)if(a!==23)return!1;else return!0;else if(a!==2)return!0;else return!1}function m(a){if(a===""||!(l(a.charCodeAt(0))||l(a.charCodeAt(a.length-1|0))))return a;else return b("bs_caml_string").bytes_to_string(b("bs_bytes").trim(b("bs_caml_string").bytes_of_string(a)))}function n(a){__p&&__p();var c=function(b){__p&&__p();while(!0){var c=b;if(c>=a.length)return!1;else{var d=a.charCodeAt(c);if(d>=32){d=d-34|0;if(d>58||d<0)if(d>=93)return!0;else{b=c+1|0;continue}else if(d>57||d<1)return!0;else{b=c+1|0;continue}}else return!0}}};if(c(0))return b("bs_caml_string").bytes_to_string(b("bs_bytes").escaped(b("bs_caml_string").bytes_of_string(a)));else return a}function o(a,c){return b("bs_bytes").index(b("bs_caml_string").bytes_of_string(a),c)}function p(a,c){return b("bs_bytes").rindex(b("bs_caml_string").bytes_of_string(a),c)}function q(a,c,d){return b("bs_bytes").index_from(b("bs_caml_string").bytes_of_string(a),c,d)}function r(a,c,d){return b("bs_bytes").rindex_from(b("bs_caml_string").bytes_of_string(a),c,d)}function s(a,c){return b("bs_bytes").contains(b("bs_caml_string").bytes_of_string(a),c)}function t(a,c,d){return b("bs_bytes").contains_from(b("bs_caml_string").bytes_of_string(a),c,d)}function u(a,c,d){return b("bs_bytes").rcontains_from(b("bs_caml_string").bytes_of_string(a),c,d)}function v(a){return b("bs_caml_string").bytes_to_string(b("bs_bytes").uppercase(b("bs_caml_string").bytes_of_string(a)))}function w(a){return b("bs_caml_string").bytes_to_string(b("bs_bytes").lowercase(b("bs_caml_string").bytes_of_string(a)))}function x(a){return b("bs_caml_string").bytes_to_string(b("bs_bytes").capitalize(b("bs_caml_string").bytes_of_string(a)))}function y(a){return b("bs_caml_string").bytes_to_string(b("bs_bytes").uncapitalize(b("bs_caml_string").bytes_of_string(a)))}var z=b("bs_caml_primitive").caml_string_compare,A=b("bs_bytes").fill,B=b("bs_bytes").blit_string;f.make=a;f.init=c;f.copy=d;f.sub=e;f.fill=A;f.blit=B;f.concat=g;f.iter=h;f.iteri=i;f.map=j;f.mapi=k;f.trim=m;f.escaped=n;f.index=o;f.rindex=p;f.index_from=q;f.rindex_from=r;f.contains=s;f.contains_from=t;f.rcontains_from=u;f.uppercase=v;f.lowercase=w;f.capitalize=x;f.uncapitalize=y;f.compare=z}),null);
__d("FBID.bs",["invariant","bs_js_exn","bs_string","gkx","bs_js_types"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){if(b("gkx")("AT5AGDWr7VWKZPg1PvTz69G07vIW7nWrxrA4PloGCgjyPuof8r7WUUsWLIKzWOZMmcJyN6U1BeEUXZmBqPUEAKAe")){b("bs_js_types").test(a,4)||g(0);a!=="0"||g(0);var c=/^[0-9]+$/;c.test(a)||g(0)}return a}function a(a){try{return[h(a)]}catch(c){a=b("bs_js_exn").internalToOCamlException(c);if(a[0]===b("bs_js_exn").$$Error)return 0;else throw a}}c=b("bs_string").compare;f.compare=c;f.ofString=a;f.ofStringExn=h}),null);
__d("ReasonReact.bs",["bs_curry","React","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d){a=[a,c].concat(d);return b("React").createElement.apply(null,a)}function g(){return 0}function h(){return!0}function i(a){return a[1]}function j(){return"RenderNotImplemented"}function k(){return 0}function l(a,b){return 0}function m(a,c,d){var e=a.reasonProps;if(e==null)if(c)return[b("bs_curry")._1(c[0],a)];else throw[b("bs_caml_builtin_exceptions").invalid_argument,"A JS component called the Reason component "+(d+" which didn't implement the JS->Reason React props conversion.")];else return e}function n(a){__p&&__p();return b("React").createClass({displayName:a,subscriptions:null,self:function(a,b){var c=this;return[c.handleMethod,a,b,c.sendMethod,c.onUnmountMethod]},transitionNextTotalState:function(a,b){if(typeof b==="number")return[0,a];else switch(b.tag|0){case 0:return[0,{reasonState:b[0]}];case 1:return[[b[0]],a];case 2:return[[b[1]],{reasonState:b[0]}]}},getInitialState:function(){var c=this;c=m(c.props,c.jsPropsToReason,a);return{reasonState:b("bs_curry")._1(c[0][10],0)}},componentDidMount:function(){var c=this,d=this,e=m(d.props,d.jsPropsToReason,a);e=e[0];if(e[4]!==g){d=d.state;d=d.reasonState;return b("bs_curry")._1(e[4],c.self(d,e[11]))}else return 0},componentDidUpdate:function(c,d){__p&&__p();var e=this,f=this,h=f.state;h=h.reasonState;var i=f.props,j=m(i,f.jsPropsToReason,a),k=j[0];if(k[5]!==g){i=c===i;i=i?j:m(c,f.jsPropsToReason,a);j=d.reasonState;c=e.self(h,k[11]);f=c[0];d=i[0][11];e=c[3];h=c[4];i=[f,j,d,e,h];return b("bs_curry")._1(k[5],[i,c])}else return 0},componentWillUnmount:function(){__p&&__p();var c=this,d=this,e=m(d.props,d.jsPropsToReason,a);e=e[0];d=d.state;d=d.reasonState;e[6]!==g&&b("bs_curry")._1(e[6],c.self(d,e[11]));d=c.subscriptions;if(d!==null){d.forEach(function(a){return b("bs_curry")._1(a,0)});return 0}else return 0},componentWillUpdate:function(c,d){__p&&__p();var e=this,f=this,h=m(c,f.jsPropsToReason,a),i=h[0];if(i[7]!==g){var j=f.props;c=c===j;c=c?h:m(j,f.jsPropsToReason,a);h=f.state;j=h.reasonState;f=d.reasonState;h=e.self(f,i[11]);d=h[0];e=c[0][11];f=h[3];c=h[4];d=[d,j,e,f,c];return b("bs_curry")._1(i[7],[d,h])}else return 0},componentWillReceiveProps:function(c){__p&&__p();var d=this,e=this,f=m(c,e.jsPropsToReason,a),g=f[0];if(g[3]!==i){var h=e.props;c=c===h;c=c?f:m(h,e.jsPropsToReason,a);var j=c[0];return e.setState(function(a,c){c=a.reasonState;c=d.self(c,j[11]);c=b("bs_curry")._1(g[3],c);if(c!==a)return{reasonState:c};else return a},null)}else return 0},shouldComponentUpdate:function(c,d,e){__p&&__p();e=this;var f=this,g=f.props,i=m(f.props,f.jsPropsToReason,a);g=c===g;g=g?i:m(c,f.jsPropsToReason,a);c=g[0];g=d.reasonState;d=e.self(g,c[11]);if(c[8]!==h){e=f.state;g=e.reasonState;f=d[0];e=i[0][11];i=d[3];var j=d[4];f=[f,g,e,i,j];return b("bs_curry")._1(c[8],[f,d])}else return!0},onUnmountMethod:function(a){var b=this,c=b.subscriptions;if(c!==null){c.push(a);return 0}else{b.subscriptions=[a];return 0}},handleMethod:function(c){var d=this,e=this;return function(f){var g=e.state;g=g.reasonState;var h=m(e.props,e.jsPropsToReason,a);return b("bs_curry")._2(c,f,d.self(g,h[0][11]))}},sendMethod:function(c){__p&&__p();var d=this,e=this,f=m(e.props,e.jsPropsToReason,a);f=f[0];if(f[12]!==l){var g=[function(){return 0}],h=b("bs_curry")._1(f[12],c);return e.setState(function(a,c){__p&&__p();c=a.reasonState;c=b("bs_curry")._1(h,c);if(c===0)return null;else{c=d.transitionNextTotalState(a,c);var e=c[1];c=c[0];c&&(g[0]=c[0]);if(e!==a)return e;else return null}},d.handleMethod(function(a,c){return b("bs_curry")._1(g[0],c)}))}else return 0},reduceMethod:function(a,c){var d=this;return d.sendMethod(b("bs_curry")._1(a,c))},render:function(){var c=this,d=this,e=m(d.props,d.jsPropsToReason,a);e=e[0];d=d.state;d=d.reasonState;return b("bs_curry")._1(e[9],c.self(d,e[11]))}})}function c(a){return[a,n(a),[0],i,g,g,g,g,h,j,k,0,l,0]}var o=c,p=c,q=c,r=c;function d(a,c,d){a=a?a[0]:undefined;c=c?c[0]:undefined;var e=[d],f=d[13];if(f)return b("bs_curry")._2(f[0],a,c);else return b("React").createElement(d[1],{key:a,ref:c,reasonProps:e})}function e(a,b){var c=a[1].prototype;c.jsPropsToReason=[b];return a[1]}function s(a,c){var d=function(a){return b("bs_curry")._2(c,a,a.children)};d=[d];var e=a[1].prototype;e.jsPropsToReason=d;return a[1]}var t=c("interop");function u(a,c,d){var e=[function(e,f){var g=a,h=c,i=d;e=e;f=f;h=Object.assign(Object.assign({},h),{ref:f,key:e});f=[g,h].concat(i);return b("React").createElement.apply(null,f)}];return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],e]}function v(a){if(typeof Event==="function")return new Event(a);else{var b=document.createEvent("Event");b.initEvent(a,!0,!0);return b}}function w(){__p&&__p();var a=typeof window==="undefined"?undefined:window;if(a!==undefined){a=a.location.pathname;switch(a){case"":case"/":return 0;default:a=a.slice(1);var b=a[a.length-1|0];b=b==="/"?a.slice(0,-1):a;a=b.split("/");b=a.length-1|0;var c=0;while(!0){var d=c,e=b;if(e<0)return d;else{c=[a[e],d];b=e-1|0;continue}}}}else return 0}function x(){var a=typeof window==="undefined"?undefined:window;if(a!==undefined){a=a.location.hash;switch(a){case"":case"#":return"";default:return a.slice(1)}}else return""}function y(){var a=typeof window==="undefined"?undefined:window;if(a!==undefined){a=a.location.search;switch(a){case"":case"?":return"";default:return a.slice(1)}}else return""}function z(a){var b=typeof history==="undefined"?undefined:history,c=typeof window==="undefined"?undefined:window;if(b!==undefined&&c!==undefined){b.pushState(null,"",a);c.dispatchEvent(v("popstate"));return 0}else return 0}function A(){return[w(0),x(0),y(0)]}function B(a){var c=typeof window==="undefined"?undefined:window;if(c!==undefined){var d=function(){return b("bs_curry")._1(a,A(0))};c.addEventListener("popstate",d);return d}else return function(){return 0}}function C(a){var b=typeof window==="undefined"?undefined:window;if(b!==undefined){b.removeEventListener("popstate",a);return 0}else return 0}function D(){return 0}function E(){return[D]}function F(a,b){if(b[0]===D){b[0]=a;return[b]}else return 0}function G(a){a[0]=D;return 0}function H(a,c){return b("bs_curry")._1(a[0],c)}c=[z,B,C,A];z=[E,F,G,H];f.statelessComponent=o;f.statelessComponentWithRetainedProps=p;f.reducerComponent=q;f.reducerComponentWithRetainedProps=r;f.element=d;f.wrapReasonForJs=e;f.wrapReasonForJsWithChildren=s;f.createDomElement=a;f.wrapJsForReason=u;f.Router=c;f.RemoteAction=z}),null);
__d("Utils.bs",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){if(a==null)return!1;else return a}function b(a,b){if(a)return a[0];else return b}function c(a){return(a==null?0:[a])!==0}function d(a){if(a)return a[0];else return!1}function e(a){if(a)return a[0];else return!1}f.isTruthy=a;f.$pipe$unknown=b;f.isDefined=c;f.isSomeTrue=d;f.optionBoolToBoolean=e}),null);
__d("bs_array",["bs_curry","bs_js_exn","bs_caml_array","bs_caml_exceptions","bs_caml_builtin_exceptions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){if(a===0)return[];else if(a<0)throw[b("bs_caml_builtin_exceptions").invalid_argument,"Array.init"];else{var d=b("bs_caml_array").caml_make_vect(a,b("bs_curry")._1(c,0));for(var e=1,a=a-1|0;e<=a;++e)d[e]=b("bs_curry")._1(c,e);return d}}function c(a,c,d){var e=b("bs_caml_array").caml_make_vect(a,[]);for(var f=0,a=a-1|0;f<=a;++f)e[f]=b("bs_caml_array").caml_make_vect(c,d);return e}function g(a){var c=a.length;if(c===0)return[];else return b("bs_caml_array").caml_array_sub(a,0,c)}function d(a,c){var d=a.length;if(d===0)return g(c);else if(c.length===0)return b("bs_caml_array").caml_array_sub(a,0,d);else return a.concat(c)}function e(a,c,d){if(d<0||c>(a.length-d|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"Array.sub"];else return b("bs_caml_array").caml_array_sub(a,c,d)}function h(a,c,d,e){if(c<0||d<0||c>(a.length-d|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"Array.fill"];else{for(var f=c,c=(c+d|0)-1|0;f<=c;++f)a[f]=e;return 0}}function i(a,c,d,e,f){if(f<0||c<0||c>(a.length-f|0)||e<0||e>(d.length-f|0))throw[b("bs_caml_builtin_exceptions").invalid_argument,"Array.blit"];else return b("bs_caml_array").caml_array_blit(a,c,d,e,f)}function j(a,c){for(var d=0,e=c.length-1|0;d<=e;++d)b("bs_curry")._1(a,c[d]);return 0}function k(a,c){var d=c.length;if(d===0)return[];else{var e=b("bs_caml_array").caml_make_vect(d,b("bs_curry")._1(a,c[0]));for(var f=1,d=d-1|0;f<=d;++f)e[f]=b("bs_curry")._1(a,c[f]);return e}}function l(a,c){for(var d=0,e=c.length-1|0;d<=e;++d)b("bs_curry")._2(a,d,c[d]);return 0}function m(a,c){var d=c.length;if(d===0)return[];else{var e=b("bs_caml_array").caml_make_vect(d,b("bs_curry")._2(a,0,c[0]));for(var f=1,d=d-1|0;f<=d;++f)e[f]=b("bs_curry")._2(a,f,c[f]);return e}}function n(a){__p&&__p();var b=a.length-1|0,c=0;while(!0){var d=c,e=b;if(e<0)return d;else{c=[a[e],d];b=e-1|0;continue}}}function o(a,b){while(!0){var c=b,d=a;if(c){b=c[1];a=d+1|0;continue}else return d}}function p(a){__p&&__p();if(a){var c=b("bs_caml_array").caml_make_vect(o(0,a),a[0]),d=1;a=a[1];while(!0){var e=a,f=d;if(e){c[f]=e[0];a=e[1];d=f+1|0;continue}else return c}}else return[]}function q(a,c,d){c=c;for(var e=0,f=d.length-1|0;e<=f;++e)c=b("bs_curry")._2(a,c,d[e]);return c}function r(a,c,d){d=d;for(var e=c.length-1|0;e>=0;--e)d=b("bs_curry")._2(a,c[e],d);return d}var s=b("bs_caml_exceptions").create("Array.Bottom");function t(a,c){__p&&__p();var d=function(d,e){__p&&__p();var f=((e+e|0)+e|0)+1|0,g=f;if((f+2|0)<d){b("bs_curry")._2(a,b("bs_caml_array").caml_array_get(c,f),b("bs_caml_array").caml_array_get(c,f+1|0))<0&&(g=f+1|0);b("bs_curry")._2(a,b("bs_caml_array").caml_array_get(c,g),b("bs_caml_array").caml_array_get(c,f+2|0))<0&&(g=f+2|0);return g}else if((f+1|0)<d&&b("bs_curry")._2(a,b("bs_caml_array").caml_array_get(c,f),b("bs_caml_array").caml_array_get(c,f+1|0))<0)return f+1|0;else if(f<d)return f;else throw[s,e]},e=function(e,f,g){__p&&__p();try{e=e;f=f;var h=g;while(!0){var i=f,j=d(e,i);if(b("bs_curry")._2(a,b("bs_caml_array").caml_array_get(c,j),h)>0){b("bs_caml_array").caml_array_set(c,i,b("bs_caml_array").caml_array_get(c,j));f=j;continue}else return b("bs_caml_array").caml_array_set(c,i,h)}}catch(a){j=b("bs_js_exn").internalToOCamlException(a);if(j[0]===s)return b("bs_caml_array").caml_array_set(c,j[1],g);else throw j}},f=function(a,e){__p&&__p();try{a=a;e=e;while(!0){var f=e,g=d(a,f);b("bs_caml_array").caml_array_set(c,f,b("bs_caml_array").caml_array_get(c,g));e=g;continue}}catch(a){f=b("bs_js_exn").internalToOCamlException(a);if(f[0]===s)return f[1];else throw f}},g=function(e,f){__p&&__p();while(!0){var d=e,g=(d-1|0)/3|0;if(d===g)throw[b("bs_caml_builtin_exceptions").assert_failure,["array.ml",173,4]];if(b("bs_curry")._2(a,b("bs_caml_array").caml_array_get(c,g),f)<0){b("bs_caml_array").caml_array_set(c,d,b("bs_caml_array").caml_array_get(c,g));if(g>0){e=g;continue}else return b("bs_caml_array").caml_array_set(c,0,f)}else return b("bs_caml_array").caml_array_set(c,d,f)}},h=c.length;for(var i=((h+1|0)/3|0)-1|0;i>=0;--i)e(h,i,b("bs_caml_array").caml_array_get(c,i));for(var i=h-1|0;i>=2;--i){e=b("bs_caml_array").caml_array_get(c,i);b("bs_caml_array").caml_array_set(c,i,b("bs_caml_array").caml_array_get(c,0));g(f(i,0),e)}if(h>1){e=b("bs_caml_array").caml_array_get(c,1);b("bs_caml_array").caml_array_set(c,1,b("bs_caml_array").caml_array_get(c,0));return b("bs_caml_array").caml_array_set(c,0,e)}else return 0}function u(a,c){__p&&__p();var d=function(d,e,f,g,h,j,k){__p&&__p();e=d+e|0;h=g+h|0;var l=d;d=b("bs_caml_array").caml_array_get(c,d);var m=g;g=b("bs_caml_array").caml_array_get(f,g);k=k;while(!0){var n=k,o=g,p=m,q=d,r=l;if(b("bs_curry")._2(a,q,o)<=0){b("bs_caml_array").caml_array_set(j,n,q);q=r+1|0;if(q<e){k=n+1|0;d=b("bs_caml_array").caml_array_get(c,q);l=q;continue}else return i(f,p,j,n+1|0,h-p|0)}else{b("bs_caml_array").caml_array_set(j,n,o);q=p+1|0;if(q<h){k=n+1|0;g=b("bs_caml_array").caml_array_get(f,q);m=q;continue}else return i(c,r,j,n+1|0,e-r|0)}}},e=function(d,e,f,g){for(var h=0,g=g-1|0;h<=g;++h){var i=b("bs_caml_array").caml_array_get(c,d+h|0),j=(f+h|0)-1|0;while(j>=f&&b("bs_curry")._2(a,b("bs_caml_array").caml_array_get(e,j),i)>0)b("bs_caml_array").caml_array_set(e,j+1|0,b("bs_caml_array").caml_array_get(e,j)),j=j-1|0;b("bs_caml_array").caml_array_set(e,j+1|0,i)}return 0},f=function a(f,g,h,i){if(i<=5)return e(f,g,h,i);else{var b=i/2|0;i=i-b|0;a(f+b|0,g,h+b|0,i);a(f,c,f+i|0,b);return d(f+i|0,b,g,h+b|0,i,g,h)}},g=c.length;if(g<=5)return e(0,c,0,g);else{var h=g/2|0;g=g-h|0;var j=b("bs_caml_array").caml_make_vect(g,b("bs_caml_array").caml_array_get(c,0));f(h,j,0,g);f(0,c,g,h);return d(g,h,j,0,g,c,0)}}var v=c,w=b("bs_caml_array").caml_array_concat,x=u;f.init=a;f.make_matrix=c;f.create_matrix=v;f.append=d;f.concat=w;f.sub=e;f.copy=g;f.fill=h;f.blit=i;f.to_list=n;f.of_list=p;f.iter=j;f.map=k;f.iteri=l;f.mapi=m;f.fold_left=q;f.fold_right=r;f.sort=t;f.stable_sort=u;f.fast_sort=x}),null);
__d("bs_js_dict",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=function(a,b){delete a[b];return 0};function a(a){var b=Object.keys(a),c=b.length,d=new Array(c);for(var e=0,c=c-1|0;e<=c;++e){var f=b[e];d[e]=[f,a[f]]}return d}function b(a){var b=Object.keys(a),c=b.length,d=new Array(c);for(var e=0,c=c-1|0;e<=c;++e)d[e]=a[b[e]];return d}function c(a){__p&&__p();var b={};a=a;while(!0){var c=a;if(c){var d=c[0];b[d[0]]=d[1];a=c[1];continue}else return b}}function d(a){var b={},c=a.length;for(var d=0,c=c-1|0;d<=c;++d){var e=a[d];b[e[0]]=e[1]}return b}function e(a,b){var c={},d=Object.keys(b),e=d.length;for(var f=0,e=e-1|0;f<=e;++f){var g=d[f];c[g]=a(b[g])}return c}f.unsafeDeleteKey=g;f.entries=a;f.values=b;f.fromList=c;f.fromArray=d;f.map=e}),null);
__d("bs_js_primitive",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){if(a===null)return!0;else return a===undefined}function b(a){if(a===null||a===undefined)return 0;else return[a]}function c(a){if(a===undefined)return 0;else return[a]}function d(a){if(a===null)return 0;else return[a]}function e(a){if(a)return a[0];else return undefined}function g(a){if(a)return a[0][1];else return undefined}f.is_nil_undef=a;f.null_undefined_to_opt=b;f.undefined_to_opt=c;f.null_to_opt=d;f.option_get=e;f.option_get_unwrap=g}),null);
__d("MessengerState.bs",["FBID.bs","bs_list","bs_array","bs_block","bs_curry","Utils.bs","Arbiter","bs_js_dict","bs_caml_obj","FBIDCheck","immutable","MercuryIDs","CurrentUser","ReasonReact.bs","bs_js_primitive","MessagingTag","TypingStates","MercuryViewer","ChannelConstants","MercuryActionType","MercuryThreadIDMap","MercuryPayloadSource","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return a[0]}function c(a){return a[1]}function d(a){return a[2]}function e(a){return a[3]}function g(a){return a[4]}function h(a){return a[5]}function i(a){return a[6]}function j(a){var b=new Set();a.forEach(function(a){b.add(a);return 0});return b}function k(a){return a.reduce(function(a,c){if(a)return!0;else if(c.action_type==="mga-type:mark-all-seen")return c.folder===b("MessagingTag").PENDING;else return!1},!1)}function l(a,c){if(b("bs_caml_obj").caml_equal(a.action_type,b("MercuryActionType").USER_GENERATED_MESSAGE)&&a.folder===b("MessagingTag").PENDING)return b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE);else return!1}var m=function(a,b){delete a[b];return 0};function n(a,c,d){a=a[c];if(a!==undefined){c=a[d];if(c!==undefined)return b("bs_curry")._2(m,a,d);else return 0}else return 0}function o(a,c){__p&&__p();var d=c.thread_fbid;if(d==null)if(c.type==="typ"||c.type==="page_typing"){c=b("FBID.bs").ofString(c.from.toString());if(c)return b("MercuryIDs").getThreadIDFromUserID(c[0]);else return null}else return null;else{c=b("MercuryThreadIDMap").getForFBID(a);return c.getClientIDFromServerIDNow(d.toString())}}function p(a,c){__p&&__p();return b("bs_array").fold_left(function(a,c){__p&&__p();if(c.tag){var d=c[0];if(d){b("bs_curry")._1(d[0],{blocked_ids:a[4]});return a}else{d=a;var e=b("bs_js_dict").fromArray(b("bs_js_dict").entries(d[6])),f=[];b("bs_js_dict").entries(e).forEach(function(a){var c=a[0];b("bs_js_dict").entries(a[1]).forEach(function(a){if(a[1]<Date.now()-3e4){f.push([c,a[0]]);return 0}else return 0});return 0});if(f.length===0)return d;else{f.forEach(function(a){return n(e,a[0],a[1])});return[d[0],d[1],d[2],d[3],d[4],d[5],e]}}}else{d=c[0];if(typeof d==="number")switch(d){case 0:c=a;return[c[0],c[1],c[2],c[3],c[4],0,c[6]];case 1:c=a;return[c[0],c[1],c[2],c[3],c[4],c[5]+1|0,c[6]];case 2:c=a;return[c[0],c[1],{},c[3],c[4],c[5],c[6]]}else switch(d.tag|0){case 0:c=a;var g=d[0],h=b("bs_js_dict").fromArray(b("bs_js_dict").entries(c[1]));Object.keys(g).forEach(function(a){var c=g[a],d=b("Utils.bs").$pipe$unknown(b("bs_js_primitive").undefined_to_opt(h[a]),0);if(c>d){h[a]=c;return 0}else return 0});return[c[0],h,c[2],c[3],c[4],c[5],c[6]];case 1:c=a;var i=d[0],k=j(c[3]);b("bs_array").iter(function(a){k.add(a);return 0},i);return[c[0],c[1],c[2],k,c[4],c[5],c[6]];case 2:i=a;c=d[0];var l=d[1],m=j(i[4]);b("bs_array").iter(function(a){m.add(a);return 0},c);b("bs_array").iter(function(a){m["delete"](a);return 0},l);return[i[0],i[1],i[2],i[3],m,i[5],i[6]];case 3:c=a;l=d[0];var p=j(c[4]);b("bs_array").iter(function(a){if(p.has(a)){p["delete"](a);return 0}else{p.add(a);return 0}},l);return[c[0],c[1],c[2],c[3],p,c[5],c[6]];case 4:i=a;l=d[0];var q=j(i[3]);l.forEach(function(c){__p&&__p();var a=c.is_messenger_ignored;c=c.fbid;if(a==null)return 0;else if(a)if(c==null)return 0;else{q.add(b("MercuryIDs").getParticipantIDFromUserID(c));return 0}else if(c==null)return 0;else{q["delete"](b("MercuryIDs").getParticipantIDFromUserID(c));return 0}});return[i[0],i[1],i[2],q,i[4],i[5],i[6]];case 5:c=a;l=d[0];return[c[0],c[1],c[2],c[3],c[4],l,c[6]];case 6:i=a;l=d[0];var r=b("bs_js_dict").fromArray(b("bs_js_dict").entries(i[6]));l.forEach(function(a){var c=a.author;if(b("bs_caml_obj").caml_equal(a.action_type,b("MercuryActionType").USER_GENERATED_MESSAGE)&&b("bs_caml_obj").caml_notequal(c,b("MercuryViewer").getID())){a=a.thread_id;return n(r,a,c)}else return 0});return[i[0],i[1],i[2],i[3],i[4],i[5],r];case 7:c=a;l=d[0];i=o(c[0],l);if(i==null)return c;else{var s=b("FBID.bs").ofString(l.from.toString());if(s){var t=l.persona_id;s=t==null?b("MercuryIDs").getParticipantIDFromUserID(s[0]):b("MercuryIDs").getParticipantIDFromUserID(t);if(l.st===b("TypingStates").TYPING){t=c[6][i];if(t!==undefined){t[s]=Date.now();return[c[0],c[1],c[2],c[3],c[4],c[5],c[6]]}else{t=b("bs_js_dict").fromArray(b("bs_js_dict").entries(c[6]));var u={};u[s]=Date.now();t[i]=u;return[c[0],c[1],c[2],c[3],c[4],c[5],t]}}else if(l.st===b("TypingStates").INACTIVE){u=b("bs_js_dict").fromArray(b("bs_js_dict").entries(c[6]));n(u,i,s);return[c[0],c[1],c[2],c[3],c[4],c[5],u]}else return c}else return c}case 8:t=a;var v=d[0],w=b("bs_js_dict").fromArray(b("bs_js_dict").entries(t[2]));Object.keys(v).forEach(function(c){__p&&__p();Object.keys(v[c]).forEach(function(d){__p&&__p();var a=w[c];a=a!==undefined?a:b("immutable").OrderedMap();var e=a.get(d),f=v[c][d];if(e==null||f.watermark>e.watermark)e=1;else return 0;if(e===1){w[c]=a.set(d,f);return 0}});var a=w[c];if(a!==undefined){w[c]=a.sort(function(a,b){return a.watermark-b.watermark|0});return 0}else return 0});return[t[0],t[1],w,t[3],t[4],t[5],t[6]];case 9:return a}}},c,a)}function q(a){var c=[b("ChannelConstants").getArbiterType("typ"),b("ChannelConstants").getArbiterType("ttyp")];b("FBIDCheck").isUser_deprecated(a)||c.push(b("ChannelConstants").getArbiterType("page_typing"));return c}var r={},s=b("ReasonReact.bs").reducerComponent("MessengerStateProvider"),t=function(a,b){delete a[b];return 0};function u(a,c){b("ReasonReact.bs").RemoteAction[3](a,[b("bs_block").__(0,[b("bs_block").__(7,[c])])]);b("setTimeoutAcrossTransitions")(function(){return b("ReasonReact.bs").RemoteAction[3](a,[b("bs_block").__(1,[0])])},3e4);return 0}function v(a,c,d){__p&&__p();var e=c?c[0]:b("ReasonReact.bs").RemoteAction[0](0),f=[0],g=[[a,{},{},new Set(),new Set(),0,{}]],h=b("ReasonReact.bs").RemoteAction[1](function(a){var c=g[0];g[0]=p(a,c);if(g[0]!==c)return b("bs_list").iter(function(a){return b("bs_curry")._1(a,g[0])},f[0]);else return 0},e);b("Arbiter").subscribe(q(a),function(b,c){b=c.obj;c=b.to;if(!(c==null)&&c.toString()!==a)return 0;else{u(e,b);return 0}});d=function(c){__p&&__p();return[s[0],s[1],s[2],s[3],function(c){f[0]=[c[3],f[0]];return b("bs_curry")._1(c[4],function(){f[0]=b("bs_list").filter(function(a){return a!==c[3]})(f[0]);if(f[0]===0){h&&b("ReasonReact.bs").RemoteAction[2](h[0]);return b("bs_curry")._2(t,r,a)}else return 0})},s[5],s[6],s[7],s[8],function(a){return b("bs_curry")._1(c,a[1])},function(){return g[0]},s[11],function(c,a){return b("bs_block").__(0,[c])},s[13]]};c=[e,d];r[a]=c;return c}function w(a,c){c=c?c[0]:b("CurrentUser").getID();var d=r[c];if(d!==undefined)return d[1];else return v(c,a,0)[1]}function x(a,c){a=a?a[0]:b("CurrentUser").getID();var d=r[a];if(d!==undefined)return b("ReasonReact.bs").RemoteAction[3](d[0],c);else{d=v(a,0,0);return b("ReasonReact.bs").RemoteAction[3](d[0],c)}}function y(a,c){var d=r[a];if(d!==undefined)return b("ReasonReact.bs").RemoteAction[3](d[0],[b("bs_block").__(1,[[c]])]);else{d=v(a,0,0);return b("ReasonReact.bs").RemoteAction[3](d[0],[b("bs_block").__(1,[[c]])])}}function z(a,b){return x(a==null?0:[a],b)}function A(a){__p&&__p();var c=[];if(!(a==null)){var d=a.payload_source;d==null||b("bs_caml_obj").caml_equal(d,b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE)&&c.push(b("bs_block").__(0,[2]));d=a.delivery_receipts;d==null||c.push(b("bs_block").__(0,[b("bs_block").__(0,[d])]));d=a.message_ignored_ids;d==null||c.push(b("bs_block").__(0,[b("bs_block").__(1,[d])]));d=a.actions;d==null||c.push(b("bs_block").__(0,[b("bs_block").__(3,[d.reduce(function(a,b){b=b.message_blocked_ids;if(b==null)return a;else return b.concat(a)},[])])]));d=a.participants;if(!(d==null)){c.push(b("bs_block").__(0,[b("bs_block").__(4,[d])]));var e=[],f=[];d.forEach(function(c){__p&&__p();var a=c.is_messenger_blocked;c=c.fbid;if(a==null)return 0;else if(a)if(c==null)return 0;else{e.push(b("MercuryIDs").getParticipantIDFromUserID(c));return 0}else if(c==null)return 0;else{f.push(b("MercuryIDs").getParticipantIDFromUserID(c));return 0}});(e.length>0||f.length>0)&&c.push(b("bs_block").__(0,[b("bs_block").__(2,[e,f])]))}d=a.message_blocked_ids;d==null||d.length>0&&c.push(b("bs_block").__(0,[b("bs_block").__(2,[d,[]])]));d=a.pending_folder_unseen_count;d==null||c.push(b("bs_block").__(0,[b("bs_block").__(5,[d])]));d=a.actions;var g=a.payload_source;d==null||(g==null||d.forEach(function(a){if(l(a,g)){c.push(b("bs_block").__(0,[1]));return 0}else return 0}));d=a.global_actions;if(!(d==null)){d=k(d);d&&c.push(b("bs_block").__(0,[0]))}d=a.actions;var h=a.payload_source;d==null||!(h==null)&&b("bs_caml_obj").caml_equal(h,b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE)&&d.length>0&&c.push(b("bs_block").__(0,[b("bs_block").__(6,[b("bs_array").map(function(a){return{action_type:a.action_type,author:a.author,thread_id:a.thread_id}},d)])]));h=a.roger;h==null||c.push(b("bs_block").__(0,[b("bs_block").__(8,[h])]))}return c}var B=b("ReasonReact.bs").wrapReasonForJs(s,function(a){return b("bs_curry")._1(w(0,b("bs_js_primitive").null_undefined_to_opt(a.fbid)),a.children)}),C=[w];f.fbid=a;f.deliveryReceipts=c;f.readReceiptsPerThread=d;f.ignoredIds=e;f.blockedIds=g;f.pendingFolderUnseenCount=h;f.typing=i;f.send=x;f.compute=y;f.sendJS=z;f.processJSActions=A;f.Provider=C;f.jsComponent=B}),null);
__d("bs_js_null_undefined",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){if(a==null)return a;else return b(a)}function b(a,b){if(a==null)return 0;else return b(a)}function c(a){if(a)return a[0];else return undefined}d=c;f.bind=a;f.iter=b;f.fromOption=c;f.from_opt=d}),null);
__d("MercuryVanityIDMap.bs",["bs_string","bs_js_primitive","MercuryAssert","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={},h={};function a(a){return b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(g[b("bs_string").lowercase(a)]))}function c(a){return b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(h[a]))}function d(a){a=h[a];if(a!==undefined)return!0;else return!1}function e(a){a=g[b("bs_string").lowercase(a)];if(a!==undefined)return!0;else return!1}function i(a,c){b("MercuryAssert").isParticipantID(c);a=b("bs_string").lowercase(a);g[a]=c;h[c]=a;return 0}f.vanityToID=g;f.idToVanity=h;f.getID=a;f.getVanity=c;f.hasID=d;f.hasVanity=e;f.set=i}),null);
__d("MessengerStateProcessor",["MercuryAPIArgsSource","MercuryIDs","MercuryParticipantTypes","MercuryParticipants","MercuryThreadIDMap","MercuryThreads","MercuryVanityIDMap.bs","MessengerURIConstants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={preprocess:function(a){__p&&__p();var c=a.activeThreadID;if(c){var d=b("MercuryIDs").getUserIDFromThreadID(c),e=d&&b("MercuryParticipants").getNow(b("MercuryIDs").getParticipantIDFromUserID(d));if(e&&e.type!==b("MercuryParticipantTypes").EVENT)a.threadKey=e.vanity||d;else if(d&&!e){e=b("MercuryIDs").getParticipantIDFromUserID(d);a.threadKey=b("MercuryVanityIDMap.bs").hasID(e)?b("MercuryVanityIDMap.bs").getVanity(e):d}else{e=b("MercuryThreadIDMap").get();d=e.getServerIDFromClientIDNow(c);a.threadKey=d||b("MercuryIDs").tokenize(c).value}}delete a.activeThreadID;return a},postprocess:function(a){__p&&__p();var c=b("MercuryThreadIDMap").get(),d=b("MercuryThreads").get(),e=g(a.threadKey),f=void 0;f=b("MercuryIDs").isValid(e)?e:c.getClientIDFromServerIDNow(e);if(!f){e=b("MercuryParticipants").getIDFromVanityOrFBID(e);d=e&&d.getCanonicalThreadToParticipant(e,null,b("MercuryAPIArgsSource").MESSENGER);d&&(f=d.thread_id)}f&&(a.activeThreadID=f,a.serverThreadID=c.getServerIDFromClientIDNow(f));delete a.threadKey;return a},supportInboxPostprocess:function(a){a.threadKey&&(a.activeThreadID=b("MercuryIDs").getThreadIDFromSupportInboxItemID(a.threadKey));delete a.threadKey;return a}};function g(a){return!a?null:a.startsWith(b("MessengerURIConstants").GROUP_PREFIX)?a.substr(b("MessengerURIConstants").GROUP_PREFIX.length):a}e.exports=a}),null);
__d("MercuryFilters",["MessagingTag"],(function(a,b,c,d,e,f){var g=[b("MessagingTag").UNREAD];a={ALL:"all",UNREAD:b("MessagingTag").UNREAD,getSupportedFilters:function(){return g.concat()},isSupportedFilter:function(a){return g.includes(a)}};e.exports=a}),null);
__d("MessengerURISerializer",["CurrentEnvironment","MercuryFilters","MessagingTag","MessengerStateProcessor","MessengerURIConstants","MessengerView","URI","WWWBase","MercuryIDs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="/?$",h=function(a,c){a.setPath(b("CurrentEnvironment").facebookdotcom?b("MessengerURIConstants").FACEBOOK_PREFIX+c:c)},i=function(a,c){var d=a.getPath();b("CurrentEnvironment").facebookdotcom&&!d.startsWith(b("MessengerURIConstants").FACEBOOK_PREFIX)&&(c=b("MessengerURIConstants").FACEBOOK_PREFIX+c);a.setPath(a.getPath()+c)};a={serialize:function(a){__p&&__p();var c=new(b("URI"))(b("WWWBase").uri);a=b("MessengerStateProcessor").preprocess(a);switch(a.masterView){case b("MessengerView").MASTER.PAYMENT:h(c,b("MessengerURIConstants").PAYMENT_PATH);break;case b("MessengerView").MASTER.PEOPLE:h(c,b("MessengerURIConstants").PEOPLE_PATH);break;case b("MessengerView").MASTER.SUPPORT:h(c,b("MessengerURIConstants").SUPPORT_PATH);break}switch(a.folder){case b("MessagingTag").OTHER:h(c,b("MessengerURIConstants").FILTERED_REQUESTS_PATH);break;case b("MessagingTag").ACTION_ARCHIVED:h(c,b("MessengerURIConstants").ARCHIVED_PATH);break;case b("MessagingTag").PENDING:h(c,b("MessengerURIConstants").MESSAGE_REQUESTS_PATH);break}a.detailView===b("MessengerView").DETAIL.PAYTHREAD?(i(c,b("MessengerURIConstants").PAYMENT_PAY_PATH),a.threadKey&&c.addQueryData("id",a.threadKey)):a.detailView===b("MessengerView").DETAIL.PAYFRIENDPICKER?i(c,b("MessengerURIConstants").PAYMENT_PAY_PATH):a.detailView===b("MessengerView").DETAIL.COMPOSE?i(c,b("MessengerURIConstants").COMPOSE_SUBPATH):a.threadKey?a.masterView===b("MessengerView").MASTER.PAYMENT?(h(c,b("MessengerURIConstants").THREAD_PREFIX+a.threadKey),delete a.extraQueryParams.id,delete a.extraQueryParams.a,delete a.extraQueryParams.m):i(c,b("MessengerURIConstants").THREAD_PREFIX+a.threadKey):a.masterView===b("MessengerView").MASTER.PAYMENT?(h(c,""),delete a.extraQueryParams.id,delete a.extraQueryParams.a,delete a.extraQueryParams.m):i(c,"");a.extraQueryParams&&c.addQueryData(a.extraQueryParams);b("MercuryFilters").isSupportedFilter(a.filter)&&c.addQueryData({filter:a.filter});if(a.query!=null){var d;c.addQueryData((d={},d[a.masterView===b("MessengerView").MASTER.SEARCH?"qa":"q"]=a.query,d))}a.threadIDs&&c.addQueryData({threadIDs:JSON.stringify(a.threadIDs)});a.mid&&c.addQueryData({mid:a.mid});return c},deserialize:function(a){__p&&__p();var c={},d=a.getPath();b("CurrentEnvironment").facebookdotcom&&!d.startsWith(b("MessengerURIConstants").FACEBOOK_PREFIX)&&(c.notMessenger=!0);d=d.replace(b("MessengerURIConstants").FACEBOOK_PREFIX,"");var e=void 0;a=a.getQueryData();var f=a.filter,h=a.mid,i=a.q,k=a.qa,l=a.threadIDs;a=babelHelpers.objectWithoutProperties(a,["filter","mid","q","qa","threadIDs"]);if(l)try{e=JSON.parse(l)}catch(a){}e?c.threadIDs=e.filter(function(a){return b("MercuryIDs").isValidThreadID(a)}):c.threadIDs=null;d.match("^"+b("MessengerURIConstants").PEOPLE_PATH)?c.masterView=b("MessengerView").MASTER.PEOPLE:d.match("^"+b("MessengerURIConstants").SUPPORT_PATH)?c.masterView=b("MessengerView").MASTER.SUPPORT:d.match("^"+b("MessengerURIConstants").PAYMENT_PATH)?c.masterView=b("MessengerView").MASTER.PAYMENT:k?c.masterView=b("MessengerView").MASTER.SEARCH:c.masterView=b("MessengerView").MASTER.RECENT;d.match("^"+b("MessengerURIConstants").FILTERED_REQUESTS_PATH)?c.folder=b("MessagingTag").OTHER:d.match("^"+b("MessengerURIConstants").ARCHIVED_PATH)?c.folder=b("MessagingTag").ACTION_ARCHIVED:d.match("^"+b("MessengerURIConstants").MESSAGE_REQUESTS_PATH)?c.folder=b("MessagingTag").PENDING:c.folder=b("MessagingTag").INBOX;if(d.match(b("MessengerURIConstants").COMPOSE_SUBPATH+g))c.detailView=b("MessengerView").DETAIL.COMPOSE;else if(d.match("^"+b("MessengerURIConstants").PAYMENT_PATH+b("MessengerURIConstants").PAYMENT_PAY_PATH))a&&a.id?(c.threadKey=a.id,c.detailView=b("MessengerView").DETAIL.PAYTHREAD):c.detailView=b("MessengerView").DETAIL.PAYFRIENDPICKER;else{l=j(d);l&&(c.threadKey=l,c.detailView=b("MessengerView").DETAIL.THREAD)}b("MercuryFilters").isSupportedFilter(f)?c.filter=f:c.filter=b("MercuryFilters").ALL;c.mid=h;c.query=k||i;c.extraQueryParams=a;return c.masterView===b("MessengerView").MASTER.SUPPORT?b("MessengerStateProcessor").supportInboxPostprocess(c):b("MessengerStateProcessor").postprocess(c)}};function j(a){a=a.match(b("MessengerURIConstants").THREAD_PREFIX+"([^/]+)"+g);return a&&decodeURIComponent(a[1])}e.exports=a}),null);
__d("MercurySingletonProvider",["CurrentUser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1={},this.$2=a}a.prototype.getForFBID=function(a){this.$1[a]||(this.$1[a]=new this.$2(a));return this.$1[a]};a.prototype.get=function(){return this.getForFBID(b("CurrentUser").getID())};a.mock=function(a){throw new Error("MercurySingletonProvider.mock() must only be used in tests.")};e.exports=a}),null);
__d("MercuryDelayedDispatcher",["MercuryDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=[],this.$3=b("MercuryThreadIDMap").getForFBID(this.$1),this.$4=b("MercuryDispatcher").getForFBID(this.$1),this.$5=b("MercuryServerRequests").getForFBID(this.$1),this.$6=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1),this.$4.subscribe("model-update-completed",function(a,b){return this.$7()}.bind(this))}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.handleUpdateWaitForThread=function(a,b){var c=this.$3.getClientIDFromServerIDNow(b);if(c){this.$8(a);return}this.$3.getClientIDFromServerID(b,function(){return this.$2.push({thread_fbid:b,payload:a})}.bind(this));this.$5.ensureThreadIsFetched(b)};a.prototype.$7=function(){if(this.$2&&this.$2.length){var a=this.$2.shift(),b=a.thread_fbid;a=a.payload;this.handleUpdateWaitForThread(a,b)}};a.prototype.$8=function(a){a.from_client?this.$4.handleUpdate(a):this.$6.handleUpdate(a)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryThreadInformer",["ArbiterMixin","LogHistory","MercuryAssert","MercurySingletonProvider","mapObject","mixin"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("LogHistory").getInstance("mercury_informer");c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;a.get=function(){return i.get()};a.getForFBID=function(a){return i.getForFBID(a)};function a(a){g.constructor.call(this),this.$MercuryThreadInformer1=a,this.$MercuryThreadInformer2={},this.$MercuryThreadInformer3={},this.$MercuryThreadInformer4={},this.$MercuryThreadInformer5={},this.$MercuryThreadInformer6=!1,this.$MercuryThreadInformer7=!1,this.$MercuryThreadInformer8=!1,this.$MercuryThreadInformer9={},this.$MercuryThreadInformer10={},this.$MercuryThreadInformer11={},this.$MercuryThreadInformer12=0}a.prototype.updatedThread=function(a){this.$MercuryThreadInformer3[a]=!0,this.$MercuryThreadInformer13()};a.prototype.invalidatedThread=function(a){this.$MercuryThreadInformer4[a]=!0,this.$MercuryThreadInformer13()};a.prototype.deletedThread=function(a){this.$MercuryThreadInformer2[a]=!0,this.$MercuryThreadInformer13()};a.prototype.updatedThreadlist=function(){this.$MercuryThreadInformer6=!0,this.$MercuryThreadInformer13()};a.prototype.updatedUnseenState=function(){this.$MercuryThreadInformer7=!0,this.$MercuryThreadInformer13()};a.prototype.updatedUnreadState=function(){this.$MercuryThreadInformer8=!0,this.$MercuryThreadInformer13()};a.prototype.changedThreadReadState=function(a,b,c){(!this.$MercuryThreadInformer5[a]||this.$MercuryThreadInformer5[a].timestamp<c)&&(this.$MercuryThreadInformer5[a]={mark_as_read:b,timestamp:c}),this.$MercuryThreadInformer13()};a.prototype.receivedMessage=function(a){b("MercuryAssert").isThreadID(a.thread_id);var c=a.thread_id;this.$MercuryThreadInformer9[c]||(this.$MercuryThreadInformer9[c]=[]);this.$MercuryThreadInformer9[c].push(a);this.updatedThread(c)};a.prototype.reorderedMessages=function(a,b){this.$MercuryThreadInformer10[a]={source:b},this.$MercuryThreadInformer13()};a.prototype.updatedMessage=function(a,b,c){this.$MercuryThreadInformer11[a]||(this.$MercuryThreadInformer11[a]={}),this.$MercuryThreadInformer11[a][b]={source:c},this.updatedThread(a)};a.prototype.synchronizeInforms=function(a){this.$MercuryThreadInformer12++;try{a()}catch(a){throw a}finally{this.$MercuryThreadInformer12--,this.$MercuryThreadInformer13()}};a.prototype.listen=function(a,b){return this.subscribe("threads-updated",function(c,d){d[a]&&b(a)})};a.prototype.$MercuryThreadInformer13=function(){__p&&__p();if(!this.$MercuryThreadInformer12){var a=this.$MercuryThreadInformer2,b=this.$MercuryThreadInformer3,c=this.$MercuryThreadInformer4,d=this.$MercuryThreadInformer5,e=this.$MercuryThreadInformer6,f=this.$MercuryThreadInformer7,g=this.$MercuryThreadInformer8,h=this.$MercuryThreadInformer9,i=this.$MercuryThreadInformer10,j=this.$MercuryThreadInformer11;this.$MercuryThreadInformer2={};this.$MercuryThreadInformer3={};this.$MercuryThreadInformer4={};this.$MercuryThreadInformer5={};this.$MercuryThreadInformer6=!1;this.$MercuryThreadInformer7=!1;this.$MercuryThreadInformer8=!1;this.$MercuryThreadInformer9={};this.$MercuryThreadInformer10={};this.$MercuryThreadInformer11={};var k=Object.keys(b);(k.length||e)&&this.inform("threadlist-updated",k);k.length&&this.$MercuryThreadInformer14("threads-updated",b);for(var e in c){this.$MercuryThreadInformer14("thread-invalidated",c);break}for(var e in d){this.$MercuryThreadInformer14("thread-read-changed",d);break}for(e in a){this.$MercuryThreadInformer14("threads-deleted",a);break}f&&this.$MercuryThreadInformer14("unseen-updated",null);g&&this.$MercuryThreadInformer14("unread-updated",null);for(e in h){this.$MercuryThreadInformer14("messages-received",h);break}for(e in i){this.$MercuryThreadInformer14("messages-reordered",i);break}for(e in j){this.$MercuryThreadInformer14("messages-updated",j);break}}};a.prototype.$MercuryThreadInformer14=function(a,b){a==="threads-updated"&&h.debug(a,JSON.stringify(b)),this.inform(a,b)};var i=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryDispatcher",["invariant","ArbiterMixin","MessengerState.bs","LogHistory","MercuryActionType","MercuryPayloadSource","MercurySingletonProvider","MercuryThreadInformer","isEmpty","mixin"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("LogHistory").getInstance("mercury_dispatcher");c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));h=c&&c.prototype;a.getForFBID=function(a){return j.getForFBID(a)};a.get=function(){return j.get()};function a(a){h.constructor.call(this),this.$MercuryDispatcher1=a}a.prototype.handleUpdate=function(a){__p&&__p();this.$MercuryDispatcher2(a),!!a.from_client!==!!a.preprocessed||g(0),delete a.preprocessed,b("isEmpty")(a)||b("MercuryThreadInformer").getForFBID(this.$MercuryDispatcher1).synchronizeInforms(function(){__p&&__p();a.payload_source===b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE&&this.inform("invalidate-global-state",{});if(a.payload_source===b("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE){var c=a.threads&&a.threads.length>0&&a.threads[0]&&a.threads[0].thread_id;c&&this.inform("invalidate-thread-state",c)}this.inform("update-thread-ids",a.newlyAddedClientIDs);this.inform("update-participants",a);this.inform("update-threads",a);this.inform("update-unread",a);this.inform("update-threadlist",a);this.inform("update-messages",a);this.inform("update-unseen",a);this.inform("update-typing-state",a);this.inform("update-delivery",a);this.inform("update-roger",a.roger);this.inform("update-blocked-users",a);this.inform("update-ignored-users",a);this.inform("model-update-completed",null);this.inform("update-work-group-threads",a);b("MessengerState.bs").sendJS(this.$MercuryDispatcher1,b("MessengerState.bs").processJSActions(a))}.bind(this))};a.prototype.$MercuryDispatcher2=function(a){__p&&__p();var c=a.payload_source;if(c===b("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS||c===b("MercuryPayloadSource").CLIENT_MARK_THREAD_SEEN)return;var d={from_client:a.from_client,messages:null};if(a.actions){a=a.actions.filter(function(a){return a.action_type===b("MercuryActionType").USER_GENERATED_MESSAGE||a.action_type===b("MercuryActionType").LOG_MESSAGE}).map(function(a){return{action_type:a.action_type,other_user_fbid:a.other_user_fbid,thread_fbid:a.thread_fbid,message_id:a.message_id}});a.length&&(d.messages=a)}i.debug("update:"+c,JSON.stringify(d))};var j=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryActionStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNSENT:0,SUCCESS:1,UNCONFIRMED:3,FAILED_UNKNOWN_REASON:4,UNABLE_TO_CONFIRM:5,RESENT:6,RESENDING:7,ERROR:10})}),null);
__d("MercuryLocalIDs",["PresenceUtil","randomInt"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={generateMessageID:function(a){a=a||Date.now();var c=b("randomInt")(0,4294967295),d=b("PresenceUtil").getSessionID();return"<"+a+":"+c+"-"+d+"@mail.projektitan.com>"},generateThreadID:function(a){return"root:"+g.generateOfflineThreadingID(a)},generateOfflineThreadingID:function(a){a=a||Date.now();var c=b("randomInt")(0,4294967295);c=("0000000000000000000000"+c.toString(2)).slice(-22);a=a.toString(2)+c;return h(a.slice(-63))}};function h(a){var b="";while(a!="0"){var c=0,d="";for(var e=0;e<a.length;e++)c=2*c+parseInt(a[e],10),c>=10?(d+="1",c-=10):d+="0";b=c.toString()+b;a=d.slice(d.indexOf("1"))}return b}e.exports=g}),null);
__d("MercuryMessageSourceTags",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHAT:"source:chat",EMAIL:"source:email",MESSENGER:"source:messenger",MOBILE:"source:mobile"})}),null);
__d("MercurySendMessageFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({AUTO_RETRY_CNT:"auto_retry_cnt",MANUAL_RETRY_CNT:"manual_retry_cnt"})}),null);
__d("MercuryMessageObject",["BanzaiODS","MercuryActionStatus","MercuryActionType","MercuryIDs","MercuryLocalIDs","MercuryMessageClientState","MercuryMessageSourceTags","MercurySingletonProvider","MercurySourceType","MercuryThreads","MercurySendMessageFields"],(function(a,b,c,d,e,f){__p&&__p();a.getForFBID=function(a){"use strict";return i.getForFBID(a)};a.get=function(){"use strict";return i.get()};function a(a){"use strict";this.$1=a,this.$2=b("MercuryThreads").getForFBID(a)}a.prototype.constructUserGeneratedMessageObject=function(a,c,d,e,f){__p&&__p();var h=arguments.length<=5||arguments[5]===undefined?null:arguments[5],i=g(this.$1,b("MercuryActionType").USER_GENERATED_MESSAGE,c,d);typeof a=="string"&&(a=a.replace(/^\s+/,"").replace(/\s+$/,""));i.body=a;i.has_attachment=!1;i.html_body=!1;i.attachments=[];i.specific_to_list=e||[];i.creator_info=f;h&&h.length>0&&(i.tags=h);return i};a.prototype.constructStickerMessageObject=function(a,c,d){var e=arguments.length<=3||arguments[3]===undefined?null:arguments[3],f=g(this.$1,b("MercuryActionType").USER_GENERATED_MESSAGE,c,d);f.has_attachment=!0;f.html_body=!1;f.attachments=[];f.sticker_id=a;f.specific_to_list=[];e&&e.length>0&&(f.tags=e);return f};a.prototype.constructAttachmentMessageObject=function(a,c){"use strict";a=g(this.$1,b("MercuryActionType").USER_GENERATED_MESSAGE,a,c);a.attachments=[];a.specific_to_list=[];return a};a.prototype.constructLogMessageObject=function(a,c,d,e){"use strict";a=g(this.$1,b("MercuryActionType").LOG_MESSAGE,a,c);a.log_message_type=d;a.log_message_data=e;e&&e.untypedData&&e.untypedData.ttl&&(a.ephemeral_ttl_mode=e.untypedData.ttl);return a};a.prototype.constructCTAConfirmationMessageObject=function(a,b,c,d){var e=arguments.length<=4||arguments[4]===undefined?null:arguments[4],f=this.constructUserGeneratedMessageObject(a,b,c,null,null),g;({});d?g={quick_replies:d,ignore_for_webhook:!1}:g={ignore_for_webhook:!0};f.platform_xmd=JSON.stringify(g);e&&e.length>0&&(f.tags=e);return f};a.prototype.normalizeNewMessage=function(a){"use strict";__p&&__p();a.status===undefined&&(a.status=b("MercuryActionStatus").UNSENT);a.offline_threading_id=a.offline_threading_id||b("MercuryLocalIDs").generateOfflineThreadingID(a.timestamp);a.offline_threading_id||b("BanzaiODS").bumpEntityKey("chat.web","invalid_otid_generated");a.message_id=a.message_id||a.offline_threading_id;var c=b("MercuryIDs").getParticipantIDFromUserID(this.$1);a.specific_to_list=a.specific_to_list||[];a.specific_to_list.length&&a.specific_to_list.indexOf(c)===-1&&a.specific_to_list.push(c);if(!a.thread_id)a.thread_id="root:"+a.offline_threading_id;else{var d=this.$2.getThreadMetaNow(a.thread_id);d&&d.ephemeral_ttl_mode!==null&&a.ephemeral_ttl_mode===undefined&&(a.ephemeral_ttl_mode=d.ephemeral_ttl_mode)}if(a.specific_to_list.length==1)a.thread_id="user:"+this.$1;else if(a.specific_to_list.length==2){d=a.specific_to_list[0]==c?a.specific_to_list[1]:a.specific_to_list[0];a.thread_id=b("MercuryIDs").getThreadIDFromParticipantID(d)}if(!a.specific_to_list.length){d=b("MercuryIDs").tokenize(a.thread_id);var e=d.type;d=d.value;e=="user"&&(a.specific_to_list=["fbid:"+d,c])}a[b("MercurySendMessageFields").MANUAL_RETRY_CNT]||(a[b("MercurySendMessageFields").MANUAL_RETRY_CNT]=0)};a.prototype.normalizeResendMessage=function(a){"use strict";a.status=b("MercuryActionStatus").RESENDING,a.timestamp=Date.now(),a[b("MercurySendMessageFields").MANUAL_RETRY_CNT]+=1};a.prototype.normalizeAddAttachmentPlaceholder=function(a,c,d){"use strict";d.preview_attachments.length>0&&(a.has_attachment=!0,a.preview_attachments=d.preview_attachments),a.client_state=b("MercuryMessageClientState").DO_NOT_SEND_TO_SERVER,a.status=b("MercuryActionStatus").RESENDING,a.upload_id=c};function g(a,c,d,e){var f=h(d)?[b("MercuryMessageSourceTags").CHAT]:[],g=Date.now();c={action_type:c,thread_id:e,author:b("MercuryIDs").getParticipantIDFromUserID(a),author_email:null,timestamp:g,is_unread:!1,is_filtered_content:!1,is_filtered_content_bh:!1,is_filtered_content_account:!1,is_filtered_content_quasar:!1,is_filtered_content_invalid_app:!1,is_spoof_warning:!1,source:d,source_tags:f};return c}function h(a){switch(a){case b("MercurySourceType").CHAT_WEB:case b("MercurySourceType").CHAT_JABBER:case b("MercurySourceType").CHAT_IPHONE:case b("MercurySourceType").CHAT_MEEBO:case b("MercurySourceType").CHAT_ORCA:case b("MercurySourceType").CHAT_TEST:case b("MercurySourceType").CHAT:return!0;default:return!1}}var i=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryTagHelper",[],(function(a,b,c,d,e,f){"use strict";a={get:function(a,b){a=a.find(function(a){return a.startsWith(b)});return a&&a.substr(a.indexOf(":")+1)}};e.exports=a}),null);
__d("EmojiLikeUtils",["EmojiLikeConstants","EmoticonEmojiList","MercuryTagHelper"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){!a.tags?a.tags=[g(b)]:a.tags.push(g(b));return a}function g(a){var c=b("EmojiLikeConstants").TAG_PREFIX_NEW;return c+":"+a}function c(a,b){!a.tags?a.tags=[h(b)]:a.tags.push(h(b));return a}function h(a){return b("EmojiLikeConstants").SOURCE_TAG_PREFIX+":"+a}function d(a){return i(a)!=null}function i(a){if(!a.tags)return null;var c=b("MercuryTagHelper").get(a.tags,b("EmojiLikeConstants").TAG_PREFIX_NEW);return c?c:b("MercuryTagHelper").get(a.tags,b("EmojiLikeConstants").TAG_PREFIX_OLD)}e.exports={getEmojiSize:i,isEmojiLike:d,setEmojiSize:a,setEmojiSource:c}}),null);
__d("MercuryAttachmentContentType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PHOTO:"attach:image",VIDEO:"attach:video",MUSIC:"attach:music",VOICE:"attach:voice",TEXT:"attach:text",MSWORD:"attach:ms:word",MSXLS:"attach:ms:xls",MSPPT:"attach:ms:ppt",ORION:"attach:orion",SHOERACK_INVITATION:"attach:shoerackinvite",UNKNOWN:"attach:unknown"})}),null);
__d("MercuryAttachmentType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ERROR:"error",FILE:"file",PHOTO:"photo",STICKER:"sticker",SHARE:"share",UNKNOWN:"unknown",VIDEO:"video",ANIMATED_IMAGE:"animated_image",EMOJI_LIKE:"emoji_like",GIFT:"gift",THIRDPARTYSTICKER:"third_party_sticker"})}),null);
__d("StoryAttachmentStyle",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FALLBACK:"fallback",SHARE:"share",OG_COMPOSER_SIMPLE:"og_composer_simple",SPORTS_MATCHUP:"sports_matchup",SHARE_LARGE_IMAGE:"share_large_image",PHOTO:"photo",COVER_PHOTO:"cover_photo",INSPIRATION_PHOTO:"inspiration_photo",ALBUM:"album",NEW_ALBUM:"new_album",COUPON:"coupon",QUESTION:"question",ANSWER:"answer",OPTION:"option",GALLERY:"gallery",STREAM_PUBLISH:"stream_publish",MUSIC_AGGREGATION:"music_aggregation",ITEM_LIST:"list",HIGH_SCORE:"high_score",SCORE_LEADERBOARD:"score_leaderboard",FRIEND_LIST:"friend_list",POPULAR_OBJECTS:"popular_objects",AVATAR_LIST:"avatar_list",AVATAR:"avatar",AVATAR_WITH_VIDEO:"avatar_with_video",EVENT:"event",CANCELED_EVENT:"canceled_event",MINUTIAE_EVENT:"minutiae_event",EXPERIENCE:"experience",LIFE_EVENT:"life_event",GIFT:"gift",IMAGE_SHARE:"image_share",ANIMATED_IMAGE_SHARE:"animated_image_share",ANIMATED_IMAGE_AUTOPLAY:"animated_image_autoplay",ANIMATED_IMAGE_VIDEO:"animated_image_video",ANIMATED_IMAGE_VIDEO_AUTOPLAY:"animated_image_video_autoplay",NOTE:"note",TOPIC:"topic",TOPIC_FOLLOWING_TOPIC:"topic_following_topic",FILE_UPLOAD:"file_upload",NOTIFICATION_TARGET:"notification_target",UNAVAILABLE:"unavailable",PAGE_RECOMMENDATION:"page_recommendation",PAGE_VIDEO_PLAYLIST:"page_video_playlist",VIDEO:"video",VIDEO_INLINE:"video_inline",VIDEO_AUTOPLAY:"video_autoplay",VIDEO_SHARE:"video_share",VIDEO_SHARE_HIGHLIGHTED:"video_share_highlighted",VIDEO_SHARE_YOUTUBE:"video_share_youtube",VIDEO_DIRECT_RESPONSE:"video_direct_response",VIDEO_DIRECT_RESPONSE_AUTOPLAY:"video_direct_response_autoplay",VIDEO_SHOP:"video_shop",INSPIRATION_VIDEO:"inspiration_video",MULTI_VIDEOS_STITCHED:"multi_videos_stitched",MAP:"map",OG_MAP:"og_map",PRODUCT:"product",EXTERNAL_PRODUCT:"external_product",FITNESS_COURSE:"fitness_course",APPLICATION:"application",STICKER:"sticker",EXTERNAL_OG_PRODUCT:"external_og_product",TRAVEL_LOG:"travel_log",MULTI_SHARE:"multi_share",MULTI_SHARE_NO_END_CARD:"multi_share_no_end_card",MULTI_SHARE_NON_LINK_VIDEO:"multi_share_non_link_video",MULTI_SHARE_SEARCH_END_CARD:"multi_share_search_end_card",MULTI_SHARE_FIXED_TEXT:"multi_share_fixed_text",YEAR_IN_REVIEW:"year_in_review",AVATAR_LARGE_COVER:"avatar_large_cover",COMMERCE_PRODUCT_ITEM:"commerce_product_item",COMMERCE_STORE:"commerce_store",THIRD_PARTY_PHOTO:"third_party_photo",PROMPT:"prompt",BIRTHDAY:"birthday",BIRTHDAY_PERCEPTICONS:"birthday_percepticons",DISCUSSION_CONVERSATION:"discussion_conversation",DISCUSSION_COMMENT:"discussion_comment",GROUP_SELL_PRODUCT_ITEM:"group_sell_product_item",GROUP_SELL_PRODUCT_ITEM_MARK_AS_SOLD:"group_sell_mark_as_sold",GAMETIME:"gametime",GAMETIME_LEAGUE:"gametime_league",GAMETIME_PLAY:"gametime_play",GROUP_REPORTED_POST_QUEUE:"group_reported_post_queue",GROUP_PENDING_POST_QUEUE:"group_pending_post_queue",GROUP_JOIN_REQUEST_QUEUE:"group_join_request_queue",GREETING_CARD:"greeting_card",LEAD_GEN:"lead_gen",ATTACHED_STORY:"attached_story",POST_CHANNEL:"post_channel",TEXT_FOR_COLLAGE:"text_for_collage",SOUVENIR:"souvenir",SLIDESHOW:"slideshow",ORION:"orion",ORION_REQUEST:"orion_request",P2P_PAYMENT:"p2p_payment",P2P_SERVER_BUBBLE:"p2p_server_bubble",INSTANT_ARTICLE:"instant_article",MOMENTS_APP_INVITATION:"moments_app_invitation",MOMENTS_APP_PHOTO_REQUEST:"moments_app_photo_request",RIDE_ORDERED:"ride_ordered",RIDE_RECEIPT:"ride_receipt",BUSINESS_MESSAGE_ITEMS:"business_message_items",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_PROMOTION:"retail_promotion",RETAIL_ITEM:"retail_item",RETAIL_NOW_IN_STOCK:"retail_now_in_stock",RETAIL_RECEIPT:"retail_receipt",RETAIL_SHIPMENT:"retail_shipment",RETAIL_SHIPMENT_FOR_SUPPORTED_CARRIER:"retail_shipment_for_supported_carrier",RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:"retail_shipment_for_unsupported_carrier",RETAIL_SHIPMENT_TRACKING_EVENT:"retail_shipment_tracking_event",RETAIL_SHIPMENT_TRACKING_EVENT_ETA:"retail_shipment_tracking_event_eta",RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:"retail_shipment_tracking_event_in_transit",RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:"retail_shipment_tracking_event_out_for_delivery",RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:"retail_shipment_tracking_event_delayed",RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:"retail_shipment_tracking_event_delivered",SURVEY:"survey",MESSAGE_LOCATION:"message_location",GROUP_ADD_MEMBERS:"group_add_memebers",GROUP_MEMBER_ADDED:"group_member_added",RTC_CALL_LOG:"rtc_call_log",EVENTS_PENDING_POST_QUEUE:"events_pending_post_queue",EVENT_CALENDAR:"event_calendar",FACEPILE:"facepile",ATTRIBUTED_SHARE:"attributed_share",VIDEO_CINEMAGRAPH:"video_cinemagraph",LOCAL_CONTEXT_SHARE:"local_context_share",H_SCROLL:"h_scroll",EGO_HSCROLL:"ego_hscroll",MEDIA_QUESTION:"media_question",RICH_MEDIA:"rich_media",RICH_MEDIA_COLLECTION:"rich_media_collection",SQUARE_IMAGE_SHARE:"square_image_share",RETAIL_AGENT_ITEM_SUGGESTION:"retail_agent_item_suggestion",RETAIL_AGENT_ITEM_RECEIPT:"retail_agent_item_receipt",NOTE_COMPOSED:"note_composed",AVATAR_WITH_BIRTHDAY:"avatar_with_birthday",AIRLINE_FLIGHT_RESCHEDULE_UPDATE_BUBBLE:"airline_flight_reschedule_update_bubble",AIRLINE_CONFIRMATION:"airline_confirmation",AIRLINE_CHECK_IN:"airline_check_in",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_FLIGHT_RESCHEDULE_UPDATE:"airline_flight_reschedule_update",LIGHTBOX_VIDEO:"lightbox_video",GLOBALLY_DELETED_MESSAGE_PLACEHOLDER:"globally_deleted_message_placeholder",GENIE_MESSAGE:"genie_message",MOVIE_BOT_MOVIE_LIST:"movie_bot_movie_list",MOVIE_BOT_MOVIE_SHOWTIME_LIST:"movie_bot_movie_showtime_list",GROUPSMASH_MEDIA:"groupsmash_media",AVATAR_WITH_EGO_ACTION:"avatar_with_ego_action",EVENT_TICKET_DEPRECATED:"event_ticket",VERTICAL_ATTACHMENT_LIST:"vertical_attachment_list",INSTANT_ARTICLE_LEGACY:"instant_article_legacy",FUNDRAISER_PAGE:"fundraiser_page",FINANCIAL_BILL_PAYMENT_REQUEST:"financial_bill_payment_request",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD:"goodwill_throwback_friendversary_polaroids_card",WELCOME_CARD_IMAGE:"welcome_card_image",LARGE_IMAGE_LIKE:"large_image_like",ASK_FRIENDS:"ask_friends",CULTURAL_MOMENT:"cultural_moment",TELEPHONE_CALL_LOG:"telephone_call_log",SUPER_EMOJI:"super_emoji",BOOK:"book",SUBTOPIC_CUSTOMIZATION_QUESTION:"subtopic_customization_question",SUBTOPIC_CUSTOMIZATION_OPTION:"subtopic_customization_option",RESTAURANT:"restaurant",CONNECTION_QUESTION:"connection_question",CONNECTION_QUESTION_OPTION:"connection_question_option",PYMI_ITEM:"pymi_item",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD:"goodwill_throwback_friendversary_collage_card",CITY:"city",AVATAR_WITH_SHARE:"avatar_with_share",LIGHTWEIGHT_PLACE:"lightweight_place",QUOTED_SHARE:"quoted_share",SMS_LOG:"sms_log",CENTERED_TEXT:"centered_text",GOODWILL_THROWBACK_FRIENDVERSARY_DATA_CARD:"goodwill_throwback_friendversary_data_card",GOODWILL_THROWBACK_FACEVERSARY_COLLAGE_CARD:"goodwill_throwback_faceversary_collage_card",GOODWILL_THROWBACK_ANNIVERSARY_COLLAGE_CARD:"goodwill_throwback_anniversary_collage_card",MESSAGE_EVENT:"message_event",MESSAGE_THREAD:"message_thread",QUOTE:"quote",VOTER_REGISTRATION_SHARE:"voter_registration_share",AIRLINE_ITINERARY:"airline_itinerary",AIRLINE_UPDATE:"airline_update",PLACE_LIST:"place_list",IMPLICIT_PLACE_LIST_CONVERSION:"implicit_place_list_conversion",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",MINUTIAE_UNIT:"minutiae_unit",INSTANT_ARTICLE_PHOTO:"instant_article_photo",INSTANT_ARTICLE_VIDEO:"instant_article_video",PHOTO_LINK_SHARE:"photo_link_share",PHOTO_LINK_SHARE_WITH_INSTAGRAM_CONTEXT:"photo_link_share_with_instagram_context",BUSINESS_LOCATION:"business_location",GOODWILL_WEATHER:"goodwill_weather",CULTURAL_MOMENT_HOLIDAY_CARD:"cultural_moment_holiday_card",TRANSACTION_INVOICE:"transaction_invoice",GROUP:"group",COMMENT_PLACE_INFO:"comment_place_info",COMMENT_PRODUCT_INFO:"comment_product_info",GOODWILL_THROWBACK_FRIENDVERSARY_POLAROIDS_CARD_IPB:"goodwill_throwback_friendversary_polaroids_card_ipb",GOODWILL_THROWBACK_FRIENDVERSARY_COLLAGE_CARD_IPB:"goodwill_throwback_friendversary_collage_card_ipb",FUNDRAISER_PERSON_TO_CHARITY:"fundraiser_person_to_charity",FUNDRAISER_PERSON_FOR_PERSON:"fundraiser_person_for_person",FUNDRAISER_FOR_STORY:"fundraiser_for_story",MESSAGE_LIVE_LOCATION:"message_live_location",MESSENGER_INVITE:"messenger_invite",MESSENGER_NATIVE_TEMPLATES:"messenger_native_templates",GAMES_INSTANT_PLAY:"games_instant_play",PROFILE_MEDIA:"profile_media",NATIVE_TEMPLATES:"native_templates",NATIVE_TEMPLATES_FOX:"native_templates_fox",NATIVE_TEMPLATES_KEEP_ATTACHED:"native_templates_keep_attached",GOODWILL_THROWBACK_VIDEO_BASIC:"goodwill_throwback_video_basic",COMMERCE_PRODUCT_MINI:"commerce_product_mini",COMMERCE_PRODUCT_MINI_LIST:"commerce_product_mini_list",COMMENT:"comment",MESSENGER_TEAM_BOT_SHARE:"messenger_team_bot_share",LIVE_VIDEO_SCHEDULE:"live_video_schedule",PRODUCT_ITEM:"product_item",PLATFORM_INSTANT_APP:"platform_instant_app",YEAR_OVERVIEW:"year_overview",NATIVE_COMPONENT_FLOW_BOOKING_REQUEST:"native_component_flow_booking_request",FRIEND_REQUEST:"friend_request",MESSENGER_GROUP_JOINABLE_LINK:"messenger_group_joinable_link",SOCIAL_SEARCH_CONVERSION_PROMPT:"social_search_conversion_prompt",MDOTME_USER_LINK:"mdotme_user_link",DYNAMIC_MULTI_SHARE_ITEMS:"dynamic_multi_share_items",EVENT_REMINDER:"event_reminder",INSTANT_GAMES_SHARE_MESSAGE:"instant_games_share_message",MESSENGER_PLATFORM_COMPACT_ITEM:"messenger_platform_compact_item",MESSENGER_PLATFORM_COVER_ITEM:"messenger_platform_cover_item",MULTI_SHARE_NON_LINK_VIDEO_AUTO_SCROLL:"multi_share_non_link_video_auto_scroll",ENDORSEMENT:"endorsement",OFFER_VIEW_LIVE_COUNTDOWN:"offer_view_live_countdown",ENHANCED_LINK_REDDIT_POST:"enhanced_link_reddit_post",MESSENGER_COMMERCE_COVER_ITEM:"messenger_commerce_cover_item",ENHANCED_LINK_YELP_BUSINESS:"enhanced_link_yelp_business",PAGES_PLATFORM_LEAD_GEN:"pages_platform_lead_gen",NATIVE_STORY:"native_story",MFS_BILL_PAY_CREATION_UPDATE:"mfs_bill_pay_creation_update",MFS_BILL_PAY_REFERENCE_CODE_UPDATE:"mfs_bill_pay_reference_code_update",MFS_BILL_PAY_AGENT_CASH_IN_UPDATE:"mfs_bill_pay_agent_cash_in_update",ISSUE_POSITION:"issue_position",PAGES_PLATFORM_BOOKING_MESSAGE:"pages_platform_booking_message",EXTERNAL_GALLERY:"external_gallery",MEME_SHARE:"meme_share",MESSENGER_PLATFORM_ELEMENT:"messenger_platform_element",INSTANT_GAMES_SHARE_SCORE_MESSAGE:"instant_games_share_score_message",MESSENGER_PLATFORM_BUTTON_LIST:"messenger_platform_button_list",BALLOT:"ballot",LIGHTWEIGHT_ACTION:"lightweight_action",TAROT_DIGEST:"tarot_digest",EVENT_TOUR:"event_tour",ADAPTIVE_MEDIA:"adaptive_media",DYNAMIC_GAME_BOARD:"dynamic_game_board",PAYMENT_PLATFORM:"payment_platform",OMNI_M_FLOW:"omni_m_flow",GROUP_QUIZ:"group_quiz",TRIAL_AD:"trial_ad",TEEM_COLLECTIONS:"teem_collections",CRISIS_DONATION:"crisis_donation",CRISIS_STATUS:"crisis_status",CRISIS_SHARE:"crisis_share",CRISIS_MARK_SAFE:"crisis_mark_safe",CRISIS_LISTING:"crisis_listing",VR_CONTENT:"vr_content",VIDEO_RECOMMENDATION_HSCROLL:"video_recommendation_hscroll",VIDEO_TRAILER:"video_trailer",SHOW_PAGE_SHARE:"show_page_share",MFS_ATTACHMENT:"mfs_attachment",GROUP_TASK:"group_task",CHECKLIST:"checklist",VIDEO_RECOMMENDATION_SINGLETON:"video_recommendation_singleton",PAGE_REVIEW_PROMPT:"page_review_prompt",VIDEO_SHOW:"video_show",UNCONNECTED_VIDEO:"unconnected_video",SHOW_SHARE:"show_share",JOB_SEARCH_JOB_APPLICATION:"job_search_job_application",PAGE_MESSENGER_ATTACHMENT:"page_messenger_attachment",CONTACT_YOUR_REP:"contact_your_rep",LIVE_ELECTION_RESULTS:"live_election_results",LOCATION_EXTENSION:"location_extension",PLACE_RECOMMENDATION:"place_recommendation",JOB_SEARCH_JOB_OPENING:"job_search_job_opening",PAGE_MESSAGE_ONLINE_INDICATOR:"page_message_online_indicator",LOCAL_PIVOT:"local_pivot",ORION_REQUEST_NEW:"orion_request_new",PHOTO_WITH_SHIELD:"photo_with_shield",PLAYABLE_AD:"playable_ad",FUN_FACT_PROMPT:"fun_fact_prompt",FUN_FACT_STACK:"fun_fact_stack",FATIGUED_SHARE:"fatigued_share",DISCUSSION_QUESTION:"discussion_question",PARTIES_INVITE:"parties_invite",PROFILE_INTRO_CARD_BIO:"profile_intro_card_bio",PAGES_SHARE:"pages_share",PRODUCT_RECOMMENDATION_LIST:"product_recommendation_list",VISUAL_POLL:"visual_poll",MULTI_PLACE_RECOMMENDATION:"multi_place_recommendation",PAGE_IN_COMMENT:"page_in_comment",MESSENGER_PLATFORM_MEDIA_ATTACHMENT:"messenger_platform_media_attachment",SCHEDULED_VIDEO_ANNOUNCEMENT:"scheduled_video_announcement",HSCROLL_ITEM:"hscroll_item",MESSENGER_CALL_LOG:"messenger_call_log",PAGE_REVIEW_UPDATE:"page_review_update",LOYALTY_CARD_OFFER:"loyalty_card_offer",GOODWILL_GRID:"goodwill_grid",TRAVEL_PLAN:"travel_plan",FIND_PLAYERS:"find_players",ASSET3D:"asset3d",MESSENGER_GROUP_PERSONAL_LINK:"messenger_group_personal_link",FREQUENTLY_ASKED_QUESTION:"frequently_asked_question",STORY_LIST:"story_list",GOODWILL_SHARED_CARD:"goodwill_shared_card",PAYMENT_BUBBLE_VIEW:"PAYMENT_BUBBLE_VIEW",POST_TO_EVENT_CREATE:"post_to_event_create",MONTAGE_DIRECT:"montage_direct",NEO_INVITATION:"NEO_INVITATION",NATIVE_TEMPLATES_LINK_SHARE_TEST:"native_templates_link_share_test",GOODWILL_HSCROLL:"goodwill_hscroll",NEO_KID_INITIATE_FRIENDING:"NEO_KID_INITIATE_FRIENDING",EVENT_MICRO_ATTACHMENT:"event_micro_attachment",SAVED_LIST:"saved_list",LOCAL_GUIDE:"local_guide",MEET_UP_EVENT:"meet_up_event",DONATION:"donation",BREAKING_NEWS:"breaking_news",VIDEO_REQUEST:"video_request",GOODWILL_COLLAGE:"goodwill_collage",LEAD_FORM:"lead_form",LEAD_FORM_USER_INFO:"lead_form_user_info",EVENT_TICKET_ORDER:"event_ticket_order",PROFILE_CHANNEL:"profile_channel",ICE_BREAKER:"ICE_BREAKER",MOVIE:"movie",ALOHA_CALL:"aloha_call",TIP_JAR_PAYMENT:"tip_jar_payment",COMMENT_MESSAGE_INFO:"comment_message_info",CASH_ON_DELIVERY_ORDER:"cash_on_delivery_order",VOTER_REGISTRATION_DRIVE:"voter_registration_drive",LIVING_ROOM:"living_room",ACHIEVEMENT_POST:"achievement_post",M_BIRTHDAY_REMINDER:"m_birthday_reminder",INSIGHTS_CHART:"insights_chart",GROUP_PROACTIVE_FLAGGED_POST_QUEUE:"group_proactive_flagged_post_queue",GROUP_ACCEPT_RULE_TO_UNMUTE:"group_accept_rule_to_unmute",PYI_ATTACHMENTS:"pyi_attachments",SHOW_CLICK_TO_WATCH_TAB:"show_click_to_watch_tab",SHOW_CLICK_TO_WATCH_TAB_V2:"show_click_to_watch_tab_v2",SHOW_MASKED:"show_masked",SHOW_CONTINUE_WATCHING:"show_continue_watching",FOX_ALBUM:"fox_album",TOOL_SHARE:"tool_share",PHONE_REMOVED_ACTION_LIST:"phone_removed_action_list",AMP:"amp",LDP_APP_INSTANCE:"ldp_app_instance",PAGE_RECOMMENDATION_V2:"page_recommendation_v2",PLAY_WITH_FRIENDS:"play_with_friends",BLOOD_REQUEST:"blood_request",HIGH_SCHOOL_COMMUNITY_INVITE:"high_school_community_invite",CIVIC_ACTION_POST:"civic_action_post",SCHEDULED_LIVE_VIDEO:"scheduled_live_video",GAMESHOW:"gameshow",MK_FRIEND_REQUEST:"mk_friend_request",GOODWILL_PHOTO_CIRCLE:"goodwill_photo_circle",SERVICES_APPOINTMENT_AVAILABILITY:"services_appointment_availability",NEO_SOCIAL_INVITATION:"neo_social_invitation",NEO_KID_INVITATION:"neo_kid_invitation",GROUP_SELL_PRODUCT_ITEM_CONDENSED:"group_sell_product_item_condensed"})}),null);
__d("MercuryAttachment",["cx","EmojiLikeUtils","MercuryAttachmentContentType","MercuryAttachmentType","MercuryAudioType","StoryAttachmentStyle"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=function(a){return a===Object(a)},i="_1c_u",j=new Set([b("MercuryAttachmentType").ANIMATED_IMAGE,b("MercuryAttachmentType").PHOTO,b("MercuryAttachmentType").VIDEO,b("MercuryAttachmentType").THIRDPARTYSTICKER]),k={getAttachIconClass:function(a){__p&&__p();switch(a){case b("MercuryAttachmentContentType").PHOTO:return"_y2-";case b("MercuryAttachmentContentType").VIDEO:return"_y2_";case b("MercuryAttachmentContentType").MUSIC:return"_y30";case b("MercuryAttachmentContentType").VOICE:return"_y31";case b("MercuryAttachmentContentType").TEXT:return"_y32";case b("MercuryAttachmentContentType").MSWORD:return"_y33";case b("MercuryAttachmentContentType").MSXLS:return"_y34";case b("MercuryAttachmentContentType").MSPPT:return"_y35"}return"_y36"},getAttachIconClassByMime:function(a){return this.getAttachIconClass(this.getAttachTypeByMime(a))},getAttachTypeByMime:function(a){__p&&__p();if(a.startsWith("image"))return b("MercuryAttachmentContentType").PHOTO;else if(a.startsWith("video"))return b("MercuryAttachmentContentType").VIDEO;else if(a.startsWith("audio"))return b("MercuryAttachmentContentType").MUSIC;else if(a.startsWith("text/plain"))return b("MercuryAttachmentContentType").TEXT;else if(a=="application/msword"||a.startsWith("application/vnd.ms-word")||a.startsWith("application/vnd.openxmlformats-officedocument.wordprocessingml"))return b("MercuryAttachmentContentType").MSWORD;else if(a.startsWith("application/vnd.ms-excel")||a.startsWith("application/vnd.openxmlformats-officedocument.spreadsheetml"))return b("MercuryAttachmentContentType").MSXLS;else if(a.startsWith("application/vnd.ms-powerpoint")||a.startsWith("application/vnd.openxmlformats-officedocument.presentationml"))return b("MercuryAttachmentContentType").MSPPT;else return b("MercuryAttachmentContentType").UNKNOWN},convertRaw:function(a){__p&&__p();var c=[];for(var d=0;d<a.length;d++){var e=a[d];if(e.attach_type===b("MercuryAttachmentType").PHOTO)c.push(e);else if(e.filename){var f=k.getAttachTypeByMime(e.filetype),g={};g.attach_type=b("MercuryAttachmentType").FILE;g.name=e.filename;g.icon_type=f;g.url="";c.push(g)}}return c},get:function(a){__p&&__p();var c=[];a.attachments?c=a.attachments:a.raw_attachments&&(c=this.convertRaw(a.raw_attachments));var d=b("EmojiLikeUtils").getEmojiSize(a);d&&(c=c.concat([{attach_type:b("MercuryAttachmentType").EMOJI_LIKE,size:d}]));if(!(a.attachments&&a.attachments.length>0)){if(a.sticker_id)return c.concat([{attach_type:b("MercuryAttachmentType").STICKER}]);if(a.preview_attachments&&a.preview_attachments.length>0)return c.concat(a.preview_attachments)}return c},resizeContain:function(a,b){var c=a.width/a.height,d=b.width/b.height;if(d<c)return{width:Math.ceil(Math.min(a.height*d,b.width)),height:Math.ceil(Math.min(a.height,b.height))};else return{width:Math.ceil(Math.min(a.width,b.width)),height:Math.ceil(Math.min(a.width/d,b.height))}},isBubblePreferred:function(a){return this.isFileAttachment(a)},isPhotoAttachment:function(a){return!!(a.attach_type==b("MercuryAttachmentType").PHOTO||a.attach_type==b("MercuryAttachmentType").ANIMATED_IMAGE||a.attach_type==b("MercuryAttachmentType").THIRDPARTYSTICKER||a.attach_type==b("MercuryAttachmentType").FILE&&a.preview_url)},isPhotoGroupAttachment:function(a){return j.has(a.attach_type)},isSinglePhotoGroupAttachment:function(a){return!!(a.attachments&&a.attachments.length===1&&a.attachments[0]&&this.isPhotoGroupAttachment(a.attachments[0]))},isVideoAttachment:function(a){return a.attach_type==b("MercuryAttachmentType").VIDEO},isShareAttachment:function(a){return a.attach_type==b("MercuryAttachmentType").SHARE},isFileAttachment:function(a){return a.attach_type==b("MercuryAttachmentType").FILE},isErrorAttachment:function(a){return a.attach_type==b("MercuryAttachmentType").ERROR},isStickerAttachment:function(a){return a.attach_type==b("MercuryAttachmentType").STICKER},isEmojiLikeAttachment:function(a){return a.attach_type===b("MercuryAttachmentType").EMOJI_LIKE},isVoiceAttachment:function(a){return!a.metadata?!1:a.metadata.type===b("MercuryAudioType").AudioClip||a.metadata.type===b("MercuryAudioType").VoiceMessageWithTranscript},hasAttribution:function(a){return!!a.app_attribution},isLightweightActionAttachment:function(a){return k.isShareAttachment(a)&&a.share&&a.share.target!=null&&a.share.target.lwa_type!=null},isSingleVideoAttachment:function(a){a=this.get(a).filter(h).filter(function(a){return this.isVideoAttachment(a)}.bind(this));return a.length===1},isSharedVideoAttachment:function(a){a=a.attach_type===b("MercuryAttachmentType").SHARE&&a.share&&a.share.subattachments&&a.share.subattachments[0];return!!(a&&a.target&&a.target.video_id)},isGenieSharedVideoAttachment:function(a){return!!(a.attach_type===b("MercuryAttachmentType").SHARE&&a.share&&a.share.style_list.indexOf(b("StoryAttachmentStyle").GENIE_MESSAGE)>-1&&a.share.target&&a.share.target.attachment&&this.isSharedVideoAttachment(a.share.target.attachment))},isSharedVideoAttachmentMessage:function(a){a=this.get(a).filter(h).filter(function(a){return this.isSharedVideoAttachment(a)||this.isGenieSharedVideoAttachment(a)}.bind(this));return a.length===1},getVideoElem:function(a,b){b=b.getMessageElement(a);if(!b)return null;a=b.getElementsByClassName(i);return a&&a.length?a[0]:b}};e.exports=k}),null);
__d("MercuryMessageIDs.bs",["bs_curry","KeyedCallbackManager"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("KeyedCallbackManager"))();function a(a,c){var d=a.filter(function(a){return a.indexOf("id")===-1}),e=function(d){return b("bs_curry")._1(c,a.map(function(a){var b=d[a];if(b!==undefined)return b;else return a}))};return g.executeOrEnqueue(d,e)}function c(a,b){g.setResource(a,b);return 0}f.getServerIDs=a;f.addServerID=c}),null);
__d("MessagingGiftWrapConstants",[],(function(a,b,c,d,e,f){"use strict";a="gift_wrap";b="gift_unwrapped";c="valentines2016";e.exports={TAG_PREFIX:a,UNWRAPPED_TAG:b,VALENTINES_GIFT:c}}),null);
__d("MessengerMessage.bs",["URI","bs_array","Utils.bs","bs_caml_obj","bs_caml_primitive","MercuryActionType","MercuryPayloadSource","isMessengerDotComURI","MercuryLogMessageType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){return b("bs_caml_primitive").caml_float_compare(a.timestamp,c.timestamp)}function c(a){var b=a.offline_threading_id;if(b==null)return!1;else return b===a.message_id}function d(a){if(b("bs_caml_obj").caml_equal(a.action_type,b("MercuryActionType").USER_GENERATED_MESSAGE))return!0;else{a=a.log_message_type;if(!(a==null)&&(b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").SUBSCRIBE)||b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").UNSUBSCRIBE)||b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").SERVER_ERROR)||b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").LIVE_LISTEN)))return!1;else return!0}}function e(a){__p&&__p();var c=a.ranges;if(c==null)return 0;else{c=b("bs_array").map(function(c){__p&&__p();var a=c.entity;if(a==null)return c;else{var d=b("Utils.bs").isTruthy(a.external),e=a.url;if(d||e==null)return c;else{d=new(b("URI"))(e);e=b("isMessengerDotComURI")(b("URI").getRequestURI());var f=d.getDomain();if(e&&(f==null||f===""))e=1;else return c;if(e===1)return Object.assign(Object.assign({},c),{entity:Object.assign(Object.assign({},a),{url:d.setProtocol("https").setDomain("www.facebook.com").toString()})})}}},c);Object.assign(a,{ranges:c});return 0}}function g(a){if(b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").UNKNOWN)||b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").SERVER_INITIAL_DATA)||b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO))return!0;else return b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").SERVER_THREAD_SYNC)}f.compare=a;f.isLocalMessage=c;f.isTitanMessage=d;f.finalizeRanges=e;f.shouldSortForPayloadSource=g}),null);
__d("MessengerFluxReduceDispatcher",["ExplicitRegistrationReactDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("ExplicitRegistrationReactDispatcher"));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=new a({strict:!1})}),null);
__d("MessengerSharedMediaActions",["MessengerFluxReduceDispatcher","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")({CURRENT_LOADED:null,DELETE_PHOTOS:null,LATEST_LOADED:null,LOAD_CURRENT:null,LOAD_MORE_LATEST:null,LOAD_MORE_PREVIOUS:null,PREVIOUS_LOADED:null}),h="MessengerSharedMedia";a={Types:g,Namespace:h,currentLoaded:function(a){b("MessengerFluxReduceDispatcher").dispatch({type:g.CURRENT_LOADED,namespace:h,data:a})},deletePhotos:function(a,c){b("MessengerFluxReduceDispatcher").dispatch({type:g.DELETE_PHOTOS,namespace:h,threadFBID:a,photoFBIDs:c})},loadCurrent:function(a,c){b("MessengerFluxReduceDispatcher").dispatch({type:g.LOAD_CURRENT,namespace:h,threadFBID:a,photoID:c})},loadMorePrevious:function(a,c,d){b("MessengerFluxReduceDispatcher").dispatch({type:g.LOAD_MORE_PREVIOUS,namespace:h,threadFBID:a,afterCursor:c,first:d})},loadMoreLatest:function(a,c,d){b("MessengerFluxReduceDispatcher").dispatch({type:g.LOAD_MORE_LATEST,namespace:h,threadFBID:a,beforeCursor:c,last:d})},previousLoaded:function(a){b("MessengerFluxReduceDispatcher").dispatch({type:g.PREVIOUS_LOADED,namespace:h,data:a})},latestLoaded:function(a){b("MessengerFluxReduceDispatcher").dispatch({type:g.LATEST_LOADED,namespace:h,data:a})}};e.exports=a}),null);
__d("arrayStableSort",[],(function(a,b,c,d,e,f){function a(a,b){return a.map(function(a,b){return{data:a,index:b}}).sort(function(a,c){return b(a.data,c.data)||a.index-c.index}).map(function(a){return a.data})}e.exports=a}),null);
__d("RangedCallbackManager",["CallbackManagerController","arrayStableSort","createObjectFrom"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c,d){"use strict";this.$1=[],this.$2=!1,this.$3=!1,this.$4={},this.$5=new(b("CallbackManagerController"))(this.$6.bind(this)),this.$7=a,this.$8=c,this.$9=d}a.prototype.executeOrEnqueue=function(a,b,c,d,e){"use strict";return this.$5.executeOrEnqueue({start:a,limit:b},c,{strict:!!d,skipOnStrictHandler:e})};a.prototype.unsubscribe=function(a){"use strict";this.$5.unsubscribe(a)};a.prototype.getUnavailableResources=function(a){"use strict";__p&&__p();a=this.$5.getRequest(a);var b=[];if(a&&!this.$2){var c=a.request;a=this.$10(a.options);c=c.start+c.limit;for(var a=a.length;a<c;a++)b.push(a)}return b};a.prototype.addResources=function(a){"use strict";a.forEach(function(a){this.$4[a]||(this.$4[a]=!0,this.$1.push(a),this.$3=null)}.bind(this)),this.resortResources(),this.$5.runPossibleCallbacks()};a.prototype.addResourcesWithoutSorting=function(a,c){"use strict";var d=this.$1.slice(0,c);d=d.concat(a);d=d.concat(this.$1.slice(c));this.$1=d;Object.assign(this.$4,b("createObjectFrom")(a,!0));this.$3=null;this.$5.runPossibleCallbacks()};a.prototype.removeResources=function(a){"use strict";a.forEach(function(a){if(this.$4[a]){this.$4[a]=!1;a=this.$1.indexOf(a);a!=-1&&this.$1.splice(a,1)}}.bind(this))};a.prototype.removeAllResources=function(){"use strict";this.$1=[],this.$4={}};a.prototype.resortResources=function(){"use strict";this.$1=b("arrayStableSort")(this.$1,function(a,b){return this.$8(this.$7(a),this.$7(b))}.bind(this))};a.prototype.setReachedEndOfArray=function(){"use strict";this.$2||(this.$2=!0,this.$3=null,this.$5.runPossibleCallbacks())};a.prototype.hasReachedEndOfArray=function(){"use strict";return this.$2};a.prototype.forceRunCallbacks=function(){"use strict";this.$5.runPossibleCallbacks({force:!0})};a.prototype.setError=function(a){"use strict";this.$3!==a&&(this.$3=a,this.$5.runPossibleCallbacks())};a.prototype.getError=function(a,b,c){"use strict";c=this.$10({strict:c});return a+b>c.length?this.$3:null};a.prototype.hasResource=function(a){"use strict";return this.$4[a]};a.prototype.getResourceAtIndex=function(a){"use strict";return this.$1[a]};a.prototype.getAllResources=function(){"use strict";return this.$1.concat()};a.prototype.getCurrentArraySize=function(a){"use strict";return this.$10(a).length};a.prototype.$10=function(a){"use strict";var b=this.$1;if(a&&a.strict){a=a.skipOnStrictHandler||this.$9;a&&(b=b.filter(a))}return b};a.prototype.$6=function(a,b){"use strict";__p&&__p();var c=this.$10(b),d=a.start;a=a.start+a.limit;b=!!(b&&b.force);if(!b&&!this.$2&&!this.$3&&a>c.length)return!1;else{b=c.slice(d,a);d=a>c.length?this.$3:null;return[b,d]}};a.prototype.getElementsUntil=function(a){"use strict";var b=[];for(var c=0;c<this.$1.length;c++){var d=this.$7(this.$1[c]);if(this.$8(d,a)>0)break;b.push(this.$1[c])}return b};e.exports=a}),null);
__d("MercuryMessages",["invariant","BanzaiODS","ChatReliabilityInstrumentation","EventEmitter","FBJSON","ImmutableObject","LogHistory","MercuryActionStatus","MercuryActionType","MercuryAssert","MercuryAttachment","MercuryDispatcher","MercuryIDs","MercuryLogMessageType","MercuryMessageClientState","MercuryPayloadSource","MercurySingletonProvider","MercuryMessageActions","MercuryMessageIDs.bs","MessagingGiftWrapConstants","MessengerSharedMediaActions","RangedCallbackManager","MercurySendMessageFields","MercuryServerRequests","MercuryThreadActions","MercuryThreadInformer","MercuryThreads","MessengerMessage.bs","gkx","setImmediate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=new(b("EventEmitter"))(),i=b("LogHistory").getInstance("mercury_messages");a.getForFBID=function(a){return j.getForFBID(a)};a.get=function(){return j.get()};function a(a){__p&&__p();this.$1=a,this.$2=b("MercuryMessageActions").getForFBID(this.$1),this.$3=b("MercuryServerRequests").getForFBID(this.$1),this.$4=b("MercuryThreadInformer").getForFBID(this.$1),this.$5=b("MercuryThreads").getForFBID(this.$1),this.$6=b("MercuryThreadActions").getForFBID(this.$1),this.$7=b("MercuryDispatcher").getForFBID(this.$1),this.$8=!1,this.$9={},this.$10={},this.$11={},this.$12=new Map(),this.$13={},this.$14={},this.$7.subscribe("update-messages",function(a,c){a=(c.actions||[]).filter(function(a){var c=a.action_type,d=a.thread_id&&(c==b("MercuryActionType").LOG_MESSAGE||c==b("MercuryActionType").USER_GENERATED_MESSAGE||c==b("MercuryActionType").SEND_MESSAGE||c==b("MercuryActionType").DELETE_THREAD||c==b("MercuryActionType").DELETE_MESSAGES),e=a.upload_id&&a.upload_data&&(c==b("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER||c==b("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER),f=c==b("MercuryActionType").REACTION_UPDATE,g=c==b("MercuryActionType").MONTAGE_DIRECT_EXPIRE,h=c==b("MercuryActionType").LIVE_LOCATION_UPDATE,i=a.replaced_message_id&&c==b("MercuryActionType").REPLACE_MESSAGE;a=a.unwrapped_message_id&&c==b("MercuryActionType").UNWRAP_MESSAGE;return d||e||f||h||i||a||g});var d=b("MessengerMessage.bs").shouldSortForPayloadSource(c.payload_source);this.handleUpdates(a,d,c.payload_source,c.from_client);c.end_of_history&&this.$15(c.end_of_history,c.payload_source);this.$8&&(this.$8=!1,h.emit("change"))}.bind(this)),this.$7.subscribe("invalidate-thread-state",function(a,b){this.$16(b)}.bind(this)),this.$7.subscribe("invalidate-global-state",function(){return this.invalidateGlobalState()}.bind(this)),i.debug("constructed",JSON.stringify({fbid:this.$1}))}a.prototype.getMessagesFromIDs=function(a){return(a||[]).map(function(a){return this.$17(a)}.bind(this)).filter(function(a){return a})};a.prototype.getServerMessageID=function(a){var b=a;this.$13[a]&&(b=this.$13[a]);return b};a.prototype.hasLoadedNMessages=function(a,b){a=this.$18(a);return a.hasReachedEndOfArray()||a.getCurrentArraySize()>=b};a.prototype.hasLoadedExactlyNMessages=function(a,b){a=this.$18(a);return a.getCurrentArraySize()==b};a.prototype.invalidateGlobalState=function(){var a=Object.keys(this.$10);this.$9={};this.$10={};this.$11={};this.$12=new Map();this.$13={};a.map(function(a){return this.$4.invalidatedThread(a)}.bind(this))};a.prototype.getThreadMessagesRange=function(a,b,c,d,e,f){__p&&__p();var g=this.$18(a),h=function(a){d(this.$19(a))}.bind(this);b=g.executeOrEnqueue(b,c,h);c=g.getUnavailableResources(b);h=this.$9[a];if(c.length&&!h){h=g.getCurrentArraySize();g=this.$11[a]||0;h=h-g;c=c.length+g;g=this.getCurrentlyLoadedMessages(a);g=g.length?g[0].timestamp:null;this.$3.fetchThreadMessages(a,h,c,g,e,f)}else this.$9[a]=!1;return b};a.prototype.getThreadMessagesRangeNow=function(a,b,c){a=this.$18(a);var d=[];for(var e=b;e<b+c;e++){var f=a.getResourceAtIndex(e);f=f&&this.$17(f);f&&d.push(f)}return d};a.prototype.getThreadMessagesSinceTimestamp=function(a,b){a=this.$18(a);a=a.getElementsUntil(b);return this.$19(a)};a.prototype.hasLoadedAllMessages=function(a){return this.$18(a).hasReachedEndOfArray()};a.prototype.getCurrentlyLoadedMessages=function(a){a=this.$18(a).getAllResources();return this.$19(a)};a.prototype.unsubscribe=function(a,c){b("MercuryAssert").isThreadID(c);c=this.$18(c);c.unsubscribe(a)};a.prototype.$20=function(a,c){b("MessengerMessage.bs").finalizeRanges(c),this.$12.set(a,new(b("ImmutableObject"))(c))};a.prototype.$21=function(a,b){__p&&__p();var c=this.$12.get(a);if(c){var d=c.page_admin_notes?c.page_admin_notes.slice():[],e=!1,f=!0;for(var g=0;g<d.length;++g)if(d[g].id===b.id){e=!0;f=!1;break}else(d[g].id===null||d[g].id===undefined)&&d[g].body===b.body&&(e=!0,d[g]=b);e||d.push(b);if(f){g={};g.page_admin_notes=d;this.$22(a,c,g)}}};a.prototype.$22=function(a,c,d){c=b("ImmutableObject").set(c,d);this.$12.set(a,c);return c};a.prototype.$23=function(a,c,d){__p&&__p();if(a==b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE){c=this.getThreadMessagesSinceTimestamp(c,d);if(c.length>0){b("BanzaiODS").bumpEntityKey("chat.web","channel.messages_reordered");return!0}}else if(a===b("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE||a===b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE)return!0;return!1};a.prototype.$24=function(a,c){var d=a.action_type;c==b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE&&d==b("MercuryActionType").USER_GENERATED_MESSAGE&&a.offline_threading_id&&this.$13[a.offline_threading_id]===a.offline_threading_id&&(a.client_message_id=a.offline_threading_id,a.status=b("MercuryActionStatus").SUCCESS,a.action_type=b("MercuryActionType").SEND_MESSAGE,d=a.action_type);if(c===b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE&&d==b("MercuryActionType").USER_GENERATED_MESSAGE){c=this.$5.getThreadMetaNow(a.thread_id);c&&c.folder&&(a.folder=c.folder);b("ChatReliabilityInstrumentation").logMESSAGE_RECEIVED(b("FBJSON").stringify({otid:a.offline_threading_id,message_id:a.message_id,other_user_fbid:a.other_user_fbid,viewer_page_fbid:!c||!c.page_thread_info?null:c.page_thread_info.pageID}))}return a};a.prototype.handleUpdates=function(a,c,d,e){__p&&__p();var f=void 0,g={};for(var h=0;h<a.length;h++){var i=this.$24(a[h],d),j=i.action_type,k=i.message_id?this.$17(i.message_id):null;if(j==b("MercuryActionType").LOG_MESSAGE&&b("MessengerMessage.bs").isLocalMessage(i))continue;if(d==b("MercuryPayloadSource").SERVER_SEARCH){this.$12.has(i.message_id)||this.$20(i.message_id,i);continue}else if(i.client_state===b("MercuryMessageClientState").SEND_TO_SERVER){this.$20(i.message_id,i);continue}else if(j==b("MercuryActionType").SEND_MESSAGE){var l=i.client_message_id,m=this.$17(l);if(l&&m&&i.status){var n=m.status;if(m.status==b("MercuryActionStatus").SUCCESS)continue;g[i.thread_id]||(g[i.thread_id]=[]);this.$25(i);if(typeof n!==undefined||i.status==b("MercuryActionStatus").FAILED_UNKNOWN_REASON||i.status==b("MercuryActionStatus").UNABLE_TO_CONFIRM||i.status==b("MercuryActionStatus").SUCCESS||i.status==b("MercuryActionStatus").ERROR){m=this.$17(l);m&&this.$26(i.thread_id,m.message_id,d)}}continue}else if(j==b("MercuryActionType").DELETE_THREAD){this.$18(i.thread_id).removeAllResources();continue}else if(j==b("MercuryActionType").DELETE_MESSAGES){this.$27(i.thread_id,i.message_ids,d);b("setImmediate")(function(){this.$6.updateSnippet(i.thread_id,i.message_ids)}.bind(this));continue}else if(j===b("MercuryActionType").REACTION_UPDATE){this.$28(i)&&this.$29(g,i,d);continue}else if(j===b("MercuryActionType").MONTAGE_DIRECT_EXPIRE){this.$30(i)&&this.$29(g,i,d);continue}else if(j===b("MercuryActionType").LIVE_LOCATION_UPDATE){this.$31(i)&&this.$29(g,i,d);continue}else if(j==b("MercuryActionType").REPLACE_MESSAGE){this.$32(i)&&(this.$29(g,i,d),c=!0);continue}else if(i.offline_threading_id&&this.$13[i.offline_threading_id]&&(d!=b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO||this.$13[i.offline_threading_id]===i.message_id)||k){if(k&&i.ranges&&i.ranges.length>0){n=k.message_id;this.$22(this.$13[n]||n,k,{ranges:i.ranges});this.$26(k.thread_id,k.message_id,"link_shim")}continue}else if(j===b("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER){this.$33(i.upload_id,i.upload_data);continue}else if(j===b("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER){this.$34(i.upload_id,i.upload_data);continue}else if(j==b("MercuryActionType").UNWRAP_MESSAGE)this.$35(i)&&this.$26(i.thread_id,i.unwrapped_message_id,d);else{d===b("MercuryPayloadSource").CLIENT_SEND_MESSAGE&&(this.$13[i.message_id]=i.message_id,i.thread_id=="root:"+i.offline_threading_id&&this.$18(i.thread_id).setReachedEndOfArray());j==b("MercuryActionType").LOG_MESSAGE&&i.log_message_type==b("MercuryLogMessageType").SERVER_ERROR&&(this.$9[i.thread_id]=!0);i.client_state===b("MercuryMessageClientState").DO_NOT_SEND_TO_SERVER&&i.upload_id&&(this.$14[i.upload_id]=i);g[i.thread_id]||(g[i.thread_id]=[]);g[i.thread_id].push(i.message_id);this.$20(i.message_id,i);i.offline_threading_id&&i.offline_threading_id!=i.message_id&&(this.$13[i.offline_threading_id]=i.message_id,b("MercuryMessageIDs.bs").addServerID(i.offline_threading_id,i.message_id),i.threading_id&&b("MercuryMessageIDs.bs").addServerID(i.threading_id,i.message_id));i[b("MercurySendMessageFields").MANUAL_RETRY_CNT]>0&&(f=this.$18(i.thread_id),f.resortResources([i.message_id]),this.$36(i.thread_id,b("MercuryPayloadSource").CLIENT_SEND_MESSAGE));c=c||this.$23(d,i.thread_id,i.timestamp);if(!c){l=this.$17(i.message_id);l&&this.$37(l)}continue}}for(var o in g){f=this.$18(o);m=f.getAllResources();n=m.filter(function(a){a=this.$12.get(a);return!a?!0:a.action_type==b("MercuryActionType").LOG_MESSAGE&&a.log_message_type==b("MercuryLogMessageType").SERVER_ERROR}.bind(this));f.removeResources(n);e&&this.$38(o,g[o]);c?(f.addResources(g[o]),this.$36(o,d)):f.addResourcesWithoutSorting(g[o].reverse(),0);this.$4.updatedThread(o)}};a.prototype.$29=function(a,c,d){var e=c.message_id||c.messageId;a[c.thread_id]||(a[c.thread_id]=[]);this.$18(c.thread_id).removeResources([c.replaced_message_id,c.offline_threading_id]);c.action_type!==b("MercuryActionType").REACTION_UPDATE&&c.action_type!==b("MercuryActionType").LIVE_LOCATION_UPDATE&&c.action_type!==b("MercuryActionType").MONTAGE_DIRECT_EXPIRE&&a[c.thread_id].push(e);c.replaced_message_id&&this.$26(c.thread_id,c.replaced_message_id,d);this.$26(c.thread_id,e,d)};a.prototype.isFirstMessage=function(a){var b=this.$18(a.thread_id);if(b.getCurrentArraySize()===0)return!1;var c=b.getResourceAtIndex(b.getCurrentArraySize()-1);c=this.$17(c);c=c&&c.message_id;a=this.$17(a.message_id);a=a&&a.message_id;return!c||!a?!1:b.hasReachedEndOfArray()&&c==a};a.prototype.$27=function(a,c,d){__p&&__p();if(!c.length)return;this.$39(a,c,d);d!==b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE&&this.$3.deleteMessages(a,c);d=this.$19(c);for(var a=0;a<d.length;a++){c=d[a];if(c&&c.has_attachment){var e=c.attachments.map(function(a){return b("MercuryAttachment").isPhotoAttachment(a)||b("MercuryAttachment").isVideoAttachment(a)?a.metadata.fbid:null}).filter(function(a){return a!==null});b("MessengerSharedMediaActions").deletePhotos(b("MercuryIDs").getThreadFBIDFromThreadID(c.thread_id),e)}}};a.prototype.$39=function(a,b,c){b=b.map(function(a){a=this.$17(a);return a&&a.message_id}.bind(this)).filter(function(a){return!!a});var d=this.$18(a);d.removeResources(b);this.$36(a,c)};a.prototype.$25=function(a){__p&&__p();var c=a.client_message_id;if(!c)return!1;var d=this.$17(c);if(!d)return!1;var e={};e.status=a.status;(a.status===b("MercuryActionStatus").SUCCESS||a.error_data)&&(e.error_data=a.error_data);var f=a.message_id;if(this.$12.has(f)){d&&this.$22(f,d,e);return!1}a.threading_id&&(e.threading_id=a.threading_id);a.timestamp&&(e.timestamp=a.timestamp);a.log_message_data&&(e.log_message_data=a.log_message_data);a.ranges&&a.ranges.length&&(b("MessengerMessage.bs").finalizeRanges(a),e.ranges=a.ranges);a.attachments&&a.attachments.length&&(e.raw_attachments=null,e.attachments=a.attachments);this.$13[c]=f;b("MercuryMessageIDs.bs").addServerID(c,f);if(d){a=this.$22(f,d,e);this.$12.set(c,new(b("ImmutableObject"))());b("MessengerMessage.bs").isTitanMessage(a)&&this.$11[a.thread_id]--}return!0};a.prototype.$28=function(a){var b,c=a.messageId,d=a.reaction;a=a.userId;var e=this.$17(c);if(!e)return!1;b=babelHelpers["extends"]({},e.reactions,(b={},b[a]=d,b));d||delete b[a];this.$22(c,e,{reactions:b});return!0};a.prototype.$30=function(a){__p&&__p();if(!b("gkx")("AT5MAotH6BG7mXo4DyZnW3seA7_jf32c8tGX1llmkbXJ5ui_oKs0jpz-iYum9Gkv1o7pv5ZMvW9WlaNx_vA1ZSmAhi0Rjb62jJA5vu2Oz81AxQ"))return!1;a=a.messageId;var c=this.$17(a);if(!c||!c.attachments||c.attachments.length!==1)return!1;var d=c.attachments[0];if(!d||!d.share)return!1;var e=d.share.media;if(!e)return!1;var f=d.share.target;if(!f||!f.message_state)return!1;d=babelHelpers["extends"]({},d,{share:babelHelpers["extends"]({},d.share,{media:babelHelpers["extends"]({},e,{image:null,source:null}),target:babelHelpers["extends"]({},f,{message_state:"EXPIRED",blob_media:null,image:null})})});this.$22(a,c,{attachments:[d]});return!0};a.prototype.$31=function(a){__p&&__p();var b=a.messageId;a=a.liveLocation;var c=this.$17(b);if(!c||!c.attachments||c.attachments.length!==1)return!1;var d=c.attachments[0];if(!d||!d.share)return!1;var e=d.share.target;if(!e||!e.live_location_id)return!1;d=babelHelpers["extends"]({},d,{share:babelHelpers["extends"]({},d.share,{target:babelHelpers["extends"]({},a,{live_location_id:e.live_location_id})})});this.$22(b,c,{attachments:[d]});return!0};a.prototype.$32=function(a){__p&&__p();var c=a.replaced_message_id;if(!c)return!1;var d=this.$17(c);if(!d)return!1;var e=a.message_id,f={};a.status&&(f.status=a.status);a.timestamp&&e!==c&&(f.timestamp=a.timestamp);a.log_message_data&&(f.log_message_data=a.log_message_data);a.ranges&&a.ranges.length&&(b("MessengerMessage.bs").finalizeRanges(a),f.ranges=a.ranges);a.meta_ranges&&(f.meta_ranges=a.meta_ranges);a.attachments&&a.attachments.length&&(f.raw_attachments=null,f.attachments=a.attachments);a.body&&a.body!==d.body&&(f.body=a.body);a.platform_xmd&&a.platform_xmd!==d.platform_xmd&&(f.platform_xmd=a.platform_xmd);a.profile_ranges&&a.profile_ranges!==d.profile_ranges&&(f.profile_ranges=a.profile_ranges);if(Object.keys(f).length===0)return!1;b("MercuryMessageIDs.bs").addServerID(e,e);this.$22(e,d,f);c!==e&&(this.$12["delete"](c),d.message_id&&this.$12.has(d.message_id)&&this.$12["delete"](d.message_id));return!0};a.prototype.$35=function(a){var c=this.$17(a.unwrapped_message_id);if(!c||!c.tags)return!1;var d=c.tags.slice(0);d.push(b("MessagingGiftWrapConstants").UNWRAPPED_TAG);d={tags:d};this.$22(a.unwrapped_message_id,c,d);return!0};a.prototype.getNumberLocalMessages=function(a){return this.$11[a]||0};a.prototype.$33=function(a,b){a=this.$40(a,b);delete a.preview_attachments;this.$3.sendNewMessage(a)};a.prototype.$34=function(a,b){a=this.$40(a,b);this.$39(a.thread_id,[a.message_id]);this.$11[a.thread_id]&&this.$11[a.thread_id]--};a.prototype.$40=function(a,c){__p&&__p();var d=this.$14[a];d||g(0);d.image_ids=c.image_ids;d.file_ids=c.file_ids;d.audio_ids=c.audio_ids;d.gif_ids=c.gif_ids;d.video_ids=c.video_ids;d.client_state=b("MercuryMessageClientState").SEND_TO_SERVER;delete this.$14[a];return d};a.prototype.$26=function(a,b,c){this.$8=!0,this.$4.updatedMessage(a,b,c)};a.prototype.$37=function(a){this.$8=!0,this.$4.receivedMessage(a)};a.prototype.$36=function(a,b){this.$8=!0,this.$4.reorderedMessages(a,b)};a.prototype.$16=function(a){__p&&__p();if(!this.$10[a])return;var b=this.$10[a].getAllResources();b.forEach(function(a){var b=this.$17(a),c=undefined;b&&(c=b.offline_threading_id);this.$12["delete"](a);if(c){b=this.$13[c];b&&this.$12["delete"](b);delete this.$13[c]}delete this.$13[a]}.bind(this));delete this.$10[a]};a.addListener=function(a,b){return h.addListener(a,b)};a.prototype.$17=function(a){var b=a;this.$13[a]&&(b=this.$13[a]);return this.$12.get(b)};a.prototype.$18=function(a){this.$10[a]||(this.$10[a]=new(b("RangedCallbackManager"))(function(a){a=this.$17(a);return a&&a.timestamp}.bind(this),function(a,b){return b-a}));return this.$10[a]};a.prototype.$15=function(a,b){a.forEach(function(a){var c=this.$18(a);c.setReachedEndOfArray();this.$36(a,b)}.bind(this))};a.prototype.$19=function(a){a=a.reduce(function(a,b){b=this.$17(b);b&&a.push(b);return a}.bind(this),[]);return a.reverse()};a.prototype.$38=function(a,c){c=c.filter(function(a){return b("MessengerMessage.bs").isTitanMessage(this.$17(a))}.bind(this));this.$11[a]||(this.$11[a]=0);this.$11[a]+=c.length};var j=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryParticipantFetcher",["LogHistory","MercuryIDs","MercuryPayloadSource","MercuryServerPayloadPreprocessor","ShortProfiles","clearTimeout","setImmediate","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("LogHistory").getInstance("short_profiles");function a(a){this.$4=b("MercuryServerPayloadPreprocessor").getForFBID(a),this.$1=!1,this.$2=new Set(),this.$3=new Set(),this.$5=setInterval(this.$7.bind(this),20*1e3)}a.prototype.fetch=function(a){this.$8(a),this.$7()};a.prototype.fetchMulti=function(a){a.length&&(a.forEach(function(a){return this.$8(a)}.bind(this)),this.$7())};a.prototype.$8=function(a){this.$3.has(a)||this.$2.add(a)};a.prototype.$7=function(){if(this.$1||this.$2.size===0)return;this.$1=!0;b("setImmediate")(function(){this.$1=!1,this.$2.forEach(function(a){return this.$3.add(a)}.bind(this)),this.$9(this.$2,function(a){a.forEach(function(a){return this.$3["delete"](a.id)}.bind(this)),this.$10(a),this.$6&&b("clearTimeout")(this.$6)}.bind(this)),this.$11(),this.$2.clear()}.bind(this))};a.prototype.$11=function(){this.$6=b("setTimeoutAcrossTransitions")(function(){this.$3.forEach(function(a){return this.$2.add(a)}.bind(this)),this.$3.clear()}.bind(this),11*1e3)};a.prototype.$9=function(a,c){__p&&__p();var d=[];a.forEach(function(a){a=b("MercuryIDs").tokenize(a);var c=a.type;a=a.value;c==="fbid"&&d.push(a)});d.length>0&&(b("ShortProfiles").getMulti(d,function(a){var b=[];for(var e in a)b.push(h(a[e],e));c(b);b.length!==d.length&&g.error("server_fetch_participant_count_error",JSON.stringify({expectedIDs:d,receivedIDs:Object.keys(a)}))}),g.debug("client_fetch_participants",JSON.stringify({userIDs:d})))};a.prototype.$10=function(a){this.$4.handleUpdate({participants:a,from_client:!1,payload_source:b("MercuryPayloadSource").SERVER_FETCH_PARTICIPANTS})};function h(a,c){c=babelHelpers["extends"]({gender:a.gender,fbid:a.id||c,href:a.uri,id:b("MercuryIDs").getParticipantIDFromUserID(a.id||c),image_src:a.thumbSrc,name:a.name,short_name:a.firstName,employee:a.employee,is_employee_away:a.is_employee_away,type:a.type,vanity:a.vanity,is_friend:a.is_friend,is_messenger_user:a.is_messenger_user,is_coworker:a.is_coworker},{});a.officeStatus&&(c.officeStatus=a.officeStatus,c.officeStatusEndDate=a.officeStatusEndDate,c.officeStatusComment=a.officeStatusComment,c.officeStatusLocation=a.officeStatusLocation);(a.timezone||a.timezone===0)&&(c.timezone=a.timezone);a.personal_id&&(c.personal_id=a.personal_id);a.work_id&&(c.work_id=a.work_id);a.roomLocation&&(c.room_location=a.roomLocation);return c}e.exports=a}),null);
__d("ImageSourceType",[],(function(a,b,c,d,e,f){a=Object.freeze({PROFILE_PICTURE:"profile_picture",IMAGE:"image"});e.exports=a}),null);
__d("PhotoResizeModeConst",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CONTAIN:"s",COVER:"p"})}),null);
__d("ImageSourceRequest",["CurrentUser","ImageSourceType","KeyedCallbackManager","PhotoResizeModeConst","MercuryServerDispatcher"],(function(a,b,c,d,e,f){__p&&__p();function a(){"use strict";this._request={fbid:null,type:null,width:null,height:null,resize_mode:null},this._callback=null}a.prototype.setFBID=function(a){"use strict";this._request.fbid=a;return this};a.prototype.setType=function(a){"use strict";if(![b("ImageSourceType").PROFILE_PICTURE,b("ImageSourceType").IMAGE].includes(a))throw new TypeError("ImageSourceRequest.setType: invalid type "+a);this._request.type=a;return this};a.prototype.setDimensions=function(a,b){"use strict";this._request.width=a;this._request.height=b;return this};a.prototype.setResizeMode=function(a){"use strict";if(![b("PhotoResizeModeConst").COVER,b("PhotoResizeModeConst").CONTAIN].includes(a))throw new TypeError("ImageSourceRequest.setResizeMode: invalid resize mode "+a);this._request.resize_mode=a;return this};a.prototype.setCallback=function(a){"use strict";this._callback=a;return this};a.prototype.send=function(){"use strict";__p&&__p();if(!this._request.fbid||!this._request.width||!this._request.height||!this._request.type||!this._request.resize_mode||!this._callback)throw new Error("ImageSourceRequest: You must set all the fields");var a=h(),c=i(this._request);a.executeOrEnqueue(c,this._callback);if(a.getUnavailableResourcesFromRequest(c).length===1){b("MercuryServerDispatcher").trySend("/ajax/image_source.php",{requests:[this._request]});return!0}return!1};var g=null;function h(){__p&&__p();if(g)return g;var a=new(b("KeyedCallbackManager"))();g=a;b("MercuryServerDispatcher").registerEndpoints({"/ajax/image_source.php":{request_user_id:b("CurrentUser").getID(),mode:b("MercuryServerDispatcher").BATCH_DEFERRED_MULTI,batch_function:function(a,b){var c;(c=a.requests).push.apply(c,b.requests);return a},handler:function(b,c){c=c.getData().requests;for(var d=0;d<c.length;++d)a.setResource(i(c[d]),b[d])}}});return a}function i(a){return[a.fbid,a.type,a.width,a.height,a.resize_mode].join("|")}e.exports=a}),null);
__d("MercuryParticipants",["fbt","CurrentUser","EventEmitter","ImageSourceRequest","ImageSourceType","ImmutableObject","KeyedCallbackManager","MercuryAssert","MercuryIDs","MercuryParticipantFetcher","MercuryParticipantTypes","MercuryParticipantsConstants","MercuryDispatcher","MercuryVanityIDMap.bs","PhotoResizeModeConst","createObjectFrom"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="change";function a(a){this.$1=a,this.$2=new(b("EventEmitter"))(),this.$3=new(b("KeyedCallbackManager"))(),this.$4=new(b("MercuryParticipantFetcher"))(this.$1),this.$5=b("MercuryDispatcher").getForFBID(this.$1),this.$5.subscribe("update-participants",function(a,b){b.participants&&b.participants.length>0&&this.$6(b.participants)}.bind(this)),this.$5.subscribe("invalidate-global-state",function(){this.$7()}.bind(this))}a.prototype.getIDFromVanityOrFBID=function(a){if(!a)return null;if(b("MercuryVanityIDMap.bs").hasVanity(a))return b("MercuryVanityIDMap.bs").getID(a);return/^\d+$/.test(a)?b("MercuryIDs").getParticipantIDFromUserID(a):undefined};a.prototype.getNow=function(a){return this.$8(a)};a.prototype.getOrFetch=function(a){var b=this.$8(a);b||this.$4.fetch(a);return b};a.prototype.get=function(a,c){b("MercuryAssert").isParticipantID(a);return this.$9([a],function(b){c(b[a])})};a.prototype.getMulti=function(a,b){return this.$9(a,b)};a.prototype.getBigImageMulti=function(a,c){__p&&__p();var d=arguments.length<=2||arguments[2]===undefined?b("MercuryParticipantsConstants").BIG_IMAGE_SIZE:arguments[2];b("MercuryAssert").allParticipantIDs(a);var e=!1,f=this.$9(a,function(f){__p&&__p();var g={},h=0,i=new Set(),j=function(b,d){h++,g[b]=d,h===a.length&&(e||c(g),i.size>0&&this.$10(i))}.bind(this),k=function(a,c){var d=this.$3.getResource(a);if(!d)return;this.$3.setResource(a,b("ImmutableObject").set(d,{big_image_src:c.uri}));i.add(a);j(a,c.uri)}.bind(this);for(var l in f){var m=f[l];!m.big_image_src?new(b("ImageSourceRequest"))().setFBID(b("MercuryIDs").getUserIDFromParticipantID(l)).setType(b("ImageSourceType").PROFILE_PICTURE).setDimensions(d,d).setResizeMode(b("PhotoResizeModeConst").COVER).setCallback(k.bind(null,l)).send():j(m.id,m.big_image_src)}}.bind(this));return{remove:function(){e=!0,f.remove()}}};a.prototype.getOrderedBigImageMulti=function(a,b){return this.getBigImageMulti(a,function(c){b(a.map(function(a){return c[a]}))})};a.prototype.$9=function(a,c){__p&&__p();b("MercuryAssert").allParticipantIDs(a);a=this.$3.executeOrEnqueue(a,c);c=this.$3.getUnavailableResources(a).filter(function(a){__p&&__p();var c=b("MercuryIDs").tokenize(a),d=c.type;c=c.value;if(d==="email"){this.$11(a,c);return!1}if(d==="name"){this.$12(a,c);return!1}return!0}.bind(this));this.$4.fetchMulti(c);return this.$13(a)};a.prototype.$8=function(a){var c=this.$3.getResource(a);if(!c){var d=b("MercuryIDs").tokenize(a),e=d.type;d=d.value;e==="email"&&(c=this.$11(a,d));e==="name"&&(c=this.$12(a,d))}return c};a.prototype.$11=function(a,c){c=new(b("ImmutableObject"))(i(a,c));this.$3.setResource(a,c);return c};a.prototype.$12=function(a,c){c=new(b("ImmutableObject"))({gender:b("MercuryParticipantsConstants").UNKNOWN_GENDER,href:null,id:a,image_src:b("MercuryParticipantsConstants").EMAIL_IMAGE,big_image_src:b("MercuryParticipantsConstants").EMAIL_IMAGE,name:c,short_name:c,employee:!1});this.$3.setResource(a,c);return c};a.prototype.$10=function(a){this.$2.emit(h,a)};a.prototype.$6=function(a){var c=a.map(function(a){return a.id});a=a.map(function(a){a.vanity&&b("MercuryVanityIDMap.bs").set(a.vanity,a.id);var c=this.$3.getResource(a.id);return c?b("ImmutableObject").set(c,a):new(b("ImmutableObject"))(this.$14(a))}.bind(this));this.$3.addResourcesAndExecute(b("createObjectFrom")(c,a));this.$10(new Set(c))};a.prototype.$14=function(a){var c=a.type===b("MercuryParticipantTypes").USER||a.type===b("MercuryParticipantTypes").FRIEND;if(!c)return a;if(!a.name&&!a.href&&!a.vanity){c=this.getDefaultName();a.name=c;a.short_name=c}return a};a.prototype.$13=function(a){return{remove:function(){this.$3.unsubscribe(a)}.bind(this)}};a.prototype.$7=function(){this.$3=new(b("KeyedCallbackManager"))()};a.prototype.getDefaultName=function(){return g._("Facebook User")};function i(a,c){return{gender:b("MercuryParticipantsConstants").UNKNOWN_GENDER,href:null,id:a,image_src:b("MercuryParticipantsConstants").EMAIL_IMAGE,big_image_src:b("MercuryParticipantsConstants").EMAIL_IMAGE,name:c,short_name:c,employee:!1,fbid:undefined,accepts_messenger_user_feedback:undefined,is_business_enabled:undefined,is_messenger_platform_bot:undefined,is_employee_away:undefined,is_friend:undefined,is_messenger_user:undefined,is_verified:undefined,type:undefined,vanity:undefined,timezone:undefined,personal_id:undefined,work_id:undefined}}e.exports=new a(b("CurrentUser").getID())}),null);
__d("MercurySendErrorLogger",["Banzai","BanzaiLogger"],(function(a,b,c,d,e,f){var g=b("BanzaiLogger").create({retry:!0}),h=b("Banzai").isEnabled("mercury_send_error_logging");a={log:function(a){if(!h)return;a={message_id:a.message_id,timestamp_client:Date.now(),error_type:a.error_data.type,error_code:a.error_data.code,error_description:a.error_data.description,is_transient:a.error_data.is_transient};g.log("MercurySendErrorLoggerConfig",a)}};e.exports=a}),null);
__d("MercuryServerPayloadPreprocessor",["invariant","MessengerEnvironment","MercuryIDs","MercuryActionStatus","MercuryActionType","MercuryAttachment","MercuryDispatcher","MercurySendErrorLogger","MercurySingletonProvider","MercuryThreadIDMap","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=b("MercuryThreadIDMap").getForFBID(this.$1),this.$3=b("MercuryDispatcher").getForFBID(this.$1)}a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};a.prototype.handleUpdate=function(a){__p&&__p();var c={};a.from_client&&g(0);(a.threads||[]).forEach(function(a){this.$4(a,c);var b=this.$2.getServerIDFromClientIDNow(a.thread_id);d(["MercuryServerRequests"],function(c){c=c.getForFBID(this.$1);c.markThreadFetched(a.thread_id);b&&c.markThreadFetched(b);c.updateLastActionTimestamp(a.timestamp)}.bind(this))}.bind(this));(a.work_top_named_threads||[]).forEach(function(a){this.$4(a,c);var b=this.$2.getServerIDFromClientIDNow(a.thread_id);d(["MercuryServerRequests"],function(c){c=c.getForFBID(this.$1);c.markThreadFetched(a.thread_id);b&&c.markThreadFetched(b);c.updateLastActionTimestamp(a.timestamp)}.bind(this))}.bind(this));(a.ordered_threadlists||[]).forEach(function(a){var b=a.thread_fbids||[];b=b.concat(a.other_user_fbids||[]);a.thread_ids=b.map(function(a){return this.$2.getClientIDFromServerIDNow(a.toString())}.bind(this))}.bind(this));if(a.delivery_receipts){var e={};for(var f=a.delivery_receipts,h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;var k=j.other_user_fbid?b("MercuryIDs").getThreadIDFromUserID(j.other_user_fbid):this.$2.getClientIDFromServerIDNow(j.thread_fbid);k&&(e[k]=j.time)}a.delivery_receipts=e}a.actions=a.actions||[];a.actions.forEach(function(e){e.action_type===b("MercuryActionType").SEND_MESSAGE&&e.status===b("MercuryActionStatus").ERROR&&b("MercurySendErrorLogger").log(e);var f=null,h=null;e.other_user_fbid?(h=b("MercuryIDs").getThreadIDFromUserID(e.other_user_fbid),f=e.other_user_fbid):e.thread_fbid?(h=b("MercuryIDs").getThreadIDFromThreadFBID(e.thread_fbid),f=e.thread_fbid):e.thread_id?(h=b("MercuryIDs").getThreadIDFromThreadFBID(e.thread_id),f=e.thread_id):e.status&&e.status!=b("MercuryActionStatus").SUCCESS&&e.client_thread_id?h=e.client_thread_id:g(0);f=f&&f.toString();e.thread_id=this.$2.hasClientIDForServerID(f)?this.$2.getClientIDFromServerIDNow(f):h;e.action_type==b("MercuryActionType").SEND_MESSAGE&&e.client_thread_id&&f&&(e.thread_id=e.client_thread_id,this.$2.forceSetServerIDToClientID(f,e.client_thread_id),c[f]=e.client_thread_id);e.thread_id||g(0);(!a.payload_source||!a.payload_source.startsWith("server"))&&d(["MercuryServerRequests"],function(a){a.getForFBID(this.$1).updateLastActionTimestamp(e.timestamp)}.bind(this))}.bind(this));this.$5(a);this.$6(a);if(a.end_of_history){k=[];for(var j=0;j<a.end_of_history.length;j++){i=a.end_of_history[j];i.type=="user"?k.push("user:"+i.fbid):i.type=="thread"&&this.$2.hasClientIDForServerID(i.fbid)&&k.push(this.$2.getClientIDFromServerIDNow(i.fbid))}a.end_of_history=k}if(a.roger){var l={};Object.keys(a.roger).forEach(function(c){__p&&__p();var d=Object.keys(a.roger[c]),e=void 0;c?e=this.$2.getClientIDFromServerIDNow(c):d.length===1&&(e=b("MercuryIDs").getThreadIDFromUserID(d[0]));if(e){d=a.roger[c];l[e]={};for(var f in d)if(Object.prototype.hasOwnProperty.call(d,f)){c=b("MercuryIDs").getParticipantIDFromUserID(f);l[e][c]=d[f]}}}.bind(this));a.roger=l}a.newlyAddedClientIDs=c;a.preprocessed=!0;this.$3.handleUpdate(a)};a.prototype.$4=function(a,c){var d=a.other_user_fbid?a.other_user_fbid:a.thread_fbid;d||g(0);var e=this.$2.getClientIDFromServerIDNow(d);e||(e=a.other_user_fbid?b("MercuryIDs").getThreadIDFromUserID(a.other_user_fbid):b("MercuryIDs").getThreadIDFromThreadFBID(a.thread_fbid),this.$2.setServerIDToClientID(d,e),this.$2.setDeprecatedServerIDToClientID(a.thread_id,e),c[d]=e);a.thread_id=e};a.prototype.$5=function(a){a.actions.forEach(function(a){a.action_type===b("MercuryActionType").USER_GENERATED_MESSAGE&&(a.attachments=a.attachments||[],a.attachments.forEach(function(a){if(b("MercuryAttachment").isShareAttachment(a)&&b("MessengerEnvironment").messengerui){var c=new(b("URI"))(a.share.uri);c.getDomain()||(a.share.uri=c.setDomain("facebook.com").setSubdomain(b("URI").getRequestURI().getSubdomain()).setProtocol("https").toString())}}))})};a.prototype.$6=function(a){__p&&__p();a.actions.forEach(function(a){__p&&__p();if(a.action_type!==b("MercuryActionType").USER_GENERATED_MESSAGE)return;a=a;if(!a.has_attachment||!a.attachments)return;for(var c=a.attachments.length-1;c>=0;c-=1){var d=a.attachments[c];if(!d.share||!d.share.style_list||d.share.style_list[0]!="genie_message")continue;d.share.target.genie_id&&(a.author=b("MercuryIDs").getParticipantIDFromUserID(d.share.target.genie_id));d.share.target&&!d.share.target.attachment&&(a.attachments.splice(c,1),a.has_attachment=a.attachments.length>0)}})};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryErrorType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SERVER:1,TRANSPORT:2,TIMEOUT:3})}),null);
__d("MercuryGlobalActionType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({MARK_ALL_READ:"mga-type:mark-all-read",MARK_ALL_SEEN:"mga-type:mark-all-seen"})}),null);
__d("MercuryServerSendMessageQueueOptions",[],(function(a,b,c,d,e,f){function a(a,b,c,d,e,f){"use strict";this.success_handler=a,this.error_handler=b,this.transport_error_handler=c,this.timeout_handler=d,this.timeout=e,this.connection_retries=f}e.exports=a}),null);
__d("MercurySyncConstants",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({ARBITER_EVENT_INVALID_STATE:"SYNC:INVALID_STATE",ARBITER_EVENT_INVALID_STATE_RETRY:"SYNC:INVALID_STATE_RETRY",ARBITER_EVENT_INVALID_STATE_RECOVER:"SYNC:INVALID_STATE_RECOVER",ARBITER_EVENT_SERVER_REQUESTS_FAIL:"NET:SERVER_REQUESTS_FAIL",ARBITER_EVENT_SERVER_REQUESTS_RECOVER:"NET:SERVER_REQUESTS_RECOVER"});e.exports=a}),null);
__d("MercurySyncDeltaHolder",["MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.$2=new Map(),this.$3=[],this.$1=0}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.peek=function(){this.$3=this.$3.sort(function(a,b){return a-b});return this.$3[0]};a.prototype.getTop=function(){this.$3=this.$3.sort(function(a,b){return a-b});return this.$3.reverse()[0]};a.prototype.pop=function(){this.$3=this.$3.sort(function(a,b){return a-b});if(this.$3.length===0)return undefined;var a=this.$3.shift(),b=this.$2.get(a);this.$2["delete"](a);return{seqID:a,delta:b}};a.prototype.push=function(a,b){if(this.$2.has(a))return;this.$2.set(a,b);this.$3.push(a)};a.prototype.getLastSeqID=function(){return this.$1};a.prototype.updateLastSeqID=function(a){this.$1=a};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("XMercuryUnseenThreadIDsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/unseen_thread_ids/",{})}),null);
__d("XMessagingChangeMentionsMuteModeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/mercury/change_mentions_mute_thread/",{})}),null);
__d("XMessagingChangeReactionsMuteModeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/mercury/change_reactions_mute_thread/",{})}),null);
__d("MercuryServerRequests",["errorCode","invariant","Promise","Arbiter","AsyncResponse","BanzaiODS","ChannelConstants","ChatReliabilityInstrumentation","CurrentUser","EventProfiler","FBJSON","LogHistory","MercuryActionStatus","MercuryActionType","MercuryAPIArgsSource","MercuryAssert","MercuryConfig","MercuryDispatcher","MercuryErrorType","MercuryGlobalActionType","MercuryIDs","MercuryLogMessageType","MercuryMessageClientState","MercuryMessageIDs.bs","MercuryPayloadSource","MercurySendErrorLogger","MercuryServerDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequestsConfig","MercuryServerSendMessageQueueOptions","MercuryServerSendMessageQueueRouter","MercuryServerURIs","MercurySingletonProvider","MercurySourceType","MercurySyncConstants","MercurySyncDeltaHolder","MercuryThreadIDMap","MessagingConfig","MessagingTag","XMercuryUnseenThreadIDsController","XMessagingChangeMentionsMuteModeController","XMessagingChangeReactionsMuteModeController","createObjectFrom","gkx","promiseDone","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("LogHistory").getInstance("mercury_server"),j=b("MercuryAPIArgsSource").MERCURY,k=30*1e3,l=!0;function m(a){return a.getError()?"_"+a.getError():""}function n(a,c){__p&&__p();var d=babelHelpers["extends"]({},a),e=void 0;if(c.threads){d.threads||(d.threads={});for(e in c.threads)d.threads[e]=Object.keys(b("createObjectFrom")((d.threads[e]||[]).concat(c.threads[e]||[])))}if(c.messages){d.messages||(d.messages={});for(e in c.messages){d.messages[e]||(d.messages[e]={});for(var f in c.messages[e])d.messages[e][f]?d.messages[e][f]=r(d.messages[e][f],c.messages[e][f]):d.messages[e][f]=c.messages[e][f]}}d.client=a.client||c.client;return d}function o(a,c){var d=Object.assign(b("createObjectFrom")(a.folders,!0),b("createObjectFrom")(c.folders,!0));a=a.client||c.client;return{folders:Object.keys(d),client:a}}function p(a,b){for(var c in b)if(a[c]&&typeof a[c]==="object")a[c]=r(a[c],b[c]);else if(b[c]&&typeof b[c]==="object"){var d={};Object.assign(d,b[c]);a[c]=d}return a}function q(a,b){return b}function r(a,b){var c=a.offset<b.offset?a.offset:b.offset,d=a.offset+a.limit,e=b.offset+b.limit;d=d>e?d:e;e=d-c;d=a.timestamp>b.timestamp?a.timestamp:b.timestamp;return{offset:c,limit:e,timestamp:d}}function s(a,b){var c=a.client||b.client;c={ids:{},client:c};Object.assign(c.ids,a.ids,b.ids);return c}function t(a,c){__p&&__p();var d={},e=void 0,f=a.client||c.client;delete a.client;delete c.client;for(e in a)Object.assign(d,b("createObjectFrom")(a[e],e));for(e in c)Object.assign(d,b("createObjectFrom")(c[e],e));a={client:f};for(var g in d)e=d[g],a[e]||(a[e]=[]),a[e].push(g);return a}function u(a,c){var d=a.client||c.client;a=b("createObjectFrom")(a.ids,!0);c=b("createObjectFrom")(c.ids,!0);a=Object.assign(a,c);return{ids:Object.keys(a),client:d}}function v(a){this.$1=a,this.$2=0,this.$3={},this.$4={},this.$9=new Set(),this.__threadIDMap=b("MercuryThreadIDMap").getForFBID(this.$1),this.$5=b("MercuryDispatcher").getForFBID(this.$1),this.$6=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1),this.$7=new(b("MercuryServerSendMessageQueueOptions"))(function(a,b){this.__handleUpdate(a,b)}.bind(this),function(a){return this.$10(a)}.bind(this),function(a){this.$11(a)}.bind(this),function(a){return this.$12(a)}.bind(this),b("MercuryServerRequestsConfig").sendMessageTimeout,b("MessagingConfig").SEND_CONNECTION_RETRIES),this.$8=b("MercurySyncDeltaHolder").getForFBID(this.$1),this.$13()}v.getForFBID=function(a){return w.getForFBID(a)};v.get=function(){return w.get()};v.prototype.fetchThreadlistInfo=function(a,c){var d=arguments.length<=2||arguments[2]===undefined?b("MessagingTag").INBOX:arguments[2],e=arguments[3],f=arguments.length<=4||arguments[4]===undefined?j:arguments[4],g=arguments[5];l&&(l=!1,b("EventProfiler").tagCurrentActiveInteractionsAs("FirstMercuryThreadFetch"));var h=e?b("MercuryServerDispatcher").IMMEDIATE:null;b("MercuryConfig").MessengerInboxRequests&&!h&&(h=b("MercuryServerDispatcher").BATCH_DEFERRED_MULTI);var i={client:f};i[d]={offset:a,limit:c,filter:e,before:g};this.__sendRequest(b("MercuryServerURIs").THREADLIST_INFO,i,h)};v.prototype.fetchUnseenThreadIDs=function(){arguments.length<=0||arguments[0]===undefined?b("MessagingTag").INBOX:arguments[0],arguments.length<=1||arguments[1]===undefined?j:arguments[1],this.__sendRequest(b("XMercuryUnseenThreadIDsController").getURIBuilder().getURI().toString(),{})};v.prototype.fetchUnreadThreadIDs=function(a){var c=arguments.length<=1||arguments[1]===undefined?j:arguments[1];this.__sendRequest(b("MercuryServerURIs").UNREAD_THREADS,{folders:[a],client:c})};v.prototype.fetchThreadData=function(a){__p&&__p();var c=arguments.length<=1||arguments[1]===undefined?j:arguments[1];b("MercuryAssert").allThreadID(a);var d={threads:{},client:c},e=[],f=[];a.forEach(function(a){__p&&__p();if(this.$3[a])return;this.$3[a]=!0;var c=this.__threadIDMap.getServerIDFromClientIDNow(a);a=b("MercuryIDs").tokenize(a);if(a.type=="user")e.push(a.value),d.threads.user_ids=e;else if(a.type=="thread")c?f.push(c):f.push(a.value),d.threads.thread_fbids=f;else if(a.type=="root")c&&(f.push(c),d.threads.thread_fbids=f);else if(a.type!="pending")throw new Error("Unknown thread type",a)}.bind(this));this.$5.inform("fetch-thread-data",d);d.threads.user_ids&&d.threads.user_ids.forEach(function(a){a||(i.error("empty user id",JSON.stringify(e)),b("ChatReliabilityInstrumentation").logERROR("Invalid user ID sent to thread_info.php: "+JSON.stringify(e)))});d.threads.thread_fbids&&d.threads.thread_fbids.forEach(function(c){c||b("ChatReliabilityInstrumentation").logERROR("Invalid FBID sent to thread_info.php: "+JSON.stringify(a))});for(var g in d.threads){this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,d);break}};v.prototype.ensureThreadIsFetched=function(a){__p&&__p();var c=arguments.length<=1||arguments[1]===undefined?j:arguments[1];if(!this.__threadIDMap.getClientIDFromServerIDNow(a)&&!this.$3[a]){if(!a){b("ChatReliabilityInstrumentation").logERROR("Ensure invalid FBID sent to thread_info.php");i.error("attempting to fetch empty thread_fbid. Bad idea!");return}this.$3[a]=!0;this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,{threads:{thread_fbids:[a]},client:c})}};v.prototype.fetchThreadMessages=function(a,c,d,e,f){__p&&__p();var g=arguments.length<=5||arguments[5]===undefined?j:arguments[5];b("MercuryAssert").isThreadID(a);var h;void 0;var i=void 0,k=b("MercuryIDs").tokenize(a),l=this.__threadIDMap.getServerIDFromClientIDNow(a),m=!1;if(l)h=l,i=k.type=="user"?"user_ids":"thread_fbids";else{h=k.value;switch(k.type){case"user":i="user_ids";m=!0;break;case"thread":i="thread_fbids";break}}var n={messages:{},threads:{},client:g};i?(n.messages[i]={},n.messages[i][h]={offset:c,timestamp:e,limit:d},m&&(n.threads[i]=[h]),this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,n,f)):this.__threadIDMap.getServerIDFromClientID(a,function(a){n.messages.thread_fbids={},n.messages.thread_fbids[a]={offset:c,timestamp:e,limit:d},this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,n,f)}.bind(this))};v.prototype.handleThreadInfoError=function(a,c){__p&&__p();var d=this,e=a.getData();a=[];if(e.messages){for(var f in e.messages.thread_fbids){var g=this.__threadIDMap.getClientIDFromServerIDNow(f);g&&a.push(this.$14(g))}for(var h in e.messages.user_ids)a.push(this.$14("user:"+h));for(var j in e.messages.group_ids)a.push(this.$14("group:"+j))}a.length&&this.$5.handleUpdate({actions:a,from_client:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});if(e.threads&&(e.threads.user_ids||e.threads.thread_fbids||e.threads.group_ids||e.threads.thread_ids)){g=5;a=!0;!e.retry_count?(e.retry_count=0,e.messages&&delete e.messages):e.retry_count>=g&&(!c||!b("gkx")("AT6272W7G37c2zZOpPDUPGXaehXUPvo7_ZqAqdSAoKzgP5DQ8Luz0w5hQkLZeaPa8UmuuAXTSUI8FctXnbHnbKTw"))&&(a=!1,(e.threads.thread_ids||[]).concat(e.threads.thread_fbids||[]).forEach(function(a){a in this.$3&&delete this.$3[a]},this));[].concat(e.threads.thread_ids||[],e.threads.thread_fbids||[],e.threads.user_ids||[],e.threads.group_ids||[]).forEach(function(a){a?this.$9.add(a):b("ChatReliabilityInstrumentation").logERROR("lost a thread id somehow")}.bind(this));if(a){c=Math.pow(2,Math.min(e.retry_count,g))*1e3;b("setTimeoutAcrossTransitions")(function(){i.log("retry_thread","{}"),this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,e)}.bind(this),c);e.retry_count++}this.$9.size&&(function(){var a=[];d.$9.forEach(function(b){return a.push(b)});i.debug("failed threads",JSON.stringify(a));b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_SERVER_REQUESTS_FAIL,a)})()}};v.prototype.markFolderAsRead=function(a){this.__sendRequest(b("MercuryServerURIs").MARK_FOLDER_READ,{folder:a});a=[{action_type:b("MercuryGlobalActionType").MARK_ALL_READ,folder:a}];this.$5.handleUpdate({global_actions:a,from_client:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANGE_READ_STATUS})};v.prototype.changeThreadReadStatus=function(a,c,d,e,f,g){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(h){var j;j={ids:(j={},j[h]=c,j),source:d,watermarkTimestamp:e,shouldSendReadReceipt:f,commerce_last_message_type:g};i.log("initiate_change_read_status",JSON.stringify({thread_id:a,thread_fbid:h,mark_as_read:c,watermarkTimestamp:e}));this.__sendRequest(b("MercuryServerURIs").CHANGE_READ_STATUS,j)}.bind(this))};v.prototype.changeThreadArchivedStatus=function(a,c,d){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){var e={ids:{},source:d};e.ids[a]=c;this.__sendRequest(b("MercuryServerURIs").CHANGE_ARCHIVED_STATUS,e)}.bind(this))};v.prototype.changeThreadPageFollowUpStatus=function(a,c,d){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){var e={ids:{},source:d};e.ids[a]=c;this.__sendRequest(b("MercuryServerURIs").CHANGE_PAGE_FOLLOW_UP_STATUS,e)}.bind(this))};v.prototype.changeThreadFolder=function(a,c){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){var d={};d[c]=[a];this.__sendRequest(b("MercuryServerURIs").MOVE_THREAD,d)}.bind(this))};v.prototype.changeMutingOnThread=function(a,c){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){this.__sendRequest(b("MercuryServerURIs").CHANGE_MUTE_THREAD,{thread_fbid:a,mute_settings:c,payload_source:j})}.bind(this))};v.prototype.changeMentionsMutingOnThread=function(a,c){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){this.__sendRequest(b("XMessagingChangeMentionsMuteModeController").getURIBuilder().getURI(),{thread_fbid:a,mentions_mute_mode:c,payload_source:j})}.bind(this))};v.prototype.changeReactionsMutingOnThread=function(a,c){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){this.__sendRequest(b("XMessagingChangeReactionsMuteModeController").getURIBuilder().getURI(),{thread_fbid:a,reactions_mute_mode:c,payload_source:j})}.bind(this))};v.prototype.markThreadSpam=function(a,c){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){this.__sendRequest(b("MercuryServerURIs").MARK_SPAM,{id:a,source:c})}.bind(this))};v.prototype.unmarkThreadSpam=function(a,c){b("MercuryAssert").isThreadID(a),this.__threadIDMap.getServerIDFromClientID(a,function(a){this.__sendRequest(b("MercuryServerURIs").UNMARK_SPAM,{id:a,source:c})}.bind(this))};v.prototype.deleteThread=function(a,b){this.deleteThreads([a],b)};v.prototype.deleteThreads=function(a,c){b("promiseDone")(b("Promise").all(a.map(function(a){b("MercuryAssert").isThreadID(a);return new(b("Promise"))(function(b){return this.__threadIDMap.getServerIDFromClientID(a,b)}.bind(this))}.bind(this))).then(function(a){this.__sendRequest(b("MercuryServerURIs").DELETE_THREAD,{ids:a,source:c})}.bind(this)))};v.prototype.deleteMessages=function(a,c){b("MercuryMessageIDs.bs").getServerIDs(c||[],function(a){this.__sendRequest(b("MercuryServerURIs").DELETE_MESSAGES,{message_ids:a})}.bind(this))};v.prototype.sendDeliveryReceipts=function(a,c){b("MercuryMessageIDs.bs").getServerIDs(a||[],function(a){this.__sendRequest(b("MercuryServerURIs").DELIVERY_RECEIPTS,{message_ids:a,thread_ids:c})}.bind(this))};v.prototype.sendNewMessage=function(a){var c=arguments.length<=1||arguments[1]===undefined?j:arguments[1];a.offline_threading_id||b("BanzaiODS").bumpEntityKey("chat.web","missing_otid_on_send");if(a.client_state&&a.client_state!==b("MercuryMessageClientState").SEND_TO_SERVER)return;var d=b("MercuryIDs").tokenize(a.thread_id),e=d.type,f=babelHelpers["extends"]({},a);f.thread_id=null;e=="user"?(f.other_user_fbid=d.value,this.$15(f,c)):e=="thread"?(f.thread_fbid=d.value,this.$15(f,c)):e=="root"&&d.value==f.offline_threading_id?(f.client_thread_id=a.thread_id,this.$15(f,c)):(b("MercuryIDs").isLocalThread(a.thread_id)||h(0),this.__threadIDMap.getServerIDFromClientID(a.thread_id,function(a){f.thread_fbid=a,this.$15(f,c)}.bind(this)));b("ChatReliabilityInstrumentation").logMESSAGE_SEND_START(b("FBJSON").stringify({otid:f.offline_threading_id,message_id:f.message_id,other_user_fbid:f.other_user_fbid,viewer_page_fbid:f.creator_info?f.creator_info.pageID:null}))};v.prototype.$15=function(a,c){b("Arbiter").inform(b("ChannelConstants").ATTEMPT_RECONNECT),this.$4[a.message_id]=Date.now(),b("MercuryServerSendMessageQueueRouter").getForFBID(this.$1).enqueue(a.other_user_fbid||a.thread_fbid||a.client_thread_id,this.$7,c,a)};v.prototype.__getSendMessageQueueOptions=function(){return this.$7};v.prototype.markSeen=function(){var a=this.$2;this.__sendRequest(b("MercuryServerURIs").MARK_SEEN,{seen_timestamp:a})};v.prototype.$16=function(a,c,d,e){__p&&__p();a=a.getData();a=a.message_batch||[a];i.debug("handle_send_message_error_common",JSON.stringify({reliability_error_status:d,request_error_status:c,error_data:e,message_list:a}));d=a.map(function(a){a={action_type:b("MercuryActionType").SEND_MESSAGE,other_user_fbid:a.other_user_fbid,thread_fbid:a.thread_fbid,client_message_id:a.message_id,message_id:a.message_id,client_thread_id:a.client_thread_id,status:c,error_data:e};return a});d.forEach(function(a){a.action_type===b("MercuryActionType").SEND_MESSAGE&&a.status===b("MercuryActionStatus").ERROR&&this.__logMercurySendError(a)},this);a={actions:d,payload_source:b("MercuryPayloadSource").CLIENT_HANDLE_ERROR};this.$6.handleUpdate(a)};v.prototype.handleSendMessageError=function(a){var c=a.getPayload(),d=null,e=null;c&&c.error_payload?(d=b("MercuryActionStatus").UNCONFIRMED,e="send_error"):(d=b("MercuryActionStatus").ERROR,e="request_error"+m(a));c=a.error;c===1404102&&b("AsyncResponse").verboseErrorHandler(a);c=/<.*>/.test(a.getErrorDescription())?a.getErrorSummary():a.getErrorDescription();this.$16(a.getRequest(),d,e,{type:b("MercuryErrorType").SERVER,code:a.getError(),description:c,is_transient:a.isTransient()})};v.prototype.handleSendMessageTransportError=function(a){this.$16(a.getRequest(),b("MercuryActionStatus").ERROR,"transport_error"+m(a),{type:b("MercuryErrorType").TRANSPORT,code:a.getError(),is_transient:!0})};v.prototype.handleSendMessageTimeout=function(a){this.$16(a,b("MercuryActionStatus").ERROR,"transport_timeout",{type:b("MercuryErrorType").TIMEOUT,is_transient:!0})};v.prototype.getLastActionTimestamp=function(){return this.$2};v.prototype.__logMercurySendError=function(a){b("MercurySendErrorLogger").log(a)};v.prototype.updateLastActionTimestamp=function(a){var b=Date.now()-1e3*60*60*24;a&&a>b&&(this.$2=Math.max(this.$2,a))};v.prototype.markThreadFetched=function(a){delete this.$3[a],this.$9["delete"](a)&&!this.$9.size&&(i.debug("no_failed_threads","{}"),b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_SERVER_REQUESTS_RECOVER))};v.prototype.$14=function(a){return{action_type:b("MercuryActionType").LOG_MESSAGE,thread_id:a,message_id:a,timestamp:Date.now(),is_unread:!1,source:b("MercurySourceType").UNKNOWN,log_message_body:"",log_message_type:b("MercuryLogMessageType").SERVER_ERROR,log_message_data:{}}};v.prototype.__getForAsyncRequest=function(a){a=a.getData();a=a.request_user_id?a.request_user_id:b("CurrentUser").getID();return v.getForFBID(a)};v.prototype.__handleUpdate=function(a,b){this.__getForAsyncRequest(b).$6.handleUpdate(a)};v.prototype.$17=function(a){var b=this.__getForAsyncRequest(a);b.handleThreadInfoError(a)};v.prototype.$18=function(a){var b=this.__getForAsyncRequest(a);b.handleThreadInfoError(a,!0)};v.prototype.$10=function(a){var b=this.__getForAsyncRequest(a.getRequest());b.handleSendMessageError(a)};v.prototype.$11=function(a){var b=this.__getForAsyncRequest(a.getRequest());b.handleSendMessageTransportError(a)};v.prototype.$12=function(a){var b=this.__getForAsyncRequest(a);b.handleSendMessageTimeout(a)};v.prototype.$13=function(){__p&&__p();var a,c=null;b("MercuryServerRequestsConfig").msgrRegion&&(c={name:"X-MSGR-Region",value:b("MercuryServerRequestsConfig").msgrRegion});a=(a={},a[b("MercuryServerURIs").THREAD_INFO]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_DEFERRED_MULTI,customHeader:c,batch_function:n,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this),error_handler:function(a){return this.$17(a.getRequest())}.bind(this),timeout_handler:function(a){return this.$18(a)}.bind(this),timeout:k},a[b("MercuryServerURIs").MARK_FOLDER_READ]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").CHANGE_READ_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){this.__handleUpdate(a,b);b=(a.threads||[]).map(function(a){return a&&a.thread_id});i.log("response_change_read_status",JSON.stringify({threads:b}))}.bind(this)},a[b("MercuryServerURIs").MARK_SEEN]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:c,batch_function:q,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").THREADLIST_INFO]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE_UNIQUE,customHeader:c,batch_function:p,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").MARK_SPAM]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").UNMARK_SPAM]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").UNREAD_THREADS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE_UNIQUE,customHeader:c,batch_function:o,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").CHANGE_ARCHIVED_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:c,batch_function:s,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").CHANGE_PAGE_FOLLOW_UP_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:c,batch_function:s,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").DELETE_THREAD]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:c,batch_function:u,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").DELETE_MESSAGES]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").DELIVERY_RECEIPTS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").MOVE_THREAD]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:c,batch_function:t,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a[b("MercuryServerURIs").CHANGE_MUTE_THREAD]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)},a);var d=b("XMercuryUnseenThreadIDsController").getURIBuilder().getURI().toString();a[d]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)};d=b("XMessagingChangeMentionsMuteModeController").getURIBuilder().getURI().toString();a[d]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)};d=b("XMessagingChangeReactionsMuteModeController").getURIBuilder().getURI().toString();a[d]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:c,handler:function(a,b){return this.__handleUpdate(a,b)}.bind(this)};b("MercuryServerDispatcher").registerEndpoints(a)};v.prototype.__sendRequest=function(a,c,d){if(this.$8)switch(a){case b("MercuryServerURIs").THREADLIST_INFO:case b("MercuryServerURIs").THREAD_INFO:c.cachius_min_seq_id=this.$8.getLastSeqID();break;default:break}b("MercuryServerDispatcher").trySend(a,c,d,this.$1)};v.prototype.__getFBID=function(){return this.$1};var w=new(b("MercurySingletonProvider"))(v);e.exports=v}),null);
__d("MercuryThreadIDMap",["KeyedCallbackManager","MercuryAssert","MercuryIDs","MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.$2=new(b("KeyedCallbackManager"))(),this.$3=new(b("KeyedCallbackManager"))()}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.setServerIDToClientID=function(a,b){var c=this.getClientIDFromServerIDNow(a);if(c){c!==b;return}this.forceSetServerIDToClientID(a,b)};a.prototype.forceSetServerIDToClientID=function(a,b){this.$2.setResource(a,b),this.$3.setResource(b,a)};a.prototype.setDeprecatedServerIDToClientID=function(a,b){a&&this.$2.setResource(a,b)};a.prototype.getClientIDFromServerIDNow=function(a){return this.$2.getResource(a)};a.prototype.getClientIDFromServerID=function(a,b){this.$2.executeOrEnqueue(a,b),d(["MercuryServerRequests"],function(b){b.getForFBID(this.$1).ensureThreadIsFetched(a)}.bind(this))};a.prototype.getServerIDFromClientIDNow=function(a){return this.$3.getResource(a)};a.prototype.getServerIDFromClientID=function(a,c){b("MercuryAssert").isThreadID(a);var e=this.$3.executeOrEnqueue(a,c);d(["MercuryServerRequests"],function(c){var d=this.$3.getUnavailableResources(e),f=b("MercuryIDs").tokenize(a);d.length&&f.type!="root"&&c.getForFBID(this.$1).fetchThreadData(d)}.bind(this))};a.prototype.hasClientIDForServerID=function(a){return!!this.getClientIDFromServerIDNow(a)};a.prototype.convertThreadIDIfAvailable=function(a){var b=this.getClientIDFromServerIDNow(a);return b||a};a.prototype.canLinkExternally=function(a){b("MercuryAssert").isThreadID(a);var c=b("MercuryIDs").tokenize(a);return c.type=="user"||!!this.getServerIDFromClientIDNow(a)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryDisplayTimeFilterMessageRenderer",["fbt"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={renderFilteredContent:function(a){if(a.is_filtered_content_bh)return g._("This message was removed because it contains blocked or harmful links.");if(a.is_filtered_content_account)return g._("This message has been temporarily removed because the sender's account requires verification.");if(a.is_filtered_content_quasar)return g._("This message was removed because it contains blocked or harmful content.");return a.is_filtered_content_invalid_app?g._("This message was removed because the app it's being sent from is blocked from sending messages."):g._("This message has been temporarily removed because the sender's account requires verification, or it was identified as abusive.")}};e.exports=a}),null);
__d("MercuryGiftSnippetRenderer",["fbt"],(function(a,b,c,d,e,f,g){"use strict";a={renderText:function(a,b){return a?g._("You sent a valentine."):g._("{name} sent a valentine.",[g._param("name",b)])}};e.exports=a}),null);
__d("MercurySyncDeltaTypes",[],(function(a,b,c,d,e,f){"use strict";a={AdminAddedToGroupThread:"AdminAddedToGroupThread",AdminRemovedFromGroupThread:"AdminRemovedFromGroupThread",AdminTextMessage:"AdminTextMessage",ChangeViewerStatus:"ChangeViewerStatus",DeliveryReceipt:"DeliveryReceipt",ForcedFetch:"ForcedFetch",MarkRead:"MarkRead",MarkUnread:"MarkUnread",MarkFolderSeen:"MarkFolderSeen",MessageDelete:"MessageDelete",NewMessage:"NewMessage",NoOp:"NoOp",PagesManagerEvent:"PagesManagerEvent",ParticipantLeftGroupThread:"ParticipantLeftGroupThread",ParticipantsAddedToGroupThread:"ParticipantsAddedToGroupThread",ReadReceipt:"ReadReceipt",ReplaceMessage:"ReplaceMessage",RTCEventLog:"RTCEventLog",ThreadAction:"ThreadAction",ThreadDelete:"ThreadDelete",ThreadFolder:"ThreadFolder",ThreadMuteSettings:"ThreadMuteSettings",ThreadName:"ThreadName",JoinableMode:"JoinableMode",ApprovalMode:"ApprovalMode",ApprovalQueue:"ApprovalQueue",ClientPayload:"ClientPayload",GenieMessage:"GenieMessage",MontageMessage:"MontageMessage",RtcCallData:"RtcCallData"};e.exports=a}),null);
__d("MercurySyncFakeDFFSender",["Arbiter","ChannelConstants","MercurySingletonProvider","MercurySyncDeltaTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("ChannelConstants").getArbiterType(b("ChannelConstants").FAKE_DFF);a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$1=a}a.prototype.sendGlobalDFF=function(){b("Arbiter").inform(g,{obj:{delta:{"class":b("MercurySyncDeltaTypes").ForcedFetch},queue:this.$1}})};a.prototype.sendThreadDFF=function(a,c){b("Arbiter").inform(g,{obj:{delta:{"class":b("MercurySyncDeltaTypes").ForcedFetch,threadKey:{otherUserFbId:a,threadFbId:c}},queue:this.$1}})};a.prototype.sendMessageDFF=function(a,c,d){b("Arbiter").inform(g,{obj:{delta:{"class":b("MercurySyncDeltaTypes").ForcedFetch,threadKey:{otherUserFbId:a,threadFbId:c},messageId:d},queue:this.$1}})};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MessengerThreadCannotReplyReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({BLOCKED:"blocked",COMPOSER_DISABLED_BOT:"composer_disabled_bot",HAS_EMAIL_PARTICIPANT:"has_email_participant",OBJECT_ORIGINATED:"object_originated",READ_ONLY:"read_only",VIEWER_NOT_SUBSCRIBED:"viewer_not_subscribed",RECIPIENTS_NOT_LOADABLE:"recipients_not_loadable",RECIPIENTS_UNAVAILABLE:"recipients_unavailable",RECIPIENTS_INVALID:"recipients_invalid",RECIPIENTS_INACTIVE_WORK_ACC:"recipients_inactive_work_account",MONTAGE_NOT_AUTHOR:"montage_not_author"})}),null);
__d("MercuryThreadInfo",["MercuryIDs","MessengerThreadCannotReplyReason"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={canReply:function(a){return!!(a.is_subscribed&&(a.can_reply===undefined||a.can_reply)&&!a.has_email_participant&&!a.read_only)},getMuteSetting:function(a){return a.mute_until?a.mute_until:undefined},isEmptyLocalThread:function(a){return b("MercuryIDs").tokenize(a.thread_id).type==="root"&&!a.timestamp},isMuted:function(a){return g.getMuteSetting(a)!==undefined},areMentionsMuted:function(a){return a.mentions_mute_mode===1},areReactionsMuted:function(a){return a.reactions_mute_mode===1},isNewEmptyLocalThread:function(a){return!!(g.isEmptyLocalThread(a)&&a.participants&&a.participants.length===0)},showComposer:function(a){return!!(a.is_subscribed&&(a.can_reply||!a.cannot_reply_reason||a.cannot_reply_reason===b("MessengerThreadCannotReplyReason").BLOCKED)&&!a.has_email_participant&&!a.read_only)},isColdOpen:function(a){return!!(a.is_canonical_user&&(a.message_count===0||!a.timestamp))}};e.exports=g}),null);
__d("MessagingGenericAdminTextType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ALOHA_AUTOCONNECT_INVITED:"aloha_autoconnect_invited",ALOHA_CONTACT_ADDED:"aloha_contact_added",ALOHA_CONTACT_ADDED_TO_ALOHA_PROXY_USER:"aloha_contact_added_to_aloha_proxy_user",ALOHA_CONTACT_REMOVED:"aloha_contact_removed",ALOHA_INVITE_OWNER_ACCEPT:"aloha_invite_owner_accept",ALOHA_INVITE_OWNER_DECLINE:"aloha_invite_owner_decline",ALOHA_MEDIA_ADDED:"aloha_media_added",ALOHA_MEDIA_SENT:"aloha_media_sent",ALOHA_VISUAL_MEDIA_SENT:"aloha_visual_media_sent",ALOHA_OWNER_INVITED:"aloha_owner_invited",ALOHA_PROXY_USER_NAME_SET:"aloha_proxy_user_name_set",ALOHA_PROXY_USER_PROFILE_PHOTO_SET:"aloha_proxy_user_profile_photo_set",ALOHA_WIFI_CREDENTIALS_SET:"aloha_wifi_credentials_set",MADE_POLL_VOTE:"made_poll_vote",ALOHA_USER_JOINED_CALL_ON_ALOHA:"aloha_user_joined_call_on_aloha",ALOHA_CALL_ENDED_ON_ALOHA:"aloha_call_ended_on_aloha",GROUP_POLL:"group_poll",GENERIC_NEW_CONNECTION:"generic_new_connection",CONFIRM_FRIEND_REQUEST:"confirm_friend_request",THREAD_CUSTOMIZATION_UPSELL:"thread_customization_upsell",PHONE_CONTACT_UPLOAD:"phone_contact_upload",RELATIONSHIP_CREATED:"relationship_created",ACCEPT_PENDING_THREAD:"accept_pending_thread",RAMP_UP_WELCOME_MESSAGE:"ramp_up_welcome_message",CHANGE_THREAD_THEME:"change_thread_theme",CHANGE_THREAD_ICON:"change_thread_icon",GROUP_THREAD_CREATED:"group_thread_created",THREAD_EPHEMERAL_SEND_MODE:"thread_ephemeral_send_mode",INVITE_ACCEPTED:"invite_accepted",MESSENGER_INVITE_SENT:"messenger_invite_sent",TURN_ON_PUSH:"turn_on_push",JOURNEY_PROMPT_COLOR:"journey_prompt_color",JOURNEY_PROMPT_LIKE:"journey_prompt_like",JOURNEY_PROMPT_NICKNAME:"journey_prompt_nickname",JOURNEY_PROMPT_SETUP:"journey_prompt_setup",CHANGE_THREAD_NICKNAME:"change_thread_nickname",NOTIFY_GROUP_MAYORSHIP:"notify_group_mayorship",PROMPT_GROUP_MAYORSHIP_CUSTOMIZATION:"prompt_group_mayorship_customization",MESSAGE_COUNT_MILESTONE_MESSAGE:"message_count_milestone_message",BOT_THREAD_SUBSCRIPTION:"bot_thread_subscription",RTC_CALL_LOG:"rtc_call_log",RTC_INSTANT_VIDEO_LIFECYCLE:"rtc_instant_video_lifecycle",JOURNEY_PROMPT_BOT:"journey_prompt_bot",RIDE_ORDERED_MESSAGE:"ride_ordered_message",DESTINATION_ETA_MESSAGE:"destination_eta_message",RIDE_ARRIVED_MESSAGE:"ride_arrived_message",JOURNEY_PROMPT_NEW_SETUP:"journey_prompt_new_setup",LIGHTWEIGHT_EVENT_CREATE:"lightweight_event_create",LIGHTWEIGHT_EVENT_DELETE:"lightweight_event_delete",LIGHTWEIGHT_EVENT_NOTIFY:"lightweight_event_notify",LIGHTWEIGHT_EVENT_NOTIFY_BEFORE_EVENT:"lightweight_event_notify_before_event",LIGHTWEIGHT_EVENT_RSVP:"lightweight_event_rsvp",LIGHTWEIGHT_EVENT_UPDATE:"lightweight_event_update",LIGHTWEIGHT_EVENT_UPDATE_LOCATION:"lightweight_event_update_location",LIGHTWEIGHT_EVENT_UPDATE_TIME:"lightweight_event_update_time",LIGHTWEIGHT_EVENT_UPDATE_TITLE:"lightweight_event_update_title",SAFETY_LOCATION_REQUEST_SENT:"safety_location_request_sent",SAFETY_LOCATION_REQUEST_RESPONDED:"safety_location_request_responded",SAFETY_LOCATION_REQUEST_DENIED:"safety_location_request_denied",AD_MANAGE_MESSAGE:"ad_manage_message",AD_REPLY_MESSAGE:"ad_reply_message",TAGGED_PHOTO:"tagged_photo",GAME_SCORE:"game_score",INSTANT_GAME_UPDATE:"instant_game_update",INSTANT_GAME_BOT_INTRO:"instant_game_bot_intro",MEDIA_SUBSCRIPTION_MANAGE:"media_subscription_manage",M_AI_SURVEY:"m_ai_survey",PHONE_NUMBER_LOOKUP_NOTICE:"phone_number_lookup_notice",MESSENGER_PRECHECKED_PLUGIN:"messenger_prechecked_plugin",ADD_CONTACT:"add_contact",PRODUCT_INVOICE_RECEIPT_REJECTED:"product_invoice_receipt_rejected",PRODUCT_INVOICE_PAID:"product_invoice_paid",PRODUCT_INVOICE_VOIDED:"product_invoice_voided",PRODUCT_INVOICE_SHIPPED:"product_invoice_shipped",PRODUCT_INVOICE_PAYMENT_EXPIRED:"product_invoice_payment_expired",PRODUCT_INVOICE_RECEIPT_UPLOADED:"product_invoice_receipt_uploaded",CHANGE_JOINABLE_SETTING:"change_joinable_setting",CHANGE_THREAD_ADMINS:"change_thread_admins",CHANGE_THREAD_APPROVAL_MODE:"change_thread_approval_mode",CAPY_SESSION_BEGIN:"capy_session_begin",CAPY_SESSION_BOT_BEGIN:"capy_session_bot_begin",CAPY_SESSION_END:"capy_session_end",CAPY_AGENT_JOIN:"capy_agent_join",CAPY_AGENT_DUMPED:"capy_agent_dumped",CAPY_SESSION_WAIT_TIME:"capy_session_wait_time",GROUP_SMS_PARTICIPANT_JOINED:"group_sms_participant_joined",GROUP_SMS_PARTICIPANT_CAPPED:"group_sms_participant_capped",SMS_PHONE_NUMBER_CHECK:"sms_phone_number_check",MESSENGER_BOT_REVIEW_SENT:"messenger_bot_review_sent",MESSENGER_CODE_SCAN:"messenger_code_scan",MESSENGER_LIVECHAT_PLUGIN_OPEN:"messenger_livechat_plugin_open",MINGLE_MATCH_SUCCESS:"mingle_match_success",MINGLE_PARTICIPANT_MATCHED:"mingle_participant_matched",MN_ACCOUNT_LINKING_TEXT:"mn_account_linking_text",MN_ACCOUNT_UNLINKING_TEXT:"mn_account_unlinking_text",MN_ACCOUNT_FORCED_UNLINKING_TEXT:"mn_account_forced_unlinking_text",MN_REF_SEND_TEXT:"mn_ref_send_text",ADS_WELCOME_MSG:"ads_welcome_msg",THREAD_JOINABLE_PROMOTION_TEXT:"thread_joinable_promotion_text",PAGES_PLATFORM_REQUEST_TEXT:"pages_platform_request_text",MESSENGER_NEW_USER_GET_STARTED:"messenger_new_user_get_started",SMS_PHONE_NUMBER_TOGGLE:"sms_phone_number_toggle",PAGES_PLATFORM_CREATE_APPOINTMENT:"Pages_Platform_create_appointment",INTERNAL_CAREER_JOBSY_REACHOUT_CONNECTED:"internal_career_jobsy_reachout_connected",JOINABLE_GROUP_THREAD_CREATED:"joinable_group_thread_created",JOINABLE_ROOM_CREATED_WITH_CO_CREATORS:"joinable_room_created_with_co_creators",PAGES_PLATFORM_ACCEPT_APPOINTMENT:"pages_platform_accept_appointment",PAGES_PLATFORM_REFERRAL_CONFIRMED_APPOINTMENT:"pages_platform_referral_confirmed_appointment",PAGES_PLATFORM_DECLINE_APPOINTMENT:"pages_platform_decline_appointment",PAGES_PLATFORM_USER_CANCEL:"pages_platform_user_cancel",PAGES_PLATFORM_ADMIN_CANCEL:"pages_platform_admin_cancel",MESSENGER_OMNIM_CREATE_FLOW:"messenger_omnim_create_flow",MESSENGER_OMNIM_UPDATE_FLOW:"messenger_omnim_update_flow",MESSENGER_OMNIM_UPDATE_FLOW_STATE:"messenger_omnim_update_flow_state",MESSENGER_GROUP_DESCRITPION_UPDATE:"messenger_group_description_update",MESSENGER_EXTENSION_ADD_CART:"messenger_extension_add_cart",MESSENGER_EXTENSION_ADD_FAVORITE:"messenger_extension_add_favorite",MESSENGER_AD_CONTEXT:"messenger_ad_context",PAGES_PLATFORM_APPOINTMENT_REMINDER:"pages_platform_appointment_reminder",PAGES_PLATFORM_ADMIN_DECLINE:"pages_platform_admin_decline",POKE_RECEIVED:"poke_received",MESSENGER_STATION_SUBSCRIPTION:"messenger_station_subscription",MESSENGER_USER_ALSO_ON_MESSENGER:"messenger_user_also_on_messenger",MESSENGER_INBOX2_BIRTHDAY_BUMP:"messenger_inbox2_birthday_bump",MESSENGER_RESPOND_REMINDER_CONFIRMATION:"messenger_respond_reminder_confirmation",MESSENGER_RESPOND_REMINDER:"messenger_respond_reminder",MESSENGER_RESPOND_REMINDER_USER_CANCEL:"messenger_respond_reminder_user_cancel",MESSENGER_RESPOND_REMINDER_CANCEL_SUGGESTION:"messenger_respond_reminder_cancel_suggestion",STARTED_SHARING_VIDEO:"started_sharing_video",LIVE_VIDEO_CHAT:"live_video_chat",PARTICIPANT_JOINED_GROUP_CALL:"participant_joined_group_call",MESSENGER_ONLY_PHONE_JOINED_WITH_NEW_ACCOUNT:"messenger_only_phone_joined_with_new_account",PAGES_COMMERCE_PAYMENT_ENABLED:"pages_commerce_payment_enabled",GROUP_PAYMENT_REQUEST:"group_payment_request",P2P_CALL_ESCALATED_TO_GROUP_CALL:"p2p_call_escalated_to_group_call",INVITED_TO_ESCALATED_P2P_CALL:"invited_to_escalated_p2p_call",EVENT_UPCOMING:"event_upcoming",PAGES_VISITOR_POST_SEND_MESSAGE_UPSELL:"pages_visitor_post_send_message_upsell",PAGES_LOW_MESSAGE_RESPONSE_RATE:"pages_low_message_response_rate",PAGES_START_CALL:"pages_start_call",PARTIES_INVITE:"parties_invite",PAGES_JOIN_LOYALTY_PROGRAM:"pages_join_loyalty_program",WORK_INVITE_CLAIMED:"work_invite_claimed",P2P_PAYMENT_REQUEST_REMINDER:"p2p_payment_request_reminder",PHOTO_TAG_BUMP:"photo_tag_bump",MESSENGER_CALL_UPGRADE_LEGACY_CLIENT:"messenger_call_upgrade_legacy_client",DIRECTED_WALL_POST:"directed_wall_post",MESSENGER_CALL_LOG:"messenger_call_log",P2P_PAYMENT_MONEY_RAIN_GAME_ENTRY_POINT:"p2p_payment_money_rain_game_entry_point",MESSENGER_MONTAGE_MENTIONS:"messenger_montage_mentions",PAGES_MESSAGING_BLOCK_WORDS:"pages_messaging_block_words",ALOHA_CALL_INVITE:"aloha_call_invite",SHIPPO_TRACKING_UPDATES:"shippo_tracking_updates",NEO_APPROVED_CONNECTION_ADDED:"neo_approved_connection_added",CHANGE_FAVORITE_COLOR:"change_favorite_color",MARKETPLACE_ITEM_CHANGED:"marketplace_item_changed",SERVICES_VERTICAL_REDEEMED_REFERRAL:"services_vertical_redeemed_referral",SERVICES_VERTICAL_OPT_OUT_REQUESTS:"services_vertical_opt_out_requests",SERVICES_VERTICAL_OPT_OUT_REQUESTS_SUCCESS:"services_vertical_opt_out_requests_success",SERVICES_VERTICAL_LEAD_GEN_SURVEY:"services_vertical_lead_gen_survey",SERVICES_VERTICAL_LEAD_GEN_SURVEY_EDIT:"services_vertical_lead_gen_survey_edit",PAGES_MARK_AS_PAID:"pages_mark_as_paid",MIGRATED_TO_WORKPLACE:"migrated_to_workplace",MESSENGER_GROUP_EVENT_STATUS_UPDATE:"messenger_group_event_status_update",NEO_APPROVED_USER_REMOVED_FROM_GROUP:"neo_approved_user_removed_from_group",LIVE_CHAT_SUPPORT_AGENT_JOIN:"live_chat_support_agent_join",LIVE_CHAT_SUPPORT_SESSION_BEGIN:"live_chat_support_session_begin",LIVE_CHAT_SUPPORT_SESSION_END:"live_chat_support_session_end",MONTAGE_DIRECT_KEEP:"montage_direct_keep",MONTAGE_DIRECT_EXPIRE:"montage_direct_expire",CHSBOT_CONVERSATION_ENDED:"chsbot_conversation_ended",CHSBOT_LIVE_CHAT_SUPPORT_AGENT_BEGIN:"chsbot_live_chat_support_agent_begin",CHSBOT_LIVE_CHAT_SUPPORT_AGENT_END:"chsbot_live_chat_support_agent_end",CHSBOT_LIVE_PHONE_SUPPORT_AGENT_CALLING:"chsbot_live_phone_support_agent_calling",CHSBOT_SUPPORT_REQUESTED:"chsbot_support_requested",MESSENGER_SUBSCRIBE_TO_UPDATES:"messenger_subscribe_to_updates",MESSENGER_UNSUBSCRIBE_FROM_UPDATES:"messenger_unsubscribe_from_updates",MESSENGER_BLOCK_MESSAGES:"messenger_block_messages",MESSENGER_UNBLOCK_MESSAGES:"messenger_unblock_messages",MESSENGER_TURN_ON_MESSAGES:"messenger_turn_on_messages",MESSENGER_TURN_OFF_MESSAGES:"messenger_turn_off_messages",THANKS_FOR_SHARING_MESSAGE_CONTEXT:"thanks_for_sharing_message_context",GROUP_ADMIN_MODEL_NUX:"group_admin_model_nux",MESSENGER_PAYMENT_INCENTIVE_INFO:"messenger_payment_incentive_info",MESSENGER_PLATFORM_PERSONA:"messenger_platform_persona",MESSENGER_GROUP_SYNC_OPT_IN:"messenger_group_sync_opt_in",MESSENGER_GROUP_SYNC_OPT_OUT:"messenger_group_sync_opt_out",MENTORSHIP_MATCH:"mentorship_match",PAGES_CALL_DEFLECTION_UPSELL:"pages_call_deflection_upsell",RTC_PHOTOBOOTH:"rtc_photobooth",DELAYED_PHONE_NUMBER_MATCH:"delayed_phone_number_match",AUTOMATIC_TRANSLATION_ENABLED:"automatic_translation_enabled",AUTOMATIC_TRANSLATION_DISABLED:"automatic_translation_disabled",MESSENGER_ROOM_MIGRATION:"messenger_room_migration"})}),null);
__d("MessagingGiftWrapChecker",["MercuryConfig","MercuryTagHelper","MessagingGiftWrapConstants"],(function(a,b,c,d,e,f){"use strict";a={shouldRenderWithGiftWrap:function(a){return!!(a.tags&&g(a.tags)&&!h(a.tags))}};function g(a){return b("MercuryTagHelper").get(a,b("MessagingGiftWrapConstants").TAG_PREFIX)===b("MessagingGiftWrapConstants").VALENTINES_GIFT}function h(a){return!!b("MercuryTagHelper").get(a,b("MessagingGiftWrapConstants").UNWRAPPED_TAG)}e.exports=a}),null);
__d("MessengerGroupsSyncStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PENDING_OPT_IN:"PENDING_OPT_IN",OPT_IN:"OPT_IN",PENDING_OPT_OUT:"PENDING_OPT_OUT",OPT_OUT:"OPT_OUT",UNSET:"UNSET",UNSUPPORTED:"UNSUPPORTED"})}),null);
__d("XGroupsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groups/{idorvanity}/{?view}/{?post_id}/",{idorvanity:{type:"String",required:!0},view:{type:"Enum",enumType:1},post_id:{type:"Int"},rule_id:{type:"Int"},ref:{type:"String"},source_id:{type:"String"},notif_t:{type:"String"},nux:{type:"Enum",enumType:1},tip_id:{type:"Int"},member_tag_id:{type:"FBID"},inner_tab:{type:"String"},section:{type:"Enum",enumType:1},thread_id:{type:"String"},autopopup_create_chat_dialog:{type:"Bool",defaultValue:!1},sorting_setting:{type:"String"},multi_events:{type:"String"},stories:{type:"Exists",defaultValue:!1},queue:{type:"Enum",enumType:1},composer_prefill:{type:"String"},hide_workplace_pagelet:{type:"Bool",defaultValue:!1},permalink_add_comment_nux_shown:{type:"Bool",defaultValue:!1},comment_id:{type:"Int"},reply_comment_id:{type:"Int"}})}),null);
__d("MercuryThreads",["invariant","ChatReliabilityInstrumentation","EventEmitter","EventReminderConstants","MercuryDisplayTimeFilterMessageRenderer","ImmutableObject","KeyedCallbackManager","LogHistory","MercuryActionType","MercuryAssert","MercuryAttachment","MercuryDispatcher","MercuryGiftSnippetRenderer","MercuryGlobalActionType","MercuryIDs","MercuryLocalIDs","MercuryLoggingHelper","MercuryLogMessageType","MercuryParticipants","MercuryPayloadSource","MercuryServerRequests","MercurySingletonProvider","MercurySyncFakeDFFSender","MercuryThreadInfo","MercuryThreadInformer","MessagingGenericAdminTextType","MessagingGiftWrapChecker","MessagingTag","PageCommItemStatus","MessengerGroupsSyncStatus","XGroupsController","URI","emptyFunction","ifRequired","requireWeak","setImmediate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("EventReminderConstants").GuestStates,i=new(b("EventEmitter"))(),j=b("LogHistory").getInstance("mercury_threads"),k=new Set();function a(a){this.$1=a,this.$2=b("MercuryServerRequests").getForFBID(this.$1),this.$3=b("MercuryThreadInformer").getForFBID(this.$1),this.$4=b("MercuryIDs").getParticipantIDFromUserID(this.$1),this.$5=b("MercuryDispatcher").getForFBID(this.$1),this.$6=b("MercurySyncFakeDFFSender").getForFBID(this.$1),this.$7=!1,this.$8=new(b("KeyedCallbackManager"))(),this.$9=new Set(),this.$10=!1,this.$11=new Set(),this.$12=new Set(),this.$13()}a.getForFBID=function(a){return l.getForFBID(a)};a.get=function(){return l.get()};a.prototype.getThreadMetaNow=function(a){b("MercuryAssert").isThreadID(a);var c=this.$8.getResource(a);if(c&&!c.participants){b("ChatReliabilityInstrumentation").logERROR("participants are null!",{thread_id:a});this.$6.sendThreadDFF(null,a);return new(b("ImmutableObject"))(babelHelpers["extends"]({},c,{participants:[]}))}return c};a.prototype.getOrFetch=function(a){var b=this.getThreadMetaNow(a);!b&&!this.$12.has(a)&&this.$11.add(a);this.$11.size>0&&!this.$10&&this.$14();return b};a.prototype.$14=function(){if(this.$10)return;this.$10=!0;b("setImmediate")(function(){this.$10=!1,this.$11.forEach(function(a){return this.$12.add(a)}.bind(this)),this.getMultiThreadMeta(Array.from(this.$11),function(a){for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&this.$12["delete"](b)}.bind(this)),this.$11.clear()}.bind(this))};a.prototype.getThreadMeta=function(a,b,c){return this.getMultiThreadMeta([a],function(c){return b(c[a])},c)};a.prototype.getMultiThreadMeta=function(a,c,d){__p&&__p();b("MercuryAssert").allThreadID(a);a=this.$8.executeOrEnqueue(a,c);c=this.$8.getUnavailableResources(a);if(c.length){var e=[];for(var f=0;f<c.length;f++){var g=c[f],h=b("MercuryIDs").tokenize(g),i=h.type;h=h.value;if(i=="user"){i=b("MercuryIDs").getParticipantIDFromUserID(h);this.createNewLocalThread(g,i===this.$4?[this.$4]:[this.$4,i])}e.push(g)}e.length&&this.$2.fetchThreadData(e,d)}return a};a.addListener=function(a,b){return i.addListener(a,b)};a.prototype.unsubscribe=function(a){this.$8.unsubscribe(a)};a.prototype.getCanonicalThreadToParticipant=function(a,c,d,e){var f=b("MercuryIDs").getThreadIDFromParticipantID(a);!f&&g(0);var h=this.$8.getResource(f);h==undefined&&(h=this.createNewLocalThread(f,this.$4===a?[this.$4]:[this.$4,a],c),e||this.$2.fetchThreadData([f],d));return h};a.prototype.createNewLocalThread=function(a,c,d){var e=this.$8.getResource(a);if(!e){var f=b("MercuryIDs").tokenize(a),g=f.type;f=f.value;e=new(b("ImmutableObject"))({thread_id:a,participants:Array.from(c),admin_ids:[],name:"",snippet:"",snippet_sender:null,unread_count:d?d:0,message_count:0,image_src:null,timestamp:null,other_user_fbid:g==="user"?f:null,is_canonical_user:g=="user",is_canonical:this.$15(c),is_subscribed:!0,folder:b("MessagingTag").INBOX,is_archived:!1,is_page_follow_up:!1});this.$8.setResource(a,e)}return e};a.prototype.createNewLocalThreadGenerateID=function(){var a=b("MercuryLocalIDs").generateThreadID();this.createNewLocalThread(a,[]);return a};a.prototype.isEmptyLocalThread=function(a){a=this.$8.getResource(a);return!a?!1:b("MercuryThreadInfo").isEmptyLocalThread(a)};a.prototype.isNewEmptyLocalThread=function(a){a=this.$8.getResource(a);return!a?!1:b("MercuryThreadInfo").isNewEmptyLocalThread(a)};a.prototype.$16=function(a,c){__p&&__p();if(!a||!a.length)return;var d=new Map(),e=new Map(),f=new Map(),h=[];for(var i=0;i<a.length;i++){var l=a[i],m=l.action_type;if(m==b("MercuryActionType").LOG_MESSAGE&&l.log_message_type==b("MercuryLogMessageType").SERVER_ERROR)continue;var n=!c&&!!(l.thread_fbid||l.other_user_fbid||l.is_from_iris),o=l.thread_id;b("MercuryAssert").isThreadID(o);var p=this.$8.getResource(o);if(!p&&!n&&m===b("MercuryActionType").USER_GENERATED_MESSAGE){p=this.$17(l);if(!p.participants||!p.participants.length){j.debug("missing_local_participants",JSON.stringify(b("MercuryLoggingHelper").obfuscateMessage(l)));b("ChatReliabilityInstrumentation").logERROR("missing_local_participants",{thread_id:o});p=new(b("ImmutableObject"))(babelHelpers["extends"]({},p,{participants:[]}));var q=l.other_user_fbid,r=l.thread_fbid;if(q||r)this.$6.sendThreadDFF(q,r);else continue}this.$8.setResource(o,p)}if(!p)continue;(m==b("MercuryActionType").LOG_MESSAGE||m==b("MercuryActionType").USER_GENERATED_MESSAGE)&&(n=!c);if(p.server_timestamp&&l.timestamp<p.server_timestamp&&n)continue;if(p.server_timestamp&&m===b("MercuryActionType").USER_GENERATED_MESSAGE&&l.offline_threading_id&&l.author!==b("MercuryIDs").getParticipantIDFromUserID(this.$1))if(k.has(l.offline_threading_id))continue;else k.add(l.offline_threading_id);!f.has(o)?f.set(o,babelHelpers["extends"]({},p)):j.error("skipping thread metadata update",JSON.stringify({have:f.get(o),skipped:p}));q=f.get(o);!q&&g(0);this.$18(q,l,c);r=d.get(o);m==b("MercuryActionType").USER_GENERATED_MESSAGE&&(!r||l.timestamp>r.timestamp)&&d.set(o,l);(m==b("MercuryActionType").USER_GENERATED_MESSAGE||m==b("MercuryActionType").LOG_MESSAGE)&&(l&&l.timestamp&&(!e.has(o)||l.timestamp>e.get(o).timestamp)&&e.set(o,l))}f.forEach(function(f,g){__p&&__p();var i=e.get(g),k=d.get(g);if(k)this.$19(f,k);else if(i&&i.log_message_body){k=babelHelpers["extends"]({},i,{body:i.log_message_body});this.$19(f,k)}k=f.timestamp;if(i&&!i.skip_bump_thread){i.timestamp>k&&Object.assign(f,{timestamp:i.timestamp});k=f.server_timestamp;!c&&i.timestamp>k&&(f.server_timestamp=i.timestamp)}k=new(b("ImmutableObject"))(f);if((!k.participants||!k.participants.length)&&!this.isEmptyLocalThread(k.thread_id)){i=(a||[]).map(b("MercuryLoggingHelper").obfuscateMessage);f={update:b("MercuryLoggingHelper").obfuscateThread(k),actions:i};j.error("bad metadata update no_participants",JSON.stringify(f));b("ChatReliabilityInstrumentation").logERROR("refusing to set thread metadata with no participants",f);return}this.$8.setResource(g,k);h.push(b("MercuryLoggingHelper").obfuscateThread(k))}.bind(this),this);h.length&&this.$7&&j.debug("threads_updated",JSON.stringify({threads:h}))};a.prototype.$18=function(a,c,d){__p&&__p();var e=c.action_type;(e==b("MercuryActionType").USER_GENERATED_MESSAGE||e==b("MercuryActionType").LOG_MESSAGE)&&((c.is_unread||c.skip_bump_thread)&&(a.unread_count===0&&c.skip_bump_thread||c.timestamp>a.server_timestamp&&a.unread_count++),a.message_count++,a.is_archived=!1);switch(e){case b("MercuryActionType").DELETE_THREAD:a.message_count=0;this.$20(c.thread_id);break;case b("MercuryActionType").USER_GENERATED_MESSAGE:a.unread_count===0&&c.author===this.$4&&c.timestamp>=a.last_read_timestamp&&(a.last_read_timestamp=c.timestamp);c.offline_threading_id!==c.message_id&&(a.last_message_timestamp=c.timestamp,c.comm_status!=null&&(a.last_message_id=c.message_id));c.comm_status!=null&&(a.comm_status&&a.comm_status.toUpperCase()!==b("PageCommItemStatus").FOLLOW_UP&&(a.comm_status=c.comm_status));c.creator_info&&c.creator_info.pageID===this.$1&&(a.folder=c.folder);this.$21(a,c.author);break;case b("MercuryActionType").SEND_MESSAGE:e=c.log_message_type;e==b("MercuryLogMessageType").THREAD_IMAGE&&(a.image_src=c.log_message_data.image?c.log_message_data.image.preview_url:null,this.$22(c.thread_id));e!==b("MercuryLogMessageType").SUBSCRIBE&&e!==b("MercuryLogMessageType").UNSUBSCRIBE&&(a.snippet_attachments=c.attachments);break;case b("MercuryActionType").LOG_MESSAGE:e=c.log_message_type;e==b("MercuryLogMessageType").SUBSCRIBE&&!d?(this.$23(a,c.log_message_data.added_participants),this.$22(c.thread_id)):e==b("MercuryLogMessageType").UNSUBSCRIBE&&!d?(this.$24(a,c.log_message_data.removed_participants),this.$22(c.thread_id)):e==b("MercuryLogMessageType").THREAD_IMAGE?d||(a.image_src=c.log_message_data.image?c.log_message_data.image.preview_url:null):e==b("MercuryLogMessageType").THREAD_NAME?(a.name!==c.log_message_data.name&&this.$22(c.thread_id),a.name=c.log_message_data.name):e===b("MercuryLogMessageType").GENERIC_ADMIN_TEXT&&this.$25(a,c);break;case b("MercuryActionType").CHANGE_READ_STATUS:e=this.$26(a,c,c.mark_as_read);e&&(a.last_read_timestamp=a.last_message_timestamp);var f=!a.read_only&&a.folder===b("MessagingTag").INBOX;e&&d&&this.$2.changeThreadReadStatus(a.thread_id,c.mark_as_read,c.source,a.last_read_timestamp,f,a.last_message_type);break;case b("MercuryActionType").CHANGE_ARCHIVED_STATUS:a.is_archived!=c.archived&&(a.is_archived=c.archived,a.comm_status!=null&&(a.comm_status=c.archived?b("PageCommItemStatus").DONE:b("PageCommItemStatus").TODO),this.$22(c.thread_id));break;case b("MercuryActionType").CHANGE_PAGE_FOLLOW_UP_STATUS:a.is_page_follow_up!=c.is_page_follow_up&&(a.is_page_follow_up=c.is_page_follow_up,this.$22(c.thread_id));break;case b("MercuryActionType").CHANGE_FOLDER:a.folder!=c.new_folder&&(a.folder=c.new_folder,a.comm_status!=null&&(c.new_folder===b("MessagingTag").OTHER?a.comm_status=b("PageCommItemStatus").SPAM:c.new_folder===b("MessagingTag").INBOX&&(a.comm_status=b("PageCommItemStatus").TODO)),this.$22(c.thread_id));break;case b("MercuryActionType").DELETE_MESSAGES:d?(a.snippet="...",a.snippet_attachments=null,a.snippet_sender=null,this.$22(c.thread_id)):c.message_ids&&(a.message_count-=c.message_ids.length,b("ifRequired")("MercuryMessages",function(b){__p&&__p();b=b.getForFBID(this.$1);for(var d=c.message_ids,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;g=b.getMessagesFromIDs([g]);g=g[0];g&&g.timestamp>a.last_read_timestamp&&(a.unread_count=Math.max(0,a.unread_count-1))}this.$22(c.thread_id)}.bind(this),b("emptyFunction")));break;case b("MercuryActionType").UPDATE_SNIPPET:b("ifRequired")("MercuryMessages",function(d){d=d.getForFBID(this.$1);var e=0,f=1,g=d.getThreadMessagesRangeNow(c.thread_id,e,f);g=g[0];g?(a.snippet=g.body,a.snippet_attachments=g.attachments,a.snippet_sender=g.author):(a.snippet="...",a.snippet_attachments=null,a.snippet_sender=null,d.getThreadMessagesRange(c.thread_id,e,f,function(a){a.length&&this.$5.handleUpdate({from_client:!0,actions:[{thread_id:c.thread_id,action_type:b("MercuryActionType").UPDATE_SNIPPET,deleted_ids:c.deleted_ids}]})}.bind(this)));this.$22(c.thread_id)}.bind(this),b("emptyFunction"));break;case b("MercuryActionType").CHANGE_MUTE_SETTINGS:Object.prototype.hasOwnProperty.call(c,"reactions_mute_mode")?a.reactions_mute_mode=c.reactions_mute_mode:Object.prototype.hasOwnProperty.call(c,"mentions_mute_mode")?a.mentions_mute_mode=c.mentions_mute_mode:a.mute_until=c.mute_until?c.mute_until:undefined;this.$22(a.thread_id);break;case b("MercuryActionType").BLOCK_STATUS_CHANGED:a.can_reply=c.canViewerReply;this.$22(a.thread_id);break;case b("MercuryActionType").ADD_PARTICIPANTS:this.$23(a,c.participants);this.$22(a.thread_id);break;case b("MercuryActionType").CHANGE_FLAG:this.$27(a,c.mark_as_flag);this.$22(a.thread_id);break;case b("MercuryActionType").MOVE_PENDING_TO_INBOX:this.$28(a);this.$22(a.thread_id);break;case b("MercuryActionType").UPDATE_CUSTOM_LIKE:a.custom_like_icon=c.custom_like;this.$22(a.thread_id);break;case b("MercuryActionType").ADD_GROUP_ADMINS:a.admin_ids=a.admin_ids.concat(c.added_admin_ids.filter(function(b){return a.admin_ids.indexOf(b)===-1}));this.$22(c.thread_id);break;case b("MercuryActionType").REMOVE_GROUP_ADMINS:a.admin_ids=a.admin_ids.filter(function(a){return c.removed_admin_ids.indexOf(a)===-1});this.$22(c.thread_id);break;case b("MercuryActionType").JOINABLE_MODE:a.joinable_mode=c.joinable_mode;this.$22(c.thread_id);break;case b("MercuryActionType").APPROVAL_MODE:a.approval_mode=c.approval_mode;this.$22(c.thread_id);break;case b("MercuryActionType").APPROVAL_QUEUE:c.added_id&&a.approval_queue_ids&&a.approval_queue_ids.indexOf(c.added_id)===-1&&(a.approval_queue_ids=a.approval_queue_ids.concat(c.added_id));c.removed_id&&a.approval_queue_ids&&(a.approval_queue_ids=a.approval_queue_ids.filter(function(a){return c.removed_id!==a}));c.added_group_id&&a.group_approval_queue&&!a.group_approval_queue.find(function(a){c.added_group_id.requester.id===a.requesterId})&&(a.group_approval_queue=a.group_approval_queue.concat([c.added_group_id]));c.removed_group_id&&a.group_approval_queue&&(a.group_approval_queue=a.group_approval_queue.filter(function(a){return c.removed_group_id!==a.requester.id}));this.$22(c.thread_id);break;case b("MercuryActionType").IS_PIN_PROTECTED:a.is_pin_protected=c.is_pin_protected;this.$22(c.thread_id);break;case b("MercuryActionType").UPDATE_RTC_CALL_DATA:e=c.initiator_fbid||(a.rtc_call_data?a.rtc_call_data.initiator_fbid:undefined);a.rtc_call_data=new(b("ImmutableObject"))({call_state:c.call_state,server_info_data:c.server_info_data,initiator_fbid:e});this.$22(c.thread_id);break;case b("MercuryActionType").UPDATE_COMM_STATUS:this.$29(a,c.comm_status);this.$22(a.thread_id);break;case b("MercuryActionType").UPDATE_COMM_ITEM_OWNER:void 0;c.id===null?f={nodes:[]}:f={nodes:[{admin:{id:c.id,name:c.name,profile_picture:{uri:c.profile_pic_uri}}}]};a.comm_item_owners=f;this.$22(a.thread_id);break;case b("MercuryActionType").EVENT_RSVP_CHANGED:d=a.participants_event_status.filter(function(a){return a.participant_id!==c.actor_fbid});d.push({participant_id:c.actor_fbid.toString(),event_status:c.rsvp_status});a.participants_event_status=d;this.$22(c.thread_id);break;case b("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED:a.groups_sync_status=c.groups_sync_status_string;c.groups_sync_action!=b("MessengerGroupsSyncStatus").OPT_IN&&(a.groups_sync_fb_url=null);this.$22(c.thread_id);break;case b("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE:if(c.groups_sync_action===b("MessengerGroupsSyncStatus").OPT_IN){e=new(b("URI"))(document.URL);f=b("XGroupsController").getURIBuilder().setString("idorvanity",c.fb_group_id).getURI().setDomain(e.getDomain().replace("messenger.com","facebook.com")).setPort(e.getPort()).setProtocol("https");a.groups_sync_fb_url=f.toString()}else a.groups_sync_fb_url=null;this.$22(c.thread_id);break}};a.prototype.$25=function(a,c){__p&&__p();var d=this;c.log_message_data&&c.log_message_data.untypedData&&(function(){__p&&__p();var e=c.log_message_data.untypedData,event=a.lightweight_event;switch(c.log_message_data.message_type){case b("MessagingGenericAdminTextType").THREAD_EPHEMERAL_SEND_MODE:var f=parseInt(e.ttl,10);f!==null&&a.ephemeral_ttl_mode!==f&&(a.ephemeral_ttl_mode=f,d.$22(c.thread_id));break;case b("MessagingGenericAdminTextType").CHANGE_THREAD_NICKNAME:f={};for(var g in a.custom_nickname){if(g==e.participant_id&&e.nickname.trim().length==0)continue;f[g]=a.custom_nickname[g]}e.nickname.trim().length>0&&(f[e.participant_id]=e.nickname);a.custom_nickname=f;d.$22(c.thread_id);break;case b("MessagingGenericAdminTextType").CHANGE_THREAD_ICON:b("requireWeak")("MercuryThreadActions",function(a){a.getForFBID(this.$1).updateCustomLike(c.thread_id,e.thread_icon)}.bind(d));break;case b("MessagingGenericAdminTextType").CHANGE_THREAD_THEME:f=e.theme_color;f&&f.length>0?a.custom_color="#".concat(f.substring(2)):a.custom_color=null;d.$22(c.thread_id);break;case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_CREATE:var i={};a.participants.map(function(a){a=b("MercuryIDs").getUserIDFromParticipantID(a);a&&(i[a]=a===e.event_creator_id?h.GOING:h.INVITED)},d);a.lightweight_event={track_rsvp:e.event_track_rsvp,title:e.event_title,event_time:parseInt(e.event_time,10),location_name:e.event_location_name,event_members:i,oid:e.event_id,event_type:e.event_type};d.$22(c.thread_id);break;case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TIME:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TITLE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_LOCATION:event&&(a.lightweight_event=d.$30(e,event,event.event_members));d.$22(c.thread_id);break;case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_RSVP:if(event&&event.event_members){f=d.$31(event.event_members,e);a.lightweight_event=d.$30(e,event,f)}d.$22(c.thread_id);break;case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_DELETE:case b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_NOTIFY:a.lightweight_event=null;d.$22(c.thread_id);break}})()};a.prototype.$31=function(a,b){var c={};for(var d in a)c[d]=a[d];c[b.guest_id]=b.guest_status;return c};a.prototype.$30=function(a,event,b){return{track_rsvp:event.track_rsvp,title:a.event_title===undefined?event.title:a.event_title,event_time:a.event_time===undefined?event.event_time:parseInt(a.event_time,10),location_name:a.event_location_name===undefined?event.location_name:a.event_location_name,event_members:b===undefined?event.event_members:b,oid:event.oid,event_type:event.event_type}};a.prototype.$17=function(a){var c=b("MercuryIDs").tokenize(a.thread_id),d=c.type;c=c.value;d=d==="user";var e=d||a.specific_to_list&&this.$15(a.specific_to_list),f=e||d?this.$32(a):a.specific_to_list;return new(b("ImmutableObject"))({thread_id:a.thread_id,participants:f,name:null,snippet:a.body,snippet_attachments:[],snippet_sender:a.author,unread_count:0,message_count:0,image_src:null,timestamp:a.timestamp,other_user_fbid:d?c:null,is_canonical_user:d,is_canonical:e,is_subscribed:!0,folder:b("MessagingTag").INBOX,is_archived:!1,is_page_follow_up:!1})};a.prototype.$26=function(a,b,c){__p&&__p();b.timestamp&&this.$33(a.thread_id,c,b.timestamp);if(!a||!a.thread_id||!a.participants)return!1;if(!a.timestamp){this.$9.add(a.thread_id);return!1}b=!a.unread_count;if(c==b)return!1;a.unread_count=c?0:1;this.$22(a.thread_id);return!0};a.prototype.$34=function(a){var c=this.$8.getAllResources();for(var d in c)if(Object.prototype.hasOwnProperty.call(c,d)){var e=c[d];e.folder==a&&(this.$8.setResource(d,b("ImmutableObject").setProperty(e,"unread_count",0)),this.$22(d))}};a.prototype.$23=function(a,b){var c=new Set(a.participants);a.participants=Array.from(a.participants||[]);b.forEach(function(b){c.has(b)||(a.participants.push(b),b===this.$4&&(a.is_subscribed=!0,a.can_reply=!0,a.cannot_reply_reason=null,this.$6.sendThreadDFF(undefined,a.thread_fbid)))}.bind(this))};a.prototype.$24=function(a,c){var d=new Set(c);a&&!a.participants?b("ChatReliabilityInstrumentation").logERROR("participants are null in thread_info!",{thread_info:a}):a.participants=a.participants.filter(function(a){return!d.has(a)});a&&!a.admin_ids?b("ChatReliabilityInstrumentation").logERROR("admin_ids are null in thread_info!",{thread_info:a}):a.admin_ids=a.admin_ids.filter(function(a){return!d.has(a)});d.has(this.$4)&&(a.is_subscribed=!1);this.$2.fetchThreadData([a.thread_id])};a.prototype.$21=function(a,b){if(!a.participants){var c=JSON.stringify({thread_info:a,participant:b});j.error("missing_participants",c);return}c=a.participants.indexOf(b);c>0&&(a.participants=[b].concat(a.participants.slice(0,c),a.participants.slice(c+1)))};a.prototype.$19=function(a,c){__p&&__p();var d=c.body,e=c.subject,f="";e?(e=e.toLowerCase(),d.slice(0,e.length).toLowerCase()==e?f=d:d?f=e+" \xb7 "+d:f=e):f=d;c.is_filtered_content&&(f=b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(c));if(b("MessagingGiftWrapChecker").shouldRenderWithGiftWrap(c)){e=c.author;d=e==this.$4;var g=null;if(!d){g=a.custom_nickname&&a.custom_nickname[b("MercuryIDs").getUserIDFromParticipantID(e)];if(!g){e=b("MercuryParticipants").getNow(e);e!=null&&(g=e.short_name)}}f=b("MercuryGiftSnippetRenderer").renderText(d,g)}a.snippet=f;if(c.raw_attachments&&c.raw_attachments.length>0){e=b("MercuryAttachment").convertRaw(c.raw_attachments);a.snippet_attachments=e}else a.snippet_attachments=c.attachments;c.log_message_type?a.snippet_sender=null:a.snippet_sender=c.author};a.prototype.$27=function(a,b){a.page_thread_info=babelHelpers["extends"]({},a.page_thread_info,{flagged:b})};a.prototype.$29=function(a,b){a.comm_status=b};a.prototype.$28=function(a){if(a.folder!==b("MessagingTag").PENDING)return;a.folder=b("MessagingTag").INBOX};a.prototype.$15=function(a){return a.filter(function(a){return a!=this.$4}.bind(this)).length<=1};a.prototype.$13=function(){__p&&__p();this.$5.subscribe("invalidate-thread-state",function(a,b){return this.$35(b)}.bind(this)),this.$5.subscribe("invalidate-global-state",function(a,b){return this.$36()}.bind(this)),this.$5.subscribe("update-threads",function(a,c){__p&&__p();a=(c.actions||[]).filter(function(a){return a.thread_id});c.threads&&c.payload_source==b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO&&c.threads.forEach(function(a){var b=a.thread_id;this.$9.has(b)&&(this.$9["delete"](b),a.unread_count&&this.$2.changeThreadReadStatus(a.thread_id,!0))}.bind(this));this.$37(c.threads);this.$16(a,c.from_client);c.threads&&c.threads.forEach(function(a){this.$22(a.thread_id)}.bind(this));c.global_actions&&c.global_actions.forEach(function(a){a.action_type==b("MercuryGlobalActionType").MARK_ALL_READ&&this.$34(a.folder)}.bind(this));this.$7&&(this.$7=!1,i.emit("change"))}.bind(this))};a.prototype.$37=function(a){if(!a||!a.length)return;var c={},d=[];a.forEach(function(a){var e=new(b("ImmutableObject"))(a);c[a.thread_id]=e;d.push(b("MercuryLoggingHelper").obfuscateThread(e))});d.length&&j.debug("threads_added",JSON.stringify({threads:d}));this.$8.addResourcesAndExecute(c)};a.prototype.$22=function(a){this.$7=!0,this.$3.updatedThread(a)};a.prototype.$20=function(a){this.$7=!0,this.$3.deletedThread(a)};a.prototype.$33=function(a,b,c){this.$7=!0,this.$3.changedThreadReadState(a,b,c)};a.prototype.$35=function(a){this.$8.setResource(a,undefined)};a.prototype.$36=function(){this.$7=!1,this.$8=new(b("KeyedCallbackManager"))(),this.$9=new Set(),this.$10=!1,this.$11=new Set(),this.$12=new Set()};a.prototype.$32=function(a){if(a.specific_to_list)return a.specific_to_list;a=b("MercuryIDs").tokenize(a.thread_id);var c=a.type;a=a.value;return!a||c!=="user"?[this.$4]:[b("MercuryIDs").getParticipantIDFromUserID(a),this.$4]};var l=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryServerSendMessageQueueSimulatedError",["AsyncRequest","AsyncResponse"],(function(a,b,c,d,e,f){var g=9999;a={create:function(a){a=new(b("AsyncRequest"))(this.endpoint_uri).setData({message_batch:[a],client:this.client});var c=new(b("AsyncResponse"))(a,{});Object.assign(c,{error:g,silentError:!1,transientError:!0,request:a});return c}};e.exports=a}),null);
__d("MNCommerceBubbleType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FB_RETAIL_RECEIPT:1,FB_RETAIL_CANCELLATION:2,FB_RETAIL_SHIPMENT:3,FB_RETAIL_SHIPMENT_TRACKING_EVENT_ETA:4,FB_RETAIL_SHIPMENT_TRACKING_EVENT_IN_TRANSIT:5,FB_RETAIL_SHIPMENT_TRACKING_EVENT_OUT_FOR_DELIVERY:6,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELAYED:7,FB_RETAIL_SHIPMENT_TRACKING_EVENT_DELIVERED:8,FB_RETAIL_SHIPMENT_FOR_UNSUPPORTED_CARRIER:9,FB_RETAIL_SHIPMENT_ETA:10,FB_RETAIL_NOW_IN_STOCK:11,FB_RETAIL_AGENT_ITEM_SUGGESTION:12,FB_RETAIL_AGENT_ITEM_RECEIPT:13,FB_RETAIL_PROMOTIONAL_MSG:14})}),null);
__d("MNCommerceCallToActionType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPEN_NATIVE:1,OPEN_URL:2,OPEN_CANCEL_RIDE_MUTATION:3,POSTBACK:4,ACCOUNT_LINK:5,MANAGE_MESSAGES:6,SHARE:7,PAYMENT:8,FACEBOOK_REPORT_A_PROBLEM:9,SUBSCRIPTION_PRESELECT:10,NAVIGATION:11,EXTENSIBLE_SHARE:12,OPEN_REACT_NATIVE_MINI_APP:13,OPEN_PAGE_ABOUT:14,OPEN_BRANDED_CAMERA:15,OPEN_THREAD:16})}),null);
__d("P2PPaymentRequestStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({INITED:1,DECLINED:2,TRANSFER_INITED:3,TRANSFER_COMPLETED:4,TRANSFER_FAILED:5,CANCELED:6,EXPIRED:7})}),null);
__d("P2PTransferStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PENDING_SENDER_MANUAL_REVIEW:1,PENDING_SENDER_VERIFICATION:2,CANCELED_SENDER_RISK:3,PENDING_RECIPIENT_NUX:4,CANCELED_DECLINED:5,PENDING_RECIPIENT_VERIFICATION:6,PENDING_RECIPIENT_MANUAL_REVIEW:7,PENDING_RECIPIENT_PROCESSING:8,PENDING_PUSH_FAIL:9,CANCELED_RECIPIENT_RISK:10,CANCELED_SYSTEM_FAIL:11,CANCELED_EXPIRED:12,COMPLETED:13,INTERMEDIATE_PROCESSING:14,PENDING_SENDER_INITED:15,CANCELED_SAME_CARD:16,PENDING_SENDER_VERIFICATION_PROCESSING:17,PENDING_RECIPIENT_VERIFICATION_PROCESSING:18,CANCELED_SENDER_CANCEL:19,PENDING_SENDER_IDV_REVIEW:20,PENDING_RECEIVER_IDV_REVIEW:21})}),null);
__d("PaymentModulesClient",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DONATION_P4P:"donation_p4p",MOR_DONATIONS:"mor_donations",INSTANT_EXPERIENCES:"instant_experiences",BUSINESS_PLATFORM_COMMERCE:"business_platform_commerce",MESSENGER_OMNIM:"messenger_omnim",MESSENGER_PLATFORM:"messenger_platform",PAGES_COMMERCE:"pages_commerce",SHIPPING_LABEL:"shipping_label",SYNCHRONOUS_COMPONENT_FLOW:"synchronous_component_flow",PAGES_SOLUTION:"pages_solution",CHECKOUT_EXPERIENCES:"checkout_experiences",MOBILE_TOP_UP:"mobile_top_up",MOCK:"mock"})}),null);
__d("ServicesCalendarSyncType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CLIENT_ONLY:"client_only",NO_CALENDAR_SYNC:"no_calendar_sync",SERVER_CONTINUOUS:"server_continuous",SERVER_SINGLE:"server_single"})}),null);
__d("MessengerStoryAttachmentTransformer.bs",["fbt","URI","bs_array","Utils.bs","bs_string","bs_caml_array","bs_caml_format","CurrentUser","bs_js_primitive","FundsAvailability","bs_js_null_undefined","P2PTransferStatus","MNCommerceBubbleType","PaymentModulesClient","MercuryAttachmentType","bs_caml_builtin_exceptions","P2PPaymentRequestStatus","ServicesCalendarSyncType","MNCommerceCallToActionType","LeadGenInfoFieldTypes"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){return b("bs_array").map(function(a){var c=a.user_confirmation;c=c==null?[null,null,null,null,!1]:[c.cancel_button_label,c.continue_button_label,c.confirmation_message,c.confirmation_title,!0];var d=a.payment_metadata;return{action_link:a.action_link,action_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MNCommerceCallToActionType")[a.action_open_type])),action_objects:a.action_objects,title:a.title,confirmation_cancel_label:c[0],confirmation_continue_label:c[1],confirmation_message:c[2],confirmation_title:c[3],id:a.id,is_disabled:a.is_disabled,is_mutable_by_server:a.is_mutable_by_server,payment_metadata:d==null?{payment_module_config:null,total_price:null}:{payment_module_config:d.payment_module_config,total_price:d.total_price},render_style:a.render_style,webview_metadata:{fallback_url:a.webview_metadata.fallback_url,messenger_extensions:a.webview_metadata.messenger_extensions,webview_height_ratio:a.webview_metadata.webview_height_ratio,webview_share_button:a.webview_metadata.webview_share_button},should_show_user_confirmation:c[4],page_id:a.page_id}},a)}function i(a){return b("bs_array").map(function(a){var c=a.url;c=c==null?null:new(b("URI"))(c).getUnqualifiedURI().toString();return{title:a.title,uri:c}},a)}function a(a){if(!(a==null)&&a!=="")return"#"+b("bs_string").sub(a,2,a.length-2|0);else return null}function c(a){if(a==null)return null;else return{url:a.uri,src:a.uri,width:a.width,height:a.height}}function j(a,b){__p&&__p();var c=b.cover_photo,d;if(c==null)d=[null,null,null];else{var e=c.photo.image;e=e==null?[null,null]:[e.uri,{height:e.height,width:e.width}];d=[c.photo.id,e[0],e[1]]}c=b.location;e=c==null?[null,null]:[c.latitude,c.longitude];c=b.overall_star_rating;return{address:b.address.single_line_full_address,category:b.top_category_name,coverPhotoID:d[0],coverPhotoURL:d[1],coverPhotoDimensions:d[2],latitude:e[0],longitude:e[1],name:b.name,rating:c==null?null:c.value,pageID:b.id,priceRange:b.price_range_description,viewerID:a}}function k(a){var b=a.group_commerce_item_seller,c=a.primary_photo,d;if(c==null)d=null;else{c=c.image;d=c==null?null:c.uri}return{caption:a.group_commerce_item_description.text,desc:a.group_commerce_item_description.text,owner_id:b==null?null:b.id,price:a.formatted_price.text,text:a.group_commerce_item_description.text,title:a.group_commerce_item_title,thumb_url:d,url:a.url}}function l(a){return{app_name:a.application_name,artists:a.artist_names,audio_url:a.audio_url,duration_ms:a.duration_ms,title:a.music_title}}function m(a){var c=a.payment;return{id:a.id,desc:a.desc,display_total_cost:a.total_cost,merchant_name:a.merchant_name,target_url:a.target_url,thumb_url:a.thumb_url,raw_amount:a.raw_amount,payment_id:c==null?null:c.id,total_cost:{amount:b("bs_caml_format").caml_float_of_string(a.price_amount),currency:a.price_currency},name:a.name}}function n(a){return{fundraiserID:a.fundraiserID,canDonate:a.canDonate,hasViewerDonated:a.hasViewerDonated,fundraiserDetailedProgressText:a.fundraiserDetailedProgressText,fundraiserSubtitleText:a.fundraiserSubtitleText,focusedCoverPhoto:a.focusedCoverPhoto}}function o(a){return{id:a.id,name:a.name,desc:a.desc,thumb_url:a.thumb_url,item_url:a.item_url,title:a.name,text:a.desc,source:a.source,image_aspect_ratio:a.image_aspect_ratio,metalines:{metaline_1:a.first_metaline,metaline_2:a.second_metaline,metaline_3:a.third_metaline},default_action:a.default_action,call_to_actions:h(a.call_to_actions)}}function p(a){__p&&__p();var c=function(a){a=a.page_call_to_action;if(a==null)return undefined;else return a.id},d=function(a){a=a.page_call_to_action;if(a==null)return!1;else{a=a.component_flow_service_config;if(a==null)return!1;else return!0}},e=a.page;c=e==null?[undefined,undefined,undefined,!1]:[e.id,b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("ServicesCalendarSyncType")[e.calendar_sync_type])),c(e),d(e)];d=a.native_component_flow_request;if(d==null)e=null;else{var f=d.page,h=d.page,i=d.page,j;if(i==null)j=undefined;else{i=i.profile_picture;j=i==null?undefined:i.uri}i=d.suggested_time_range;var k=d.product_item,l=d.product_item,m=d.product_item,n=d.product_item,o;if(n==null)o=undefined;else{n=n.profile_picture;o=n==null?undefined:n.uri}n=d.user;var p=d.user,q=d.job_application,r=d.user,s;if(r==null)s=undefined;else{r=r.profile_picture;s=r==null?undefined:r.uri}e={additionalInfo:d.additional_info,archivedStatus:d.archived_status,availability:d.availability,hasSavedToCalendar:d.has_saved_to_calendar,requestFlowType:d.request_flow_type,generalInfo:d.service_general_info,id:d.id,pageID:f==null?undefined:f.id,pageName:h==null?undefined:h.name,pageProfilePic:j,preferredTimeRange:i==null?null:{end:i.end,start:i.start},price:k==null?null:k.experimental_freeform_price,duration:l==null?null:l.duration_in_seconds,requestAdminApprovalType:d.request_admin_approval_type,requestedTime:d.requested_time,serviceName:m==null?null:m.name,serviceProfilePic:o,specialRequest:d.special_request,status:d.booking_status_value,statusLabel:d.status,userID:n==null?undefined:n.id,username:p==null?undefined:p.short_name,jobApplicationID:q==null?undefined:q.id,userProfilePic:s}}r=a.message_bubble_type;var t;switch(r){case"CANCELLED":t=["Cancelled",g._("Cancelled")];break;case"DECLINED":t=["Declined",g._("Declined")];break;case"REQUESTED":t=["Requested",g._("Requested")];break;case"SCHEDULEED":t=["Scheduled",g._("Scheduled")];break;default:throw[b("bs_caml_builtin_exceptions").invalid_argument,"Erroneous target status"]}return{id:a.id,pageID:c[0],calendarSyncType:c[1],ctaID:c[2],hasServiceConfig:c[3],userID:a.user.id,status:t[0],statusLabel:t[1],viewerID:b("CurrentUser").getAccountID(),requestMetadata:e}}function q(a){return{live_location_id:a.live_location_id,is_expired:a.is_expired,expiration_time:a.expiration_time,sender:a.sender,coordinate:a.coordinate,location_title:a.location_title,sender_destination:a.sender_destination,stop_reason:a.stop_reason}}function r(a){var b=a.first_metaline;return{desc:a.description,id:a.id,image_aspect_ratio:a.image_aspect_ratio,item_url:a.target_url,metalines:b==null?{}:{metaline_1:b},name:a.name,source:a.source_name,text:a.description,thumb_url:a.image_url,title:a.name,default_action:a.default_action,call_to_actions:h(a.call_to_actions),media_blob_attachments:a.media_blob_attachments}}function s(a){var c=b("bs_array").map(r,a.business_items.nodes),d=h(a.call_to_actions);return{message:a.message,call_to_actions:d,items:c}}function t(a){return{message:a.message,call_to_actions:h(a.call_to_actions),items:b("bs_array").map(r,a.promotion_items.nodes)}}function u(a){var c=a.structured_address.streets,d=a.partner_logo;return{account_holder_name:a.account_holder_name,adjustments:b("bs_array").map(function(a){return{adjustment_type:a.adjustment_type,display_adjustment_amount:a.adjustment_amount}},a.adjustments),cancellation_url:a.cancellation_url,items:b("bs_array").map(r,a.items.nodes),merchant_name:a.merchant_name,messenger_commerce_bubble_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MNCommerceBubbleType")[a.messenger_commerce_bubble_type])),order_id:a.order_id,order_time:a.order_time,order_url:a.order_url,payment_method:a.payment_method,receipt_id:a.receipt_id,recipient_name:a.recipient_name,shipping_cost:a.shipping_cost,shipping_method:a.shipping_method,status:a.status,structured_address:{city:a.structured_address.city,state:a.structured_address.state,country:a.structured_address.country,postal_code:a.structured_address.postal_code,street_1:b("bs_caml_array").caml_array_get(c,0),street_2:b("bs_caml_array").caml_array_get(c,1)},subtotal:a.subtotal,total_cost:a.total_cost,total_tax:a.total_tax,partner_logo:d==null?undefined:d.uri}}function v(a,c){return{payment_modules_client:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("PaymentModulesClient")[c.payment_modules_client])),is_viewer_seller:c.is_viewer_seller,payment_snippet:c.payment_snippet,item_list:b("bs_array").map(function(a){return{item_id:a.item_id,name:a.name,subtitle:a.subtitle,description:a.description,unit_price:a.unit_price,image_urls:b("bs_array").map(function(a){return a.uri},a.images),quantity:a.quantity}},c.item_list),components:c.components,payment_call_to_actions:c.payment_call_to_actions,click_action:c.click_action,actor_id:a,invoicer_id:c.invoicer_id}}var w=function(a){__p&&__p();var c=b("LeadGenInfoFieldTypes"),d={},e=[];for(var a=a.field_data_list,f=Array.isArray(a),g=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=a.length)break;h=a[g++]}else{g=a.next();if(g.done)break;h=g.value}h=h;var i=h.field_type,j=h.label;h=h.values;i===c.CUSTOM||i===c.ZIP?e.push({label:j,values:h}):d[i]={label:j,values:h}}d.questions=e;return d};function x(a,b){var c=b.invite_recipient;c=c==null?null:c.id;var d=b.invite_sender;d=d==null?null:d.id;return{quick_invite_id:b.id,recipient_id:c,sender_id:d,is_viewer_recipient:a===c}}function y(a){var b=function(a){if(a==null)return null;else return a.uri},c=a.listing_category;c=c==null?[null,null]:[c.offer_image,c.request_image];return{listingType:a.listing_type,mapURI:b(a.map_image),offerURI:b(c[0]),requestURI:b(c[1])}}function z(a){return{sender:a.sender,receiver:a.receiver,transfer_id:a.transfer_id,bubbleView:a.bubble_view}}function A(a){__p&&__p();var c=a.receiver_profile,d;if(c==null)d=null;else{var e=c.profile_picture;d={id:c.id,name:c.short_name,full_name:c.name,picture:e==null?null:e.uri,profile_url:c.url}}e=a.sender;if(e==null)c={};else{var f=e.profile_picture;c={id:e.id,name:e.name,full_name:e.full_name,picture:f==null?null:f.uri,profile_uri:e.url}}f=a.transfer_context;if(f==null)e=[null,null,null];else{var g=f.transfer_theme;e=[f.memoText,b("bs_array").map(function(a){a=a.image;if(a==null)return null;else return a.uri},f.memo_images),g==null?null:g.id]}f=a.platform_item;g=f==null?null:{name:f.name,description:f.description,image:b("bs_array").map(function(a){a=a.image;if(a==null)return null;else return a.uri},f.photos),refURL:f.url};return{sender:c,amountWithSymbol:a.transaction_amount.formatted_amount,status:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("P2PTransferStatus")[a.transfer_status])),receiver:d,transfer_id:a.transfer_id,completedTime:a.completedTime,updatedTime:a.updatedTime,creationTime:a.creationTime,amount:a.transaction_amount.amount,memoText:e[0],memoPhotoURLs:e[1],themeID:e[2],discountAmount:a.amount_fb_discount.formatted,fundsAvailability:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("FundsAvailability")[a.funds_availability])),groupThreadFBID:a.group_thread_fbid,platform_item:g,statusDescription:{markup:a.status_description},bubbleView:a.bubble_view,currencyCode:a.currency_amount.currency}}function B(a){__p&&__p();var c=a.requester,d;if(c==null)d=undefined;else{var e=c.profile_picture;d={id:c.id,name:c.short_name,full_name:c.name,picture:e==null?null:e.uri,profile_url:c.url}}e=a.requestee;if(e==null)c=undefined;else{var f=e.profile_picture;c={id:e.id,name:e.short_name,full_name:e.name,picture:f==null?null:f.uri,profile_url:e.url}}f=b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("P2PPaymentRequestStatus")[a.request_status]));e=a.transfer;e=e==null?[null,""]:[A(e),e.id];var g=a.request_theme;return{amount:a.transaction_amount.amount,amountWithSymbol:a.amount.formatted,requestee:c,requester:d,currentStatus:f,currency:a.amount.currency,creationTime:a.creation_time,groupThreadFBID:a.group_thread_fbid,id:a.id,memoText:a.memo_text,themeID:g==null?null:g.id,transfer:e[0],transferID:e[1],updatedTime:a.updated_time,bubbleView:a.bubble_view,statusDescription:{markup:a.status_description}}}function C(a){var c=B({amount:a.amount,transaction_amount:a.transaction_amount,requester:a.requester,requestee:a.requestee,request_status:a.request_status,request_theme:a.request_theme,id:a.id,memo_text:a.memo_text,transfer:a.transfer,creation_time:a.creation_time,group_thread_fbid:a.group_thread_fbid,updated_time:a.updated_time,bubble_view:a.bubble_view,status_description:a.status_description});a={individualRequests:b("bs_array").map(B,a.individual_requests)};return Object.assign(c,a)}function D(a,c){__p&&__p();var d=c.media,e=d==null?null:d.animated_image,f=d==null?null:d.image,g={};b("bs_array").iter(function(b){var a=b.value;g[b.key]=a==null?null:a.text;return 0},c.properties);var h=c.target,r;if(h==null)r=null;else switch(h.tag|0){case 0:r=y(h[0]);break;case 1:r=z(h[0]);break;case 2:r=A(h[0]);break;case 3:r=C(h[0]);break;case 4:r=v(a,h[0]);break;case 7:r=t(h[0]);break;case 8:r=s(h[0]);break;case 10:r=w(h[0]);break;case 11:r=q(h[0]);break;case 12:r=x(a,h[0]);break;case 13:r=p(h[0]);break;case 14:var B=h[0],D=B.genie_sender;D=D==null?[null,null]:[D.messaging_actor.id,D.messaging_actor.name];var F=D[0];B=B.story_attachment;B=B==null?null:E(a,{legacy_attachment_id:F,story_attachment:{action_links:B.action_links,messaging_attribution:B.messaging_attribution,messenger_call_to_actions:B.messenger_call_to_actions,deduplication_key:B.deduplication_key,description:B.description,media:B.media,properties:B.properties,source:B.source,style_list:B.style_list,title_with_entities:B.title_with_entities,url:B.url,subattachments:[],target:null}});r={genie_id:F,genie_name:D[1],attachment:B};break;case 16:r=l(h[0]);break;case 18:r=o(h[0]);break;case 19:r=m(h[0]);break;case 20:r=n(h[0]);break;case 21:r=u(h[0]);break;case 23:r=k(h[0]);break;case 24:r=j(a,h[0]);break;default:r=h[0]}F=c.target;D=!(F==null)&&F.tag===7?0:null;B=c.description;a=c.source;h=c.title_with_entities;return{description:B==null?null:B.text,media:{animated_image:e==null?null:e.uri,animated_image_size:e==null?{height:null,width:null}:{height:e.height,width:e.width},image:f==null?null:f.uri,image_size:f==null?{height:null,width:null}:{height:f.height,width:f.width},duration:d==null?null:d.playable_duration,playable:d==null?null:d.is_playable,source:d==null?null:d.playable_url},source:a==null?null:a.text,style_list:c.style_list,title:h==null?null:h.text,action_links:i(c.action_links),messaging_attribution:c.messaging_attribution,messenger_ctas:b("bs_array").map(function(a){return{id:a.id,page_id:b("Utils.bs").$pipe$unknown(b("bs_js_primitive").null_undefined_to_opt(a.page_id),""),action_title:a.title,action_url:a.action_link,action_open_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MNCommerceCallToActionType")[a.action_open_type])),is_high_confidence:b("Utils.bs").$pipe$unknown(b("bs_js_primitive").null_undefined_to_opt(a.is_high_confidence),!1),is_mutable_by_server:a.is_mutable_by_server,native_url:a.native_url,is_disabled:a.is_disabled,webview_metadata:{fallback_url:a.webview_metadata.fallback_url,messenger_extensions:a.webview_metadata.messenger_extensions,webview_height_ratio:a.webview_metadata.webview_height_ratio,webview_share_button:a.webview_metadata.webview_share_button}}},c.messenger_call_to_actions),properties:g,uri:c.url,deduplication_key:c.deduplication_key,target:r,label:D}}function E(a,c){var d=c.story_attachment,e;if(d==null)e=null;else{c={share_id:c.legacy_attachment_id,subattachments:b("bs_array").map(function(b){return D(a,b)},d.subattachments)};d={description:d.description,media:d.media,source:d.source,style_list:d.style_list,title_with_entities:d.title_with_entities,properties:d.properties,url:d.url,deduplication_key:d.deduplication_key,action_links:d.action_links,messaging_attribution:d.messaging_attribution,messenger_call_to_actions:d.messenger_call_to_actions,target:d.target};e=Object.assign(c,D(a,d))}return{app_attribution:null,attach_type:b("MercuryAttachmentType").SHARE,name:null,url:null,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:null,metadata:null,share:e,thumbnail_url:null}}f._getCallToActions=h;f._getActionLinks=i;f._getColor=a;f._getLogo=c;f._getPageTarget=j;f._getGroupCommerceProductItemTarget=k;f._getExternalSongTarget=l;f._getAgentSuggestionItemTarget=m;f._getFundraiserTarget=n;f._getRetailItemTarget=o;f._getPagesPlatformBookingMessageTarget=p;f._getMessageLiveLocationTarget=q;f._getBusinessRetailItem=r;f._getMessengerBusinessMessageTarget=s;f._getMessengerRetailPromotionTarget=t;f._getMessengerRetailReceiptTarget=u;f._getPagesPlatformAttachmentTarget=v;f._getPagesPlatformLeadGenInfoTarget=w;f._getQuickInviteTarget=x;f._getCrisisListingTarget=y;f._getMoneyTransferTarget=z;f._getP2PTransferTarget=A;f._getP2PTransferRequestTarget=B;f._getP2PTransferRequestWithIndividualRequests=C;f.transformStoryAttachment=D;f.getExtensibleAttachmentPayload=E}),null);
__d("MessengerAttachmentTransformer.bs",["fbt","bs_array","bs_caml_primitive","MercuryAttachmentType","MercuryAttachmentContentType","MessengerStoryAttachmentTransformer.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(a){__p&&__p();if(a.is_malicious)return{app_attribution:null,icon_type:b("MercuryAttachmentContentType").UNKNOWN,metadata:null,name:null,preview_height:null,preview_url:null,preview_width:null,rel:null,share:null,thumbnail_url:null,url:null,attach_type:b("MercuryAttachmentType").ERROR,error_msg:g._("This attachment has been marked as malicious."),message_file_fbid:null,url_shimhash:null,url_skipshim:null};else{var c=a.attribution_app,d;if(c==null)d=null;else{var e=c.square_logo;d={id:c.id,icon_url:e==null?null:e.uri,metadata:a.attribution_metadata,name:c.name}}e=a.url;return{app_attribution:d,icon_type:a.content_type,metadata:null,name:a.filename,preview_height:null,preview_url:null,preview_width:null,rel:"ignore",share:null,thumbnail_url:null,url:e==null?null:e,attach_type:b("MercuryAttachmentType").FILE,error_msg:undefined,message_file_fbid:a.message_file_fbid,url_shimhash:a.url_shimhash,url_skipshim:a.url_skipshim}}}function i(a,c,d){__p&&__p();var e=a.chat_image;e=e==null?[null,null,null]:[e.uri,e.width,e.height];var f=e[0],g=a.chat_image;g=g==null?null:{width:g.width,height:g.height};var h=a.large_image;h=h==null?[null,null]:[h.uri,{width:h.width,height:h.height}];var i=a.inbox_image;i=i==null?[null,null]:[i.uri,{width:i.width,height:i.height}];var j=a.attribution_app,k;if(j==null)k=null;else{var l=j.square_logo;k={id:j.id,icon_url:l==null?null:l.uri,metadata:a.attribution_metadata,name:j.name}}return{app_attribution:k,attach_type:b("MercuryAttachmentType").VIDEO,name:a.filename,url:a.playable_url,rel:"async",preview_url:f,preview_width:e[1],preview_height:e[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:b("MercuryAttachmentContentType").VIDEO,metadata:{fbid:a.legacy_attachment_id,render_as_sticker:a.video_type==="SPEAKING_STICKER",dimensions:{width:a.original_dimensions.x,height:a.original_dimensions.y},duration:a.playable_duration_in_ms,large_size:h[1],large_preview:h[0],chat_size:g,chat_preview:f,inbox_size:i[1],inbox_preview:i[0],pageid:d?c:undefined},thumbnail_url:f,share:null}}function j(a){var c=a.attribution_app,d;if(c==null)d=null;else{var e=c.square_logo;d={id:c.id,icon_url:e==null?null:e.uri,metadata:a.attribution_metadata,name:c.name}}return{app_attribution:d,attach_type:b("MercuryAttachmentType").FILE,name:a.filename,url:a.playable_url,rel:"ignore",preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:b("MercuryAttachmentContentType").MUSIC,metadata:{duration:a.playable_duration_in_ms,isVoicemail:a.is_voicemail?"1":"0",type:a.audio_type==="VOICE_MESSAGE"?"fb_voice_message":a.audio_type==="VOICE_MESSAGE_WITH_TRANSCRIPT"?"fb_voice_message_with_transcript":"file_attachment"},thumbnail_url:null,share:null,url_shimhash:a.url_shimhash,url_skipshim:a.url_skipshim}}function k(a,c,d){__p&&__p();var e=a.preview_image;e=e==null?[null,null,null]:[e.uri,e.width,e.height];var f=a.animated_image;f=f==null?null:f.uri;var g=a.attribution_app,h;if(g==null)h=null;else{var i=g.square_logo;h={id:g.id,icon_url:i==null?null:i.uri,metadata:a.attribution_metadata,name:g.name}}return{app_attribution:h,attach_type:b("MercuryAttachmentType").ANIMATED_IMAGE,name:a.filename,url:f,rel:"async",preview_url:e[0],preview_width:e[1],preview_height:e[2],large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:b("MercuryAttachmentContentType").PHOTO,metadata:{fbid:a.legacy_attachment_id,image:f,dimensions:String(a.original_dimensions.x)+(","+String(a.original_dimensions.y)),pageid:d?c:undefined},thumbnail_url:f,share:null}}function l(a){__p&&__p();var c=a.original_extension==="gif"?b("MercuryAttachmentType").ANIMATED_IMAGE:a.render_as_sticker?b("MercuryAttachmentType").THIRDPARTYSTICKER:b("MercuryAttachmentType").PHOTO,d=a.preview;d=d==null?[null,null,null]:[d.uri,d.width,d.height];if(c===b("MercuryAttachmentType").PHOTO){var e=a.large_preview;e=e==null?[null,null,null]:[e.uri,e.width,e.height]}else e=[null,null,null];var f=a.attribution_app,g;if(f==null)g=null;else{var h=f.square_logo;g={id:f.id,icon_url:h==null?null:h.uri,metadata:a.attribution_metadata,name:f.name}}h=a.thumbnail;return{app_attribution:g,attach_type:c,name:a.filename,url:null,rel:"async",preview_url:d[0],preview_width:d[1],preview_height:d[2],large_preview_url:e[0],large_preview_width:e[1],large_preview_height:e[2],icon_type:b("MercuryAttachmentContentType").PHOTO,metadata:{fbid:a.legacy_attachment_id,dimensions:String(a.original_dimensions.x)+(","+String(a.original_dimensions.y))},thumbnail_url:h==null?null:h.uri,share:null,photo_encodings:a.photo_encodings}}function m(a,c){__p&&__p();var d=a,e=c;if(a>=c){a=b("bs_caml_primitive").caml_float_min(120,d/2);c=a/(d/2);return[a|0,e/2*c|0]}else{a=b("bs_caml_primitive").caml_float_min(120,e/2);c=a/(e/2);return[d/2*c|0,a|0]}}function n(a){var c=m(a.width,a.height),d=a.pack,e=a.sprite_image,f=a.sprite_image_2x,g=a.padded_sprite_image,h=a.padded_sprite_image_2x;return{app_attribution:null,attach_type:b("MercuryAttachmentType").STICKER,name:null,url:a.url,rel:null,preview_url:null,preview_width:null,preview_height:null,large_preview_url:null,large_preview_width:null,large_preview_height:null,icon_type:b("MercuryAttachmentContentType").UNKNOWN,metadata:{accessibilityLabel:a.label,stickerID:a.id,packID:d==null?null:d.id,frameCount:a.frame_count,frameRate:a.frame_rate,framesPerRow:a.frame_count>1?a.frames_per_row:1,framesPerCol:a.frame_count>1?a.frames_per_column:1,height:c[1],width:c[0],spriteURI:e==null?null:e.uri,spriteURI2x:f==null?null:f.uri,paddedSpriteURI:g==null?null:g.uri,paddedSpriteURI2x:h==null?null:h.uri,thumbnail_url:null,share:null}}}function a(a,c,d){__p&&__p();var e=[],f=c.extensible_attachment;f==null||e.push(b("MessengerStoryAttachmentTransformer.bs").getExtensibleAttachmentPayload(a,f));f=c.sticker;f==null||e.push(n(f));f=c.blob_attachments;f==null||b("bs_array").iter(function(b){__p&&__p();switch(b.tag|0){case 0:e.push(l(b[0]));return 0;case 1:e.push(k(b[0],a,d));return 0;case 2:e.push(j(b[0]));return 0;case 3:e.push(i(b[0],a,d));return 0;case 4:e.push(h(b[0]));return 0}},f);return e}f._getFilePayload=h;f._getVideoPayload=i;f._getAudioPayload=j;f._getAnimatedImagePayload=k;f._getImagePayload=l;f._getStickerDimensions=m;f._getStickerPayload=n;f.transformAttachment=a}),null);
__d("InstantGameUpdateXMATUpdateType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNKNOWN:"unknown",GAME_SCORE:"game_score",CUSTOM_MESSAGE:"custom_message"})}),null);
__d("MNCommerceMessageType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({TEXT:"text",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",ROBOT_TEXT:"robot_text",LOCATION:"location",FORCED_FETCH_MESSAGE:"forced_fetch_message",SENDER_ACTION:"sender_action",RETAIL_PRODUCT_SUBSCRIPTION:"retail_product_subscription",RETAIL_PROMOTION:"retail_promotion",RETAIL_CANCELLATION:"retail_cancellation",RETAIL_SHIPMENT:"retail_shipment",SHIPMENT_TRACKING_EVENT:"shipment_tracking_event",AIRLINE_CHECKIN_REMINDER:"airline_checkin_reminder",AIRLINE_BOARDING_PASS:"airline_boarding_pass",AIRLINE_CHECKIN:"airline_checkin",AIRLINE_BOARDINGPASS:"airline_boardingpass",AIRLINE_UPDATE:"airline_update",AIRLINE_ITINERARY:"airline_itinerary",CONTENT_SUBSCRIPTION:"content_subscription",AD_ADMIN_TEXT:"ad_admin_text",AD_TEXT:"ad_text",AD_BUBBLE:"ad_bubble",NON_AD:"non_ad",UNKNOWN:"unknown",OTHER:"other",TEMPLATE:"template",OPEN_GRAPH:"open_graph",GENERIC:"generic",LIST:"list",COMPACT_LIST:"compact_list",BUTTON:"button",RECEIPT:"receipt",GENERIC_LEGACY:"generic_legacy",ICE_BREAKER:"ice_breaker",FALLBACK:"fallback",RIDE_INTENT:"ride_intent",RIDE_SIGNUP:"ride_signup",RIDE_WELCOME:"ride_welcome",RIDE_ORDER_CONFIRMATION:"ride_order_confirmation",RIDE_REQUESTED:"ride_requested",RIDE_DRIVER_ON_THE_WAY:"ride_driver_on_the_way",RIDE_NO_DRIVER:"ride_no_driver",RIDE_DRIVER_ARRIVING:"ride_driver_arriving",RIDE_DRIVER_CANCELED:"ride_driver_canceled",RIDE_RIDER_CANCELED:"ride_rider_canceled",RIDE_COMPLETE:"ride_complete",RIDE_ADMIN_MESSAGE:"ride_admin_message",RIDE_RECEIPT:"ride_receipt",RIDE_REENGAGEMENT_FIRST_RIDE:"ride_reengagement_first_ride",GET_RIDE:"give_get_ride",GIVE_RIDE:"send_give_get_ride",REFERER_PROMO:"referer_promo",INSTANT_GAMES_SHARE:"instant_games_share",INSTANT_GAMES_SCORE:"instant_games_score",INSTANT_GAMES_LIVE_STREAM:"instant_games_live_stream",LINK:"link_admin_message",UNLINK:"unlink_admin_message",BLOCK_ALL:"block_all_admin_message",UNBLOCK_ALL:"unblock_all_admin_message",BLOCK_PROMOTION:"block_promotion_admin_message",UNBLOCK_PROMOTION:"unblock_promotion_admin_message",INITIAL_PROMOTION:"initial_promotion_admin_message",WEAK_CONSENT_ADMIN_MESSAGE:"weak_consent_admin_message",MESSENGER_TEAM_BOT_MESSAGE:"messenger_team_bot",MESSENGER_BOT_BASE_GENERIC:"messenger_bot_base_generic",COMMERCE_COMPACT_LIST:"commerce_compact_list",FEEDBACK:"feedback",MEDIA:"media",PLACE_CARD:"place_card"})}),null);
__d("MessagingTagUtils",["MessagingSourceEnum","MessagingTagConstants","MercuryMessageSourceTags"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new Set(Object.values(b("MessagingSourceEnum")));function a(a){__p&&__p();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(g.has(e))return e}return b("MessagingSourceEnum").UNKNOWN}function h(a){__p&&__p();for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e=e.split(b("MessagingTagConstants").app_id_root);if(e.length>1)return e[1].trim()}return null}function c(a,c){var d=[];a=h(a);a&&b("MessagingTagConstants").orca_app_ids.indexOf(a)!==-1&&d.push(b("MercuryMessageSourceTags").MESSENGER);b("MessagingTagConstants").chat_sources.indexOf(c)!==-1&&d.push(b("MercuryMessageSourceTags").CHAT);b("MessagingTagConstants").email_source===c&&d.push(b("MercuryMessageSourceTags").EMAIL);b("MessagingTagConstants").mobile_sources.indexOf(c)!==-1&&d.push(b("MercuryMessageSourceTags").MOBILE);return d}e.exports={getSourceFromTags:a,getSourceTags:c}}),null);
__d("P2PPaymentLogMessageSubtype",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SENT_IN_GROUP:"sent_in_group",CANCELED_SENDER_RISK:"canceled_sender_risk",CANCELED_DECLINED:"canceled_declined",CANCELED_RECIPIENT_RISK:"canceled_recipient_risk",CANCELED_EXPIRED:"canceled_expired",CANCELED_SAME_CARD:"canceled_same_card",CANCELED_CUSTOMER_SERVICE:"canceled_customer_service",CANCELED_CHARGEBACK:"canceled_chargeback",CANCELED_SYSTEM_FAIL:"canceled_system_fail",REQUEST_CANCELED_BY_REQUESTER:"request_canceled_by_requester",REQUEST_DECLINED_BY_REQUESTEE:"request_declined_by_requestee",REQUEST_EXPIRED:"request_expired",REQUEST_REMINDER:"request_reminder",MONEY_RAIN_GAME_ENTRY_POINT:"money_rain_game_entry_point"})}),null);
__d("MessengerMessageTransformer.bs",["bs_array","bs_block","bs_string","FBIDCheck","getByPath","MercuryIDs","bs_caml_format","CurrentUser","bs_js_primitive","MessagingTag","bs_js_null_undefined","MercuryActionType","MessagingTagUtils","MessagingSourceEnum","StoryAttachmentStyle","MNCommerceMessageType","MercuryLogMessageType","P2PPaymentLogMessageSubtype","MessagingGenericAdminTextType","MessengerAttachmentTransformer.bs","InstantGameUpdateXMATUpdateType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c,d){__p&&__p();if(a.__typename==="GroupPollExtensibleMessageAdminText"){var e=a.question,f;if(e==null)f=[{},null];else{var g=Object.assign({},e);Object.assign(g,{total_count:a.total_count,options:b("bs_array").map(function(a){var c=Object.assign({},a);return Object.assign(c,{total_count:a.voters.nodes.length,voters:b("bs_array").map(function(a){return a.id},a.voters.nodes)})},e.options.nodes)});f=[g,e.id]}g={message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[c])),untypedData:{event_type:b("bs_string").lowercase(a.event_type),question_id:f[1],question_json:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(JSON.stringify(f[0])))}}}else g=a.__typename==="InstantGameUpdateExtensibleMessageAdminText"?{message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[c])),untypedData:{game_id:b("getByPath")(a,["game","id"]),update_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("InstantGameUpdateXMATUpdateType")[a.update_type])),collapsed_text:a.collapsed_text,expanded_text:a.expanded_text,leaderboard_json:a.leaderboard_json,cta_url:b("getByPath")(a,["instant_game_update_data","cta_url"]),cta_title:b("getByPath")(a,["instant_game_update_data","cta_title"]),custom_image_url:b("getByPath")(a,["instant_game_update_data","photo","image","uri"]),template:b("getByPath")(a,["instant_game_update_data","template"])}}:a.__typename==="MessengerAdContextAdminText"?{message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[c])),untypedData:{ad_url:a.ad_url}}:a.__typename==="AdExtensibleMessageAdminText"?{message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[c])),untypedData:{ad_client_token:a.ad_client_token,ad_id:a.ad_id,ad_preferences_link:a.ad_preferences_link,ad_properties:a.ad_properties}}:a.__typename==="ThemeColorExtensibleMessageAdminText"||a.__typename==="ThreadIconExtensibleMessageAdminText"||a.__typename==="ThreadNicknameExtensibleMessageAdminText"||a.__typename==="AcceptPendingThreadExtensibleMessageAdminText"||a.__typename==="AddContactExtensibleMessageAdminText"||a.__typename==="RtcCallLogExtensibleMessageAdminText"||a.__typename==="GameScoreExtensibleMessageAdminText"||a.__typename==="ConfirmFriendRequestExtensibleMessageAdminText"||a.__typename==="PartiesInviteExtensibleMessageAdminText"||a.__typename==="AppointmentReminderExtensibleMessageAdminText"||a.__typename==="GraphQLServicesAppointmentsOptOutExtensibleMessageAdminText"||a.__typename==="ServicesLeadGenSurveyExtensibleMessageAdminText"||a.__typename==="ServicesLeadGenSurveyEditExtensibleMessageAdminText"||a.__typename==="PagesPlatformCreateAppointmentExtensibleMessageAdminText"?{message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[c])),untypedData:Object.assign({},a)}:{message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[c])),untypedData:undefined};return{log_message_body:d,log_message_data:g,log_message_type:b("MercuryLogMessageType").GENERIC_ADMIN_TEXT}}function h(a){return b("bs_array").map(function(a){if(a==="p2p_transfer")return b("StoryAttachmentStyle").ORION;else if(a==="p2p_payment_request")return b("StoryAttachmentStyle").ORION_REQUEST;else return a},a)}function i(a){__p&&__p();var c=a.target,d;if(c==null)d=null;else if(c.__typename==="CrisisListing")d=b("bs_block").__(0,[{listing_type:c.listing_type,listing_category:c.listing_category,map_image:c.map_image}]);else if(c.__typename==="MoneyTransfer")d=b("bs_block").__(1,[{sender:c.sender,receiver:c.receiver,transfer_id:c.transfer_id,bubble_view:c.bubble_view}]);else if(c.__typename==="PeerToPeerTransfer")d=b("bs_block").__(2,[{sender:c.sender,receiver_profile:c.receiver_profile,transaction_amount:c.transaction_amount,transfer_status:c.transfer_status,transfer_id:c.transfer_id,completedTime:c.completedTime,updatedTime:c.updatedTime,creationTime:c.creationTime,transfer_context:c.transfer_context,amount_fb_discount:c.amount_fb_discount,funds_availability:c.funds_availability,group_thread_fbid:c.group_thread_fbid,platform_item:c.platform_item,id:c.id,status_description:c.status_description,bubble_view:c.bubble_view,currency_amount:c.currency_amount}]);else if(c.__typename==="PeerToPeerPaymentRequest")d=b("bs_block").__(3,[{amount:c.amount,transaction_amount:c.transaction_amount,requester:c.requester,requestee:c.requestee,request_status:c.request_status,request_theme:c.request_theme,id:c.id,memo_text:c.memo_text,transfer:c.transfer,creation_time:c.creation_time,group_thread_fbid:c.group_thread_fbid,updated_time:c.updated_time,status_description:c.status_description,bubble_view:c.bubble_view,individual_requests:c.individual_requests}]);else if(c.__typename==="PaymentPlatformAttachment")d=b("bs_block").__(4,[{payment_modules_client:c.payment_modules_client,is_viewer_seller:c.is_viewer_seller,payment_snippet:c.payment_snippet,item_list:c.item_list,components:c.components,payment_call_to_actions:c.payment_call_to_actions,click_action:c.click_action,invoicer_id:c.invoicer_id}]);else if(c.__typename==="MomentsAppMessengerInvitation")d=b("bs_block").__(5,[{snippet:c.snippet}]);else if(c.__typename==="MomentsAppMessengerPhotoRequest")d=b("bs_block").__(6,[{snippet:c.snippet}]);else if(c.__typename==="MessengerRetailPromotion")d=b("bs_block").__(7,[{message:c.message,call_to_actions:c.call_to_actions,promotion_items:c.promotion_items}]);else if(c.__typename==="MessengerBusinessMessage")d=b("bs_block").__(8,[{message:c.message,call_to_actions:c.call_to_actions,business_items:c.business_items}]);else if(c.__typename==="Video")d=b("bs_block").__(9,[{video_id:c.video_id}]);else if(c.__typename==="PagesPlatformLeadGenInfo")d=b("bs_block").__(10,[{field_data_list:c.field_data_list}]);else if(c.__typename==="MessageLiveLocation")d=b("bs_block").__(11,[{live_location_id:c.live_location_id,is_expired:c.is_expired,expiration_time:c.expiration_time,sender:c.sender,coordinate:c.coordinate,location_title:c.location_title,sender_destination:c.sender_destination,stop_reason:c.stop_reason}]);else if(c.__typename==="QuickInvite")d=b("bs_block").__(12,[{id:c.id,invite_sender:c.invite_sender,invite_recipient:c.invite_recipient}]);else if(c.__typename==="PagesPlatformBookingMessage")d=b("bs_block").__(13,[{id:c.id,page:c.page,message_bubble_type:c.message_bubble_type,user:c.user,native_component_flow_request:c.native_component_flow_request}]);else if(c.__typename==="GenieMessage")d=b("bs_block").__(14,[{genie_sender:c.genie_sender,story_attachment:c.story_attachment}]);else if(c.__typename==="Event")d=b("bs_block").__(15,[{eventID:c.eventID,guestStatus:c.guestStatus,canViewerJoin:c.canViewerJoin,timeString:c.timeString,event_place:c.event_place,social_context:c.social_context,watchStatus:c.watchStatus,connection_style:c.connection_style,canViewerWatch:c.canViewerWatch}]);else if(c.__typename==="ExternalSong")d=b("bs_block").__(16,[{application_name:c.application_name,artist_names:c.artist_names,audio_url:c.audio_url,duration_ms:c.duration_ms,music_title:c.music_title}]);else if(c.__typename==="LightweightAction")d=b("bs_block").__(17,[{lwa_state:c.lwa_state,lwa_type:c.lwa_type}]);else if(c.__typename==="MessengerRetailItem")d=b("bs_block").__(18,[{id:c.id,name:c.name,desc:c.desc,thumb_url:c.thumb_url,item_url:c.item_url,source:c.source,image_aspect_ratio:c.image_aspect_ratio,first_metaline:c.first_metaline,second_metaline:c.second_metaline,third_metaline:c.third_metaline,default_action:c.default_action,call_to_actions:c.call_to_actions}]);else if(c.__typename==="AgentItemSuggestion")d=b("bs_block").__(19,[{id:c.id,desc:c.desc,total_cost:c.total_cost,merchant_name:c.merchant_name,target_url:c.target_url,thumb_url:c.thumb_url,raw_amount:c.raw_amount,payment:c.payment,price_amount:c.price_amount,price_currency:c.price_currency,name:c.name}]);else if(c.__typename==="FundraiserPersonToCharity"||c.__typename==="FundraiserPersonForPerson"){var e=c.fundraiser_detailed_progress_text,f=c.fundraiser_subtitle_text,g=c.focused_cover_photo;d=b("bs_block").__(20,[{fundraiserID:c.id,canDonate:c.can_donate,hasViewerDonated:c.has_viewer_donated,fundraiserDetailedProgressText:e==null?null:e.text,fundraiserSubtitleText:f==null?null:f.text,focusedCoverPhoto:g==null?null:{src:g.photo.image.uri,data:{height:g.photo.image.height,width:g.photo.image.width}}}])}else d=c.__typename==="MessengerRetailReceipt"?b("bs_block").__(21,[{account_holder_name:c.account_holder_name,adjustments:c.retail_adjustments,cancellation_url:c.cancellation_url,items:c.retail_items,merchant_name:c.merchant_name,messenger_commerce_bubble_type:c.bubble_type,order_id:c.receipt_id,order_time:c.order_time_for_display,order_url:c.receipt_url,payment_method:c.order_payment_method,receipt_id:c.id,recipient_name:c.recipient_name,shipping_cost:c.shipping_cost,shipping_method:c.shipping_method,status:c.status,structured_address:c.structured_address,subtotal:c.subtotal,total_cost:c.total,total_tax:c.tax,partner_logo:c.partner_log}]):c.__typename==="JobApplication"?b("bs_block").__(22,[{id:c.id}]):c.__typename==="GroupCommerceProductItem"?b("bs_block").__(23,[{group_commerce_item_description:c.group_commerce_item_description,group_commerce_item_seller:c.group_commerce_item_seller,formatted_price:c.formatted_price,group_commerce_item_title:c.group_commerce_item_title,primary_photo:c.primary_photo,url:c.url}]):c.__typename==="Page"?b("bs_block").__(24,[{address:c.address,top_category_name:c.top_category_name,cover_photo:c.cover_photo,location:c.location,name:c.name,overall_star_rating:c.overall_star_rating,id:c.id,price_range_description:c.price_range_description}]):c.__typename==="MessengerEventReminder"?b("bs_block").__(25,[{is_active:c.is_active}]):c.__typename==="AirlineBoardingPassCollectionMessageAttachment"?b("bs_block").__(26,[{tint_color:c.tint_color,logo:c.logo,flight_label:c.flight_label,boarding_time_label:c.boarding_time_label,departure_label:c.departure_label,passenger_names_label:c.passenger_names_label,passenger_seat_label:c.passenger_seat_label,flight_terminal_label:c.flight_terminal_label,flight_gate_label:c.flight_gate_label,view_boarding_pass_cta_label:c.view_boarding_pass_cta_label,boarding_passes:c.boarding_passes,share_cta_label:c.share_cta_label,message_cta_label:c.message_cta_label,boarding_pass_title_label:c.boarding_pass_title_label,boarding_pass_error_title_label:c.boarding_pass_error_title_label}]):c.__typename==="AirlineCheckInReminderMessageAttachment"?b("bs_block").__(27,[{pnr_number:c.pnr_number,tint_color:c.tint_color,checkin_url:c.checkin_url,booking_number_label:c.booking_number_label,flight_label:c.flight_label,arrival_time_label:c.arrival_time_label,departure_time_label:c.departure_time_label,checkin_cta_label:c.checkin_cta_label,logo:c.logo,flight_infos:c.flight_infos}]):c.__typename==="AirlineUpdateMessageAttachment"?b("bs_block").__(28,[{pnr_number:c.pnr_number,tint_color:c.tint_color,update_type:c.update_type,departure_time_label:c.departure_time_label,arrival_time_label:c.arrival_time_label,booking_number_label:c.booking_number_label,flight_gate_label:c.flight_gate_label,flight_label:c.flight_label,flight_status_label:c.flight_status_label,passenger_names_label:c.passenger_names_label,passenger_seat_label:c.passenger_seat_label,logo:c.logo,flight_info:c.flight_info,hightlighted_labels:c.hightlighted_labels}]):c.__typename==="AirlineItineraryMessageAttachment"?b("bs_block").__(29,[{confirmation_number:c.confirmation_number,pnr_number:c.pnr_number,tint_color:c.tint_color,formatted_total:c.formatted_total,itemized_price_infos:c.itemized_price_infos,formatted_tax:c.formatted_tax,formatted_base_price:c.formatted_base_price,passenger_infos:c.passenger_infos,logo:c.logo,aircraft_type_label:c.aircraft_type_label,arrival_time_label:c.arrival_time_label,base_price_label:c.base_price_label,booking_number_label:c.booking_number_label,cabin_type_label:c.cabin_type_label,departure_time_label:c.departure_time_label,flight_confirmation_label:c.flight_confirmation_label,flight_date_label:c.flight_date_label,flight_label:c.flight_label,flight_terminal_label:c.flight_terminal_label,itinerary_error_title_label:c.itinerary_error_title_label,itinerary_title_label:c.itinerary_title_label,passenger_name_label:c.passenger_name_label,passenger_names_label:c.passenger_names_label,passenger_seat_label:c.passenger_seat_label,purchase_summary_label:c.purchase_summary_label,taxes_label:c.taxes_label,total_label:c.total_label,view_details_cta_label:c.view_details_cta_label,itinerary_legs:c.itinerary_legs}]):c.__typename==="MessengerRetailShipmentTrackingEvent"?b("bs_block").__(30,[{id:c.id,shipment:c.shipment,tracking_event_time_for_display:c.tracking_event_time_for_display,shipment_tracking_event_type:c.shipment_tracking_event_type,messenger_commerce_location:c.messenger_commerce_location,tracking_event_description:c.tracking_event_description,bubble_type:c.bubble_type}]):c.__typename==="MessengerRetailShipment"?b("bs_block").__(31,[{id:c.id,tracking_number:c.tracking_number,shipdate_for_display:c.shipdate_for_display,estimated_delivery_time_for_display:c.estimated_delivery_time_for_display,commerce_origin:c.commerce_origin,commerce_destination:c.commerce_destination,retail_carrier:c.retail_carrier,shipment_tracking_events:c.shipment_tracking_events,receipt:c.receipt,recipient:c.recipient,retail_shipment_items:c.retail_shipment_items,bubble_type:c.bubble_type}]):c.__typename==="TicketOrderAttachment"?b("bs_block").__(33,[{ticket_order_id:c.ticket_order_id,event:c.event}]):c.__typename==="LeadGenDeepLinkData"?b("bs_block").__(32,[{id:c.id,cover_image:c.cover_image,headline:c.headline,name:c.name,page:c.page}]):c.__typename==="UserLeadGenInfo"?b("bs_block").__(34,[{id:c.id,field_data:c.field_data}]):c.__typename==="IceBreakerMessageAttachment"?b("bs_block").__(35,[{ice_breaker_title:c.ice_breaker_title,ice_breaker_messages:c.ice_breaker_messages,ad_id:c.ad_id}]):c.__typename==="MontageDirect"?b("bs_block").__(36,[{message_state:c.message_state,is_keep_disabled:c.is_keep_disabled,blob_media_type:c.blob_media_type,blob_media:c.blob_media,image:c.image}]):c.__typename==="MBirthdayReminderAttachment"?b("bs_block").__(37,[{friend_id:c.friend_id,confidence:c.confidence,birthday_date:c.birthday_date}]):null;return{description:a.description,media:a.media,source:a.source,style_list:h(a.style_list),title_with_entities:a.title_with_entities,properties:a.properties,url:a.url,deduplication_key:a.deduplication_key,action_links:a.action_links,messaging_attribution:a.messaging_attribution,messenger_call_to_actions:a.messenger_call_to_actions,target:d}}function j(a){var c=i({description:a.description,media:a.media,source:a.source,style_list:a.style_list,title_with_entities:a.title_with_entities,properties:a.properties,url:a.url,deduplication_key:a.deduplication_key,action_links:a.action_links,messaging_attribution:a.messaging_attribution,messenger_call_to_actions:a.messenger_call_to_actions,target:a.target});if(c==null)return null;else{a=b("bs_array").map(i,a.subattachments);return Object.assign({subattachments:a},c)}}function k(a){__p&&__p();a=a.blob_attachments;var c=[];a==null||b("bs_array").iter(function(a){__p&&__p();if(a.__typename==="MessageImage"){c.push(b("bs_block").__(0,[{attribution_app:a.attribution_app,attribution_metadata:a.attribution_metadata,filename:a.filename,preview:a.preview,large_preview:a.large_preview,thumbnail:a.thumbnail,legacy_attachment_id:a.legacy_attachment_id,original_dimensions:a.original_dimensions,original_extension:a.original_extension,render_as_sticker:a.render_as_sticker,photo_encodings:a.photo_encodings}]));return 0}else if(a.__typename==="MessageAnimatedImage"){c.push(b("bs_block").__(1,[{attribution_app:a.attribution_app,attribution_metadata:a.attribution_metadata,filename:a.filename,animated_image:a.animated_image,legacy_attachment_id:a.legacy_attachment_id,preview_image:a.preview_image,original_dimensions:a.original_dimensions}]));return 0}else if(a.__typename==="MessageAudio"){c.push(b("bs_block").__(2,[{attribution_app:a.attribution_app,attribution_metadata:a.attribution_metadata,filename:a.filename,playable_url:a.playable_url,playable_duration_in_ms:a.playable_duration_in_ms,is_voicemail:a.is_voicemail,audio_type:a.audio_type,url_shimhash:a.url_shimhash,url_skipshim:a.url_skipshim}]));return 0}else if(a.__typename==="MessageVideo"){c.push(b("bs_block").__(3,[{attribution_app:a.attribution_app,attribution_metadata:a.attribution_metadata,filename:a.filename,playable_url:a.playable_url,playable_duration_in_ms:a.playable_duration_in_ms,legacy_attachment_id:a.legacy_attachment_id,chat_image:a.chat_image,video_type:a.video_type,original_dimensions:a.original_dimensions,large_image:a.large_image,inbox_image:a.inbox_image}]));return 0}else if(a.__typename==="MessageFile"){c.push(b("bs_block").__(4,[{attribution_app:a.attribution_app,attribution_metadata:a.attribution_metadata,filename:a.filename,url:a.url,content_type:a.content_type,is_malicious:a.is_malicious,message_file_fbid:a.message_file_fbid,url_shimhash:a.url_shimhash,url_skipshim:a.url_skipshim}]));return 0}else return 0},a);return c}function l(a){__p&&__p();a=a.message;if(a==null)return[];else{var c=[];b("bs_array").iter(function(a){__p&&__p();var b=a.entity;if(b==null)return 0;else{var d=b.id;b=b.thread_key;if(d==null)if(b==null)return 0;else{b=b.thread_fbid;if(b==null)return 0;else{c.push({id:b,offset:a.offset,length:a.length,type:a.__typename});return 0}}else{c.push({id:d,offset:a.offset,length:a.length,type:a.__typename});return 0}}},a.ranges);return c}}function m(a,c,d,e){__p&&__p();var f={};b("bs_array").iter(function(a){f[a.user.id]=a.reaction;return 0},c.message_reactions);var h=b("FBIDCheck").isUser_deprecated(c.message_sender.id),i=h?b("MessagingTagUtils").getSourceFromTags(c.tags_list):b("MessagingSourceEnum").UNKNOWN;h=h?b("MessagingTagUtils").getSourceTags(c.tags_list,i):[];var n=c.commerce_message_type,o=c.customizations,p=c.replied_to_message,q;if(p==null)q=null;else{p=p.message;q=p==null?null:b("bs_js_null_undefined").fromOption([m(a,p,d,e)])}p={thread_id:d.thread_id,thread_fbid:d.thread_fbid,other_user_fbid:d.other_user_fbid,action_type:c.__typename==="UserMessage"?b("MercuryActionType").USER_GENERATED_MESSAGE:b("MercuryActionType").LOG_MESSAGE,message_id:c.message_id,threading_id:null,offline_threading_id:c.offline_threading_id,author:b("MercuryIDs").getParticipantIDFromUserID(c.message_sender.id),author_email:c.message_sender.email,ephemeral_ttl_mode:c.ttl,timestamp:b("bs_caml_format").caml_float_of_string(c.timestamp_precise),is_unread:c.unread,is_filtered_content:c.tags_list.indexOf(b("MessagingTag").FILTERED_CONTENT)!==-1,is_filtered_content_bh:c.tags_list.indexOf(b("MessagingTag").FILTERED_CONTENT_BH)!==-1,is_filtered_content_account:c.tags_list.indexOf(b("MessagingTag").FILTERED_CONTENT_ACCOUNT)!==-1,is_filtered_content_quasar:c.tags_list.indexOf(b("MessagingTag").FILTERED_CONTENT_QUASAR)!==-1,is_filtered_content_invalid_app:c.tags_list.indexOf(b("MessagingTag").FILTERED_CONTENT_INVALID_APP)!==-1,is_sponsored:c.is_sponsored,ad_id:c.ad_id,ad_client_token:c.ad_client_token,commerce_message_type:n==null?null:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MNCommerceMessageType")[n])),customizations:o==null?[]:o,source:i,source_tags:h,tags:c.tags_list,is_spoof_warning:c.tags_list.indexOf(b("MessagingTag").DOMAIN_AUTH_FAIL)!==-1||c.tags_list.indexOf(b("MessagingTag").SPAM_SPOOFING)!==-1||c.tags_list.indexOf(b("MessagingTag").SPOOF_WARNING)!==-1,folder:d.folder,platform_xmd:c.platform_xmd_encoded,message_source:c.message_source_data,montage_reply_data:c.montage_reply_data,replied_to_message:q,skip_bump_thread:!1,profile_ranges:l(c),reactions:f,has_attachment:null,attachments:null,raw_attachments:null,ranges:null,meta_ranges:null,status:null,log_message_type:null,log_message_data:null,log_message_body:null,body:null,subject:null,creator_info:null};if(c.__typename==="UserMessage"){n=k(c);o=c.extensible_attachment;if(o==null)i=null;else{h=o.story_attachment;i={legacy_attachment_id:o.legacy_attachment_id,story_attachment:h==null?null:j(h)}}q=b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:i,blob_attachments:n,sticker:c.sticker},e);o=c.message;h=c.page_admin_sender;Object.assign(p,{body:o==null?null:o.text,creator_info:h==null?null:{creatorID:h.admin_id,creatorName:h.name,creatorType:h.sender_type,labelType:h.label_type,pageID:h.page_id,profileURI:h.profile_uri},subject:null,has_attachment:q.length>0,attachments:q,raw_attachments:null,ranges:undefined,meta_ranges:c.meta_ranges.map(function(a){return babelHelpers["extends"]({},a,{data:JSON.parse(a.data)})})})}else if(c.__typename==="VoiceCallMessage"||c.__typename==="VideoCallMessage"){a=c.__typename;i=a==="VoiceCallMessage"?b("MercuryLogMessageType").PHONE_CALL:b("MercuryLogMessageType").VIDEO_CALL;n=c.message_sender.id;e=d.other_user_fbid;o=e==null?null:b("MercuryIDs").getParticipantIDFromUserID(n===e?b("CurrentUser").getID():e);h=c.answered;Object.assign(p,{log_message_type:i,log_message_data:{answered:h==null?!1:h,caller:b("MercuryIDs").getParticipantIDFromUserID(n),callee:o},log_message_body:c.snippet})}else if(c.__typename==="ThreadNameMessage")Object.assign(p,{log_message_type:b("MercuryLogMessageType").THREAD_NAME,log_message_data:{name:c.thread_name},log_message_body:c.snippet});else if(c.__typename==="ThreadImageMessage"){q=c.image_with_metadata;if(q==null)a=null;else{d=q.preview;a={preview_url:d==null?null:d.uri,metadata:{fbid:q.legacy_attachment_id,dimensions:String(q.original_dimensions.x)+(","+String(q.original_dimensions.y))}}}Object.assign(p,{log_message_type:b("MercuryLogMessageType").THREAD_IMAGE,log_message_data:{image:a},log_message_body:c.snippet})}else if(c.__typename==="ParticipantsAddedMessage"){e=c.participants_added;Object.assign(p,{log_message_type:b("MercuryLogMessageType").SUBSCRIBE,log_message_data:{added_participants:e==null?[]:b("bs_array").map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.id)},e)},log_message_body:c.snippet})}else if(c.__typename==="ParticipantLeftMessage"){i=c.participants_removed;Object.assign(p,{log_message_type:b("MercuryLogMessageType").UNSUBSCRIBE,log_message_data:{removed_participants:i==null?[]:b("bs_array").map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.id)},i)},log_message_body:c.snippet})}else if(c.__typename==="GenericAdminTextMessage"){h=c.extensible_message_admin_text;n=c.extensible_message_admin_text_type;h==null?n==null||Object.assign(p,{log_message_body:c.snippet,log_message_data:{message_type:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("MessagingGenericAdminTextType")[n])),untypedData:undefined},log_message_type:b("MercuryLogMessageType").GENERIC_ADMIN_TEXT}):n==null||Object.assign(p,g(h,n,c.snippet))}else if(c.__typename==="P2PPaymentRequestMessage"){o=c.p2p_sender;d=c.p2p_receiver;q=c.amount;a=c.message_type;Object.assign(p,{log_message_body:c.snippet,log_message_data:{transfer_id:c.transfer_id,senderId:o==null?null:b("MercuryIDs").getParticipantIDFromUserID(o.id),receiverId:d==null?null:b("MercuryIDs").getParticipantIDFromUserID(d.id),formattedAmount:q==null?null:q.formatted,subtype:a==null?null:b("bs_js_null_undefined").fromOption(b("bs_js_primitive").undefined_to_opt(b("P2PPaymentLogMessageSubtype")[a]))},log_message_type:b("MercuryLogMessageType").ORION})}return p}f._getGenericAdminTextMessage=g;f._getStyleList=h;f.unsafeCastExtensibleAttachmentWithoutSubattachments=i;f.unsafeCastExtensibleAttachment=j;f.unsafeCastBlobAttachments=k;f._getProfileRanges=l;f.transformMessage=m}),null);
__d("MessengerAttachmentTransformerForSend.bs",["bs_array","bs_caml_array","MercuryAttachmentType","MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c,d){__p&&__p();c=c.node;if(c==null)return{attach_type:b("MercuryAttachmentType").ERROR};else{if(c.__typename==="ExtensibleMessageAttachment"){var e=c.story_attachment;e={legacy_attachment_id:c.legacy_attachment_id,story_attachment:e==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(e)}}else e=null;var f=c.__typename==="Sticker"?c:null,g=c.__typename,h;switch(g){case"MessageAnimatedImage":case"MessageAudio":case"MessageFile":case"MessageImage":case"MessageVideo":h=[c];break;default:h=null}g=b("MessengerMessageTransformer.bs").unsafeCastBlobAttachments({blob_attachments:h});c=b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:e,blob_attachments:g,sticker:f},d);if(c.length!==0)return b("bs_caml_array").caml_array_get(c,0);else return{}}}function a(a,c,d){return b("bs_array").map(function(b){return g(a,b,d)},c)}f._transform=g;f.transform=a}),null);
__d("XMessagingSendController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/send/",{})}),null);
__d("MercuryServerSendMessageQueue",["fbt","BanzaiODS","ChatReliabilityInstrumentation","LogHistory","MercuryLoggingHelper","MercuryMessages","MercuryServerRequestsConfig","MercurySyncDeltaHandler","MessengerAttachmentTransformerForSend.bs","Run","MercuryServerDispatcher","MercuryServerSendMessageQueueSimulatedError","XMessagingSendController","idx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("LogHistory").getInstance("mercury_server_send_message_queue");function a(a,c,d,e){__p&&__p();this.pending_message=null;this.queue=[];this.$6=function(){return this.queue.length||this.pending_message?g._("You haven't sent your message yet. Do you want to leave without sending?"):undefined}.bind(this);this.sender_id=a;this.queue_id=c;this.$2=d.success_handler;this.$1=d.error_handler;this.$4=d.transport_error_handler;this.$3=d.timeout_handler;this.$5=b("MercurySyncDeltaHandler").getForFBID(this.sender_id);this.client=e;b("Run").onBeforeUnload(this.$6,!1);a=null;b("MercuryServerRequestsConfig").msgrRegion&&(a={name:"X-MSGR-Region",value:b("MercuryServerRequestsConfig").msgrRegion});c=this.__getSendURI();c=(e={},e[c]={request_user_id:this.sender_id,endpoint_id:this.queue_id,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:a,handler:this.handleSuccess.bind(this),error_handler:this.handleError.bind(this),transport_error_handler:this.handleTransportError.bind(this),timeout:d.timeout,timeout_handler:this.handleTimeout.bind(this),connection_retries:d.connection_retries},e);b("MercuryServerDispatcher").registerEndpoints(c)}a.prototype.__getSendURI=function(){return b("XMessagingSendController").getURIBuilder().getURI().toString()};a.prototype.__preparePayload=function(a){var c;c=(c=a)!=null?(c=c.replied_to_message)!=null?c.message_id:c:c;c=c?b("MercuryMessages").get().getServerMessageID(c):null;return{client:this.client,action_type:a.action_type,app_id:a.app_id,audio_ids:a.audio_ids,body:a.body,client_thread_id:a.client_thread_id,content_attachment:a.content_attachment,ephemeral_ttl_mode:a.ephemeral_ttl_mode,file_ids:a.file_ids,gif_ids:a.gif_ids,has_attachment:a.has_attachment,image_ids:a.image_ids,location_attachment:a.location_attachment,lightweight_action_attachment:a.lightweight_action_attachment,log_message_data:a.log_message_data,log_message_type:a.log_message_type,message_id:a.message_id,message_source_data:a.message_source_data,montage_reply_data:a.montage_reply_data,offline_threading_id:a.offline_threading_id,other_user_fbid:a.other_user_fbid,photo_fbids:a.photo_fbids,shareable_attachment:a.shareable_attachment,signature_id:a.signatureID,source:a.source,specific_to_list:a.specific_to_list,sticker_id:a.sticker_id,tags:a.tags,thread_fbid:a.thread_fbid,timestamp:a.timestamp,ui_push_phase:a.ui_push_phase,video_ids:a.video_ids,platform_xmd:a.platform_xmd,profile_xmd:a.profile_xmd,replied_to_message_id:c}};a.prototype.enqueue=function(a){this.queue.push(a),this.$7()};a.prototype.$7=function(){__p&&__p();if(this.pending_message||!this.queue.length){this.pending_message&&this.$8();return}this.pending_message=this.queue.shift();var a=this.__preparePayload(this.pending_message);for(var c in a)(a[c]===undefined||a[c]===null)&&delete a[c];if(!a.action_type){var d=b("MercuryLoggingHelper").obfuscateMessage(a);b("ChatReliabilityInstrumentation").logERROR("missing action type before sending to send controller");h.debug("missing_action_type",JSON.stringify(d))}if(!a.message_id){d=b("MercuryLoggingHelper").obfuscateMessage(a);b("ChatReliabilityInstrumentation").logERROR("missing action type before sending to send controller"+JSON.stringify(d));h.debug("missing_message_id",JSON.stringify(d))}this.$9();b("MercuryServerDispatcher").trySend(this.__getSendURI(),a,null,this.sender_id,this.queue_id)};a.prototype.$10=function(){while(this.queue.length)this.$11(this.queue.shift())};a.prototype.$11=function(a){this.$1(b("MercuryServerSendMessageQueueSimulatedError").create(a)),h.error("mark_as_failed",JSON.stringify({fbid:this.sender_id,queue_id:this.queue_id,message:b("MercuryLoggingHelper").obfuscateMessage(a)}))};a.prototype.handleSuccess=function(a,c){__p&&__p();var d=(a.actions||[]).map(function(a){__p&&__p();var c=babelHelpers["extends"]({},a);if(a.graphql_payload&&a.graphql_payload.length>0){var d=b("MessengerAttachmentTransformerForSend.bs").transform(this.sender_id,a.graphql_payload,a.for_page);c=Object.assign(c,{attachments:d})}d=(d=a)!=null?(d=d.log_message_data)!=null?d.graphql_image:d:d;if(d){d=b("MessengerAttachmentTransformerForSend.bs").transform(this.sender_id,[d],a.for_page);c=Object.assign(c,{log_message_data:{image:d[0]}})}return c}.bind(this));a.actions=d;this.$2(a,c);this.$12();this.pending_message=null;this.$7()};a.prototype.handleError=function(a){this.$12(),this.$1(a),this.$10(),this.pending_message=null};a.prototype.handleTransportError=function(a){this.$12(),this.$4(a),this.$10(),this.pending_message=null};a.prototype.handleTimeout=function(a){this.$12(),this.$3(a),this.$10(),this.pending_message=null};a.prototype.$9=function(){this.$5.pause()};a.prototype.$12=function(){this.$5.resume()};a.prototype.$8=function(){h.debug("maybe_send_next_pending_message",JSON.stringify({fbid:this.sender_id,queue_id:this.queue_id,pending_message:b("MercuryLoggingHelper").obfuscateMessage(this.pending_message),queue:this.queue.map(function(a){return b("MercuryLoggingHelper").obfuscateMessage(a)})}));var a="send_queue.delayed.queue_length."+this.queue.length.toString();b("BanzaiODS").bumpEntityKey("chat.web",a)};e.exports=a}),null);
__d("MercuryServerSendMessageQueueRouter",["BanzaiODS","LogHistory","MercuryServerSendMessageQueue","MercurySingletonMixin"],(function(a,b,c,d,e,f){__p&&__p();var g=b("LogHistory").getInstance("mercury_server_send_message_queue_router"),h="chat.web.send_queue_router";b("BanzaiODS").setEntitySample(h,.1);function a(a){"use strict";this.queues=new Map(),this.fbid=a}a.prototype.enqueue=function(a,c,d,e){"use strict";var f=this.queues.get(a);f===undefined&&(f=new(b("MercuryServerSendMessageQueue"))(this.fbid,a,c,d),this.queues.set(a,f),g.debug("added queue",JSON.stringify({fbid:this.fbid,queue_id:a})),b("BanzaiODS").bumpEntityKey(h,"new_queue"));f.enqueue(e)};Object.assign(a,b("MercurySingletonMixin"));e.exports=a}),null);
__d("MercurySyncDataFetcherImpl",["errorCode","Promise","AsyncResponse","Bootloader","CurrentUser","FBIDCheck","MercuryPayloadSource","MercuryThreadlistConstants","MessagingConfig","UserActivity","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();b("MessagingConfig").syncFetchRequestTimeoutMs;var h={limit:b("MercuryThreadlistConstants").WEBMESSENGER_THREAD_COUNT+1,folder:"inbox",tags:["INBOX"],timestamp:null,offset:b("MercuryThreadlistConstants").RECENT_THREAD_OFFSET,filter:null,includeDeliveryReceipts:!1,includeSeqID:!0},i={};function a(a){return new(b("Promise"))(function(b,c){j(a,b,c,0)})}function j(a,c,d,e){__p&&__p();if(!b("CurrentUser").isLoggedInNow()||e>b("MessagingConfig").syncFetchRetries){b("clearTimeout")(i[a]);d();return}var f=e===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,e);b("UserActivity").isOnTab()||(f+=500*Math.random());b("clearTimeout")(i[a]);i[a]=b("setTimeoutAcrossTransitions")(function(){__p&&__p();var f=!1,g=function(g){if(f)return;g.errors&&g.errors.length>0&&(function(){var c=g.errors[0].message;c&&b("Bootloader").loadModules(["MessengerWebGraphQLTypedLogger","MessengerWebGraphQLEvent"],function(b,d){new b().setErrorMessage(c).setEvent(d.DFF_FAILURE).setQueryParams(a).log()},"MercurySyncDataFetcherImpl")})();f=!0;j(a,c,d,e+1)};b("Bootloader").loadModules(["MessengerGraphQLThreadlistFetcher.bs"],function(d){return d.fetchAll(a,[h],!b("FBIDCheck").isUser_deprecated(a)).then(function(d){f=!0,c(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},d,{payload_source:b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE}))),b("clearTimeout")(i[a])},g)},"MercurySyncDataFetcherImpl")},f)}function c(a,c,d){return new(b("Promise"))(function(b,e){k(a,c,d,b,e,0)})}function k(a,c,d,e,f,g){__p&&__p();if(g>b("MessagingConfig").syncFetchRetries){f();return}var h=g===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,g);b("setTimeoutAcrossTransitions")(function(){var h=!1,i=function(b){if(h)return;h=!0;k(a,c,d,e,f,g+1)};b("Bootloader").loadModules(["MessengerThreadDFFFetcher.bs"],function(f){return f.fetch(a,{id:c,limit:d},!b("FBIDCheck").isUser_deprecated(a)).then(function(a){h=!0,e(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},a,{payload_source:b("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE})))},i)},"MercurySyncDataFetcherImpl")},h)}function d(a,c,d){return new(b("Promise"))(function(b,e){l(a,c,d,b,e,0)})}function l(a,c,d,e,f,g){__p&&__p();if(g>b("MessagingConfig").syncFetchRetries){f();return}var h=g===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,g);b("setTimeoutAcrossTransitions")(function(){var h=!1,i=function(b){if(h)return;h=!0;l(a,c,d,e,f,g+1)};b("Bootloader").loadModules(["MessengerMessageDFFFetcher.bs"],function(f){return f.fetch(a,{thread_id:c,message_id:d},!b("FBIDCheck").isUser_deprecated(a)).then(function(a){h=!0,e(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},a)))},i)},"MercurySyncDataFetcherImpl")},h)}e.exports={fetchThreadlistFromGraphQL:a,fetchThreadFromGraphQL:c,fetchMessageFromGraphQL:d}}),null);
__d("MercurySyncDataFetcher",["Promise","LogHistory","MercurySyncDataFetcherImpl","MessagingConfig","WebGraphQLConfig","clearTimeout","promiseDone","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("LogHistory").getInstance("mercury_sync_data_fetcher");function a(){var a=0;for(var c=0;c<b("MessagingConfig").syncFetchRetries;c++){var d=c===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,c);a+=d+b("MessagingConfig").syncFetchRequestTimeoutMs}return a}var h=a();function c(a){var c=null;return new(b("Promise"))(function(d,e){var f=function(a){g.error("fetch_threadlist_graphql_timeout",JSON.stringify({timeout:h})),b("clearTimeout")(c),e(a)};c=b("setTimeoutAcrossTransitions")(f,Math.max(h,b("WebGraphQLConfig").timeout*b("MessagingConfig").syncFetchRetries));b("promiseDone")(b("MercurySyncDataFetcherImpl").fetchThreadlistFromGraphQL(a),function(a){b("clearTimeout")(c),d(a)},f)})}function d(a,c,d){return new(b("Promise"))(function(e,f){var i=function(a){g.error("fetch_thread_graphql_timeout",JSON.stringify({timeout:h})),f(a)},j=b("setTimeoutAcrossTransitions")(i,h);b("promiseDone")(b("MercurySyncDataFetcherImpl").fetchThreadFromGraphQL(a,c,d),function(a){b("clearTimeout")(j),e(a)},i)})}function f(a,c,d){return new(b("Promise"))(function(e,f){var i=function(a){g.error("fetch_message_graphql_timeout",JSON.stringify({timeout:h})),f(a)},j=b("setTimeoutAcrossTransitions")(i,h);b("promiseDone")(b("MercurySyncDataFetcherImpl").fetchMessageFromGraphQL(a,c,d),function(a){b("clearTimeout")(j),e(a)},i)})}e.exports={fetchThreadlistFromGraphQL:c,fetchThreadFromGraphQL:d,fetchMessageFromGraphQL:f,getMaxTimeoutMs:a}}),null);
__d("MercurySyncDFFDataFetcher",["Promise","CurrentUser","MercuryMessages","MercuryThreads","MercuryThreadIDMap","MercurySingletonProvider","MercurySyncDataFetcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.$1=a,this.__messages=b("MercuryMessages").getForFBID(this.$1),this.__threads=b("MercuryThreads").getForFBID(this.$1),this.__threadIDMap=b("MercuryThreadIDMap").getForFBID(this.$1)}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.fetchInvalidateGlobalStateForGraphQL=function(){return this.$1&&this.$1!=="0"&&b("CurrentUser").isLoggedIn()?b("MercurySyncDataFetcher").fetchThreadlistFromGraphQL(this.$1):new(b("Promise"))(function(a,b){return b(!0)})};a.prototype.fetchInvalidateThreadState=function(a,c){var d=11,e=3;a=a||c;c=this.__threadIDMap.getClientIDFromServerIDNow(a);if(!c)return b("Promise").resolve({getPayload:function(){return{}}});e=e+this.__messages.getCurrentlyLoadedMessages(c).length;return!a?b("Promise").resolve({getPayload:function(){return{}}}):b("MercurySyncDataFetcher").fetchThreadFromGraphQL(this.$1,a,Math.max(e,d))};a.prototype.fetchInvalidateMessage=function(a,c,d){a=a||c;return!a?b("Promise").resolve({getPayload:function(){return{}}}):b("MercurySyncDataFetcher").fetchMessageFromGraphQL(this.$1,a,d)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncChannelMonitor",["Arbiter","ChannelConstants","CurrentUser","MercurySingletonProvider","MercurySyncFakeDFFSender"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){this.handleAwfulChannelEvent=function(){if(!b("CurrentUser").isLoggedInNow()){this.killSubscriptions();return}b("MercurySyncFakeDFFSender").getForFBID(this.$1).sendGlobalDFF()}.bind(this),this.$1=a,this.$2=!1}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};a.prototype.setupSubscriptions=function(){this.$2||(this.$4=b("Arbiter").subscribe(b("ChannelConstants").JUMPSTART,this.handleAwfulChannelEvent),this.$3=b("Arbiter").subscribe(b("ChannelConstants").THROTTLED,this.handleAwfulChannelEvent),this.$2=!0)};a.prototype.killSubscriptions=function(){this.$2&&(b("Arbiter").unsubscribe(this.$4),b("Arbiter").unsubscribe(this.$3),this.$2=!1)};var g=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncTopicType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({DELTA:"delta",DELTAFLOW:"deltaflow",DELTAFLOWREJECT:"deltaflowreject"})}),null);
__d("MercurySyncDeltaHandler",["invariant","Arbiter","AsyncResponse","ChannelConstants","ChatReliabilityInstrumentation","CurrentUser","FBIDCheck","LogHistory","MercuryConfig","MessagingConfig","MercuryDelayedDispatcher","MercuryPayloadSource","MercurySyncChannelMonitor","MercurySyncConstants","MercurySyncDeltaHolder","MercurySyncDeltaTypes","MercurySyncDispatcher","MercurySyncForcedFetchHandler","MercurySyncHolesTypedLogger","MercuryServerPayloadPreprocessor","MercurySyncTopicType","MercurySingletonProvider","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("LogHistory").getInstance("mercury_sync_delta_handler"),i=b("MessagingConfig").syncFetchRetries||0;a.getForFBID=function(a){return j.getForFBID(a)};a.get=function(){return j.get()};function a(a){__p&&__p();this.$1=a,this.$2=b("MercurySyncDispatcher").getForFBID(this.$1),this.$3=b("MercurySyncForcedFetchHandler").getForFBID(this.$1),this.__payloadPreprocessor=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1),this.__delayedDispatcher=b("MercuryDelayedDispatcher").getForFBID(this.$1),this.$4=b("MercurySyncDeltaHolder").getForFBID(this.$1),this.$5=0,this.$11=b("MercurySyncChannelMonitor").getForFBID(this.$1),this.$6=[],this.$13=0,h.debug("constructor",JSON.stringify({fbid:this.$1})),b("Arbiter").subscribe("MercurySyncDeltaHandler/initSeqID",function(a,c){__p&&__p();h.debug("initSeqID",JSON.stringify(c));a=c&&c.seqID;c=c&&c.fbid;if(!c)return;if(c!==this.$1)return;a?this.$4.updateLastSeqID(a):this.$4.updateLastSeqID(0);this.$15();this.$8=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("deltaflow"),function(a,b){this.$14||this.$15()}.bind(this))}.bind(this))}a.prototype.$15=function(){__p&&__p();h.debug("setUpSubscriptionsToRealTimeUpdates",JSON.stringify({fbid:this.$1})),this.$7=b("Arbiter").subscribe(this.$16(),function(a,c){__p&&__p();a=c&&c.obj&&c.obj.queue;if(a&&a.toString()!==this.$1)return;a=c&&c.obj&&c.obj.delta;c=c&&c.obj&&c.obj.iseq;if(!a||!c)return;this.$17(c,b("MercurySyncTopicType").DELTA);this.$18(c,a);this.$4.push(c,a);this.$19()}.bind(this)),this.$12=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("deltaflowreject"),function(a,b){a=b&&b.obj&&b.obj.queue;if(a&&a.toString()!==this.$1)return;this.$14&&this.$20()}.bind(this)),this.$9=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType(b("ChannelConstants").FAKE_DFF),function(a,b){a=b&&b.obj&&b.obj.queue;if(a&&a.toString()!==this.$1)return;a=b&&b.obj&&b.obj.delta;if(!a)return;this.$6.push(a);this.$19()}.bind(this)),this.$11.setupSubscriptions(),this.$14=!0};a.prototype.$19=function(){__p&&__p();if(this.$5>0)return;if(this.$6.length>0){var a=this.$6.shift();this.$21(this.$4.getLastSeqID(),a);this.$19()}a=this.$4.peek();if(!a)return;a=a-this.$4.getLastSeqID();if(a===1){var b=this.$4.pop();if(!b)return;var c=b.seqID;b=b.delta;this.$21(c,b);this.$19()}else a>1?this.$22():(this.$4.pop(),this.$19())};a.prototype.$21=function(a,c){this.$4.updateLastSeqID(a),c["class"]===b("MercurySyncDeltaTypes").ForcedFetch?(h.debug("DFF",JSON.stringify(c)),c.threadKey!==undefined&&c.messageId===undefined?this.$23(a,c):c.threadKey!==undefined&&c.messageId!==undefined?this.$24(a,c):(b("ChatReliabilityInstrumentation").logDFF_DELTA_INIT(JSON.stringify(c)),this.$25(a))):this.$2.process(c)};a.prototype.$22=function(){var a=JSON.stringify({$26:this.$4.getLastSeqID(),nextSeqID:this.$4.peek()});h.warn("hole",a);var c=this.$4.peek();!c&&g(0);c=c-1;b("ChatReliabilityInstrumentation").logDFF_HOLE_INIT(a);this.$25(c)};a.prototype.$27=function(a,c,d,e){this.$5&&g(0),this.$5++,h.debug("_scheduleDataFetch:start",JSON.stringify({seqID:a})),b("promiseDone")(c(),function(b){h.debug("_scheduleDataFetch:success",JSON.stringify({seqID:a})),this.$5--,d(a,b),this.$19()}.bind(this),function(b){h.error("_scheduleDataFetch:failure",JSON.stringify({seqID:a})),this.$5--,e(a,b),this.$19()}.bind(this))};a.prototype.$25=function(a){__p&&__p();if(!b("CurrentUser").isLoggedInNow())return;this.$27(undefined,function(){return this.$3.processGlobalDFFForGraphQL()}.bind(this),function(a,c){a=c.getPayload();this.__payloadPreprocessor.handleUpdate(a);a.sequence_id&&(h.debug("_initiateGlobalDFF:success",JSON.stringify({seqID:a.sequence_id})),this.$4.updateLastSeqID(a.sequence_id));this.$13=0;b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RECOVER)}.bind(this),function(c,d){h.error("_initiateGlobalDFF:failure",""),this.$13>=i&&!b("gkx")("AT6272W7G37c2zZOpPDUPGXaehXUPvo7_ZqAqdSAoKzgP5DQ8Luz0w5hQkLZeaPa8UmuuAXTSUI8FctXnbHnbKTw")||d?(this.$14&&this.$20(),b("gkx")("AT6T2zrYpHKRdiC2jWw79jSLuG2Ai8UAXBl4mf7UaSrzuZmkv1aboo5IByEaBzwrmKZ7i_TneQib5Fe9fVTNdQMv")&&this.$4.updateLastSeqID(a)):(this.$13++,b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RETRY),h.debug("_initiateGlobalDFF:retry",""),this.$25(a))}.bind(this))};a.prototype.$23=function(a,b){this.$27(a,function(){return this.$3.processThreadDFF(a,b.threadKey,b.isLazy)}.bind(this),function(a,b){this.__payloadPreprocessor.handleUpdate(b.getPayload()),this.$4.updateLastSeqID(a)}.bind(this),function(){h.error("_initiateThreadDFF:failure",JSON.stringify(b));var c=babelHelpers["extends"]({},b);delete c.threadKey;this.$4.updateLastSeqID(a-1);this.$4.push(a,c)}.bind(this))};a.prototype.$24=function(a,c){__p&&__p();this.$27(a,function(){return this.$3.processMessageDFF(a,c.threadKey,c.messageId,c.isLazy)}.bind(this),function(a,c){c=c.getPayload();var d=c.other_user_fbid?c.other_user_fbid:c.thread_fbid;c=[babelHelpers["extends"]({},c)];var e=b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE;this.__delayedDispatcher.handleUpdateWaitForThread({actions:c,payload_source:e},d);this.$4.updateLastSeqID(a)}.bind(this),function(){h.error("_initiateMessageDFF:failure",JSON.stringify(c));var b=babelHelpers["extends"]({},c);delete b.messageId;this.$4.updateLastSeqID(a-1);this.$4.push(a,b)}.bind(this))};a.prototype.$17=function(a,c){var d=a-this.$4.getLastSeqID();if(d!==1&&d!==0){if(!b("MercuryConfig").WWWSyncHolesLogging)return;new(b("MercurySyncHolesTypedLogger"))().setSeqID(a).setDifference(d).setTopicType(c).log()}};a.prototype.$18=function(a,c){switch(c["class"]){case b("MercurySyncDeltaTypes").NewMessage:h.debug("message_delta",JSON.stringify({seqID:a,threadKey:c.messageMetadata.threadKey,messageId:c.messageMetadata.messageId}));break;case b("MercurySyncDeltaTypes").ReadReceipt:h.debug("read_receipt_delta",JSON.stringify({seqID:a,threadKey:c.threadKey,actionTimestampMs:c.actionTimestampMs,watermarkTimestampMs:c.watermarkTimestampMs}));break;case b("MercurySyncDeltaTypes").DeliveryReceipt:h.debug("delivery_receipt_delta",JSON.stringify({seqID:a,deliveredWatermarkTimestampMs:c.deliveredWatermarkTimestampMs,messageIds:c.messageIds}));break}};a.prototype.pause=function(){this.$5++};a.prototype.resume=function(){this.$5--,this.$19()};a.prototype.$20=function(){this.$14=!1,b("Arbiter").unsubscribe(this.$7),b("Arbiter").unsubscribe(this.$9),b("Arbiter").unsubscribe(this.$12),this.$11.killSubscriptions(),b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE)};a.prototype.$16=function(){return b("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":b("ChannelConstants").getArbiterType("delta")};var j=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercuryMessageCustomizations",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,b){a=a.customizations;if(!a)return null;a=a.filter(function(a){return a.customization_type===b});return a.length>0?a[0].customization_value:null}function b(a){var b=JSON.parse(a),c=[];Object.keys(b).forEach(function(a){c.push({customization_type:a,customization_value:b[a]})});return c}e.exports={getCustomizationValue:a,parseCustomizations:b}}),null);
__d("MercuryProfileRanges",["idx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return!a.id&&a.i?{id:a.i,offset:a.o,length:a.l}:a}e.exports={extractFromDelta:function(a){a=(a=a)!=null?(a=a.data)!=null?a.prng:a:a;if(!a)return undefined;var b=[];try{b=JSON.parse(a);if(b.length>0)return b.map(g)}catch(a){}return b}}}),null);
__d("MessageThreadReadStateEffect",[],(function(a,b,c,d,e,f){"use strict";var g={MARK_READ:1,MARK_UNREAD:2,KEEP_AS_IS:3};a=function(a,b){var c=b.messageMetadata.skipBumpThread;a=a!==b.messageMetadata.actorFbId?g.MARK_UNREAD:g.KEEP_AS_IS;c&&(a=g.KEEP_AS_IS);return b.messageMetadata.threadReadStateEffect?b.messageMetadata.threadReadStateEffect:a};e.exports={MessageThreadReadStateEffectType:g,extractThreadStateEffectFromDelta:a}}),null);
__d("MessengerRealtimeAttachmentTransformer.bs",["MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d){var e=b("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(c),f=c.extensible_attachment,g;if(f==null)g=null;else{var h=f.story_attachment;g={legacy_attachment_id:f.legacy_attachment_id,story_attachment:h==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(h)}}return b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:g,blob_attachments:e,sticker:c.sticker},d)}f.transform=a}),null);
__d("MercurySyncNewMessageTransformer",["FBIDCheck","IrisProtocolMessageLifetime","MercuryActionType","MercuryIDs","MercuryMessageCustomizations","MercuryProfileRanges","MessagingTag","PageCommItemStatus","MessageThreadReadStateEffect","MessengerRealtimeAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessageThreadReadStateEffect").MessageThreadReadStateEffectType,h=b("MessageThreadReadStateEffect").extractThreadStateEffectFromDelta,i=function(a){var b={};try{b=JSON.parse(a)}catch(a){}return b};function a(a,c){__p&&__p();var d=parseInt(c.messageMetadata.timestamp,10),e=c.messageMetadata.skipBumpThread,f=h(a,c),j=f===g.MARK_UNREAD&&a!==c.messageMetadata.actorFbId,k=[];c.attachments&&(k=c.attachments.map(function(c){c=c.mercury;var d=c.extensible_attachment,e=c.blob_attachment;c=c.sticker_attachment;if(!d&&!e&&!c)return null;var f=b("FBIDCheck").isUser_deprecated(a);[];d?d=b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{extensible_attachment:d},f):e?d=b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{blob_attachments:[e]},f):d=b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{sticker:c});return d.length>0?d[0]:null}));var l=!b("FBIDCheck").isUser_deprecated(a);k=k.filter(Boolean);var m=c.messageMetadata.tags?c.messageMetadata.tags[0]:undefined,n=null;if(c.data&&c.data.adminSignatureCreatorID){var o=c.data;n={creatorID:o.adminSignatureCreatorID||null,creatorName:o.adminSignatureCreatorName||null,creatorType:o.adminSignatureCreatorType||null,labelType:o.adminSignatureLabelType||null,pageID:o.adminSignaturePageID||null,profileURI:o.adminSignatureProfileURI||null}}return{message_id:c.messageMetadata.messageId,threading_id:null,offline_threading_id:c.messageMetadata.offlineThreadingId,author:b("MercuryIDs").getParticipantIDFromUserID(c.messageMetadata.actorFbId),author_email:c.messageMetadata.actorFbId+"@facebook.com",ephemeral_ttl_mode:c.ttl?b("IrisProtocolMessageLifetime")[c.ttl]:0,timestamp:d,is_unread:j,is_filtered_content:!1,is_filtered_content_bh:!1,is_filtered_content_account:!1,is_filtered_content_quasar:!1,is_filtered_content_invalid_app:!1,source:m,tags:c.messageMetadata.tags,is_spoof_warning:!1,folder:b("MessagingTag").INBOX,thread_fbid:c.messageMetadata.threadKey.threadFbId,other_user_fbid:c.messageMetadata.threadKey.otherUserFbId,body:c.body!==undefined?c.body:"",html_body:null,subject:null,has_attachment:k.length>0,attachments:k,ranges:undefined,thread_id:null,action_type:b("MercuryActionType").USER_GENERATED_MESSAGE,is_from_iris:!0,is_sponsored:!!(c.data&&c.data.is_sponsored&&c.data.is_sponsored==="true")||!!(c.untypedData&&c.untypedData.is_sponsored&&c.untypedData.is_sponsored==="true"),commerce_message_type:c.data?c.data.commerce_message_type:null,customizations:c.data&&c.data.customization?b("MercuryMessageCustomizations").parseCustomizations(c.data.customization):null,platform_xmd:c.data&&c.data.platform_xmd?c.data.platform_xmd:null,profile_ranges:b("MercuryProfileRanges").extractFromDelta(c),message_source:c.data&&c.data.message_source_data?i(c.data.message_source_data).message_source:null,skip_bump_thread:e,thread_read_state_effect:f,montage_reply_data:c.data&&c.data.montage_reply_data?i(c.data.montage_reply_data):null,meta_ranges:c.data&&c.data.meta_ranges?i(c.data.meta_ranges):null,creator_info:n,comm_status:l?b("PageCommItemStatus").TODO:null}}e.exports={transform:a}}),null);
__d("MercurySyncAdminTextMessageTransformer",["MercuryActionType","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={message_type:c.type,untypedData:c.untypedData};a.log_message_type=b("MercuryLogMessageType").GENERIC_ADMIN_TEXT;return a}e.exports={transform:a}}),null);
__d("ClientSyncProtocol_GroupsSyncAction",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPT_IN:0,OPT_OUT:1})}),null);
__d("LiveLocationStopReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({EXPIRED:1,CANCELED:2,ARRIVED:3})}),null);
__d("MercurySyncClientPayloadTransformer",["ClientSyncProtocol_GroupsSyncAction","DateConsts","LiveLocationStopReason","MercuryActionType","MercuryIDs","MercurySyncNewMessageTransformer","MessageLiveLocationClientSyncProtocolStopReason","MessengerGroupsSyncStatus","PageCommItemStatus","keyMirror"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("keyMirror")(b("LiveLocationStopReason")),h=8;function a(a,b){__p&&__p();a=a.payload;a=JSON.parse(String.fromCharCode.apply(null,a));a=a&&a.deltas;a=a[0];if(a.deltaMessageReaction)return n(a.deltaMessageReaction);else if(a.liveLocationData)return p(a.liveLocationData);else if(a.deltaUpdateGroupEventRSVPStatus){var c=a.deltaUpdateGroupEventRSVPStatus;return o(c)}else if(a.deltaPageThreadFollowUpData)return r(a.deltaPageThreadFollowUpData);else if(a.deltaChangeViewerStatus)return l(a.deltaChangeViewerStatus,b);else if(a.deltaMontageDirectExpire)return m(a.deltaMontageDirectExpire);else if(a.deltaMessageReply)return i(a.deltaMessageReply,b);else if(a.deltaUpdateGroupsSyncStatus)return j(a.deltaUpdateGroupsSyncStatus);else if(a.deltaUpdateGroupsSyncMetadata)return k(a.deltaUpdateGroupsSyncMetadata);else return q(a)}function i(a,c){var d=a.message;a=a.repliedToMessage;d=b("MercurySyncNewMessageTransformer").transform(c,d);if(a){c=b("MercurySyncNewMessageTransformer").transform(c,a);d.replied_to_message=c}return d}function j(a){var c=a.threadKey,d=a.actorFbid;a=a.groupsSyncStatus;c=c.threadFbId||c.otherUserFbId;if(!c)return null;a=b("MessengerGroupsSyncStatus")[a];return{action_type:b("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED,thread_fbid:c.toString(),actor_fbid:d.toString(),groups_sync_status_string:a}}function k(a){__p&&__p();var c=a.threadKey,d=a.actorFbid,e=a.syncAction,f=a.sourceSurface;a=a.syncedFbGroupId;c=c.threadFbId||c.otherUserFbId;if(!c)return null;var g=void 0;switch(e){case b("ClientSyncProtocol_GroupsSyncAction").OPT_IN:g=b("MessengerGroupsSyncStatus").OPT_IN;break;case b("ClientSyncProtocol_GroupsSyncAction").OPT_OUT:g=b("MessengerGroupsSyncStatus").OPT_OUT;break;default:return null}return{action_type:b("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE,thread_fbid:c.toString(),actor_fbid:d.toString(),groups_sync_action:g,source_surface:f,fb_group_id:a.toString()}}function l(a,c){var d=a.actorFbid,e=a.canViewerReply,f=a.reason;a=a.threadKey;if(!d)return null;var g=d.toString();g=b("MercuryIDs").getParticipantIDFromUserID(g===c?a.otherUserFbId:c);return{action_type:b("MercuryActionType").BLOCK_STATUS_CHANGED,actorFbid:d,canViewerReply:e,reason:f,message_blocked_ids:[g],other_user_fbid:a.otherUserFbId.toString()}}function m(a){var c=a.threadKey.threadFbId||a.threadKey.otherUserFbId;return{action_type:b("MercuryActionType").MONTAGE_DIRECT_EXPIRE,messageId:a.messageId,timestamp:a.timestamp,thread_fbid:c.toString(),keep_expiry_timestamp:a.keepExpiryTimestamp}}function n(a){var c=a.messageId,d=a.offlineThreadingId,e=a.reaction,f=a.senderId,g=a.userId;a=a.threadKey.threadFbId||a.threadKey.otherUserFbId;return{action_type:b("MercuryActionType").REACTION_UPDATE,messageId:c,offlineThreadingId:d,reaction:e,senderId:f,thread_fbid:a.toString(),userId:g}}function o(a){var c=a.threadKey&&a.threadKey.threadFbId;if(!c)return null;var d=a.actorFbId;a=a.rsvpStatus;return!d?null:{action_type:b("MercuryActionType").EVENT_RSVP_CHANGED,thread_fbid:c.toString(),actor_fbid:d.toString(),rsvp_status:a}}function p(a){__p&&__p();var c=a.threadKey;if(!c)return null;c=c.threadFbId||c.otherUserFbId;if(!c)return null;if(!a.messageLiveLocations||a.messageLiveLocations.length!==1)return null;a=a.messageLiveLocations[0];var d=a.expirationTime,e=a.stopReason!=null||Date.now()/b("DateConsts").MS_PER_SEC>d,f=function(a){return a/Math.pow(10,h)},i=a.coordinate?{latitude:f(a.coordinate.latitude),longitude:f(a.coordinate.longitude)}:null,j=null;a.destination&&(j={latitude:f(a.destination.latitude),longitude:f(a.destination.longitude),label:a.destination.label});f=null;switch(a.stopReason){case b("MessageLiveLocationClientSyncProtocolStopReason").EXPIRED:f=g.EXPIRED;break;case b("MessageLiveLocationClientSyncProtocolStopReason").CANCELED:f=g.CANCELED;break;case b("MessageLiveLocationClientSyncProtocolStopReason").ARRIVED:f=g.ARRIVED;break}return{action_type:b("MercuryActionType").LIVE_LOCATION_UPDATE,thread_fbid:c.toString(),messageId:a.messageId,liveLocation:{live_location_id:a.id.toString(),is_expired:e,expiration_time:d,sender:{id:a.senderId.toString()},coordinate:i,location_title:a.locationTitle,sender_destination:j,stop_reason:f}}}function q(a){a=a&&a.deltaPaymentPinProtectionStatusData;var c=a&&a.threadKey&&a.threadKey.otherUserFbId;a=a&&a.isPinProtected;if(!c)return null;c=c.toString();return{action_type:b("MercuryActionType").IS_PIN_PROTECTED,thread_fbid:c,is_pin_protected:a}}function r(a){var c=a.threadKey.otherUserFbId;return{action_type:b("MercuryActionType").UPDATE_COMM_STATUS,comm_status:a.isFollowUp?b("PageCommItemStatus").FOLLOW_UP:b("PageCommItemStatus").TODO,thread_fbid:c.toString()}}e.exports={transform:a}}),null);
__d("MercurySyncDeliveryReceiptTransformer",[],(function(a,b,c,d,e,f){"use strict";function a(a){return{delivery_receipts:[{other_user_fbid:a.threadKey.otherUserFbId?a.threadKey.otherUserFbId:"",thread_fbid:a.threadKey.threadFbId?a.threadKey.threadFbId:"",time:parseInt(a.deliveredWatermarkTimestampMs,10)}]}}e.exports={transform:a}}),null);
__d("MercurySyncMarkFolderChangeTransformer",["MercuryActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").CHANGE_FOLDER,other_user_fbid:a.threadKey.otherUserFbId,new_folder:b("MessagingTag").IRIS_MAPPING[a.folder]}}e.exports={transform:a}}),null);
__d("MercurySyncMarkFolderSeenTransformer",["MercuryGlobalActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.folders.map(function(c){return{action_type:b("MercuryGlobalActionType").MARK_ALL_SEEN,folder:b("MessagingTag").IRIS_MAPPING[c],timestamp:parseInt(a.timestamp,10)}})}e.exports={transform:a}}),null);
__d("MercurySyncMarkReadTransformer",["MercuryActionType","MercuryGlobalActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.folders&&a.folders.length>0?a.folders.map(function(c){return{action_type:b("MercuryGlobalActionType").MARK_ALL_READ,action_id:null,folder:b("MessagingTag").IRIS_MAPPING[c],timestamp:parseInt(a.watermarkTimestamp,10)}}):a.threadKeys.map(function(c){return{action_type:b("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:c.otherUserFbId,thread_fbid:c.threadFbId,mark_as_read:!0,timestamp:parseInt(a.watermarkTimestamp,10),folder:b("MessagingTag").INBOX}})}e.exports={transform:a}}),null);
__d("MercurySyncMarkUnreadTransformer",["MercuryActionType","MessagingTag"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.threadKeys.map(function(c){return{action_type:b("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:c.otherUserFbId,thread_fbid:c.threadFbId,mark_as_read:!1,timestamp:parseInt(a.watermarkTimestamp,10),folder:b("MessagingTag").INBOX}})}e.exports={transform:a}}),null);
__d("MercurySyncMessageDeleteTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").DELETE_MESSAGES,message_ids:a.messageIds,other_user_fbid:a.threadKey.otherUserFbId,thread_fbid:a.threadKey.threadFbId}}e.exports={transform:a}}),null);
__d("PagesMessagingEventType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FLAG:1,CREATE_ADMIN_NOTE:2,PRIORITY_UPDATE:3})}),null);
__d("MercurySyncPagesManagerEventTransformer",["MercuryActionType","PagesMessagingEventType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){var c=JSON.parse(a.jsonBlob),d=c&&c.type;if(!d)return undefined;switch(d){case b("PagesMessagingEventType").FLAG:d=!!(c&&c.flagData&&c.flagData.state);c={action_type:b("MercuryActionType").CHANGE_FLAG,mark_as_flag:d,other_user_fbid:a.threadKey.otherUserFbId,thread_fbid:a.threadKey.threadFbId};return c;default:return undefined}}e.exports={transform:a}}),null);
__d("MercurySyncParticipantLeftGroupThreadTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={removed_participants:[b("MercuryIDs").getParticipantIDFromUserID(c.leftParticipantFbId)]};a.log_message_type=b("MercuryLogMessageType").UNSUBSCRIBE;return a}e.exports={transform:a}}),null);
__d("MercurySyncParticipantsAddedToGroupThreadTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={added_participants:c.addedParticipants.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.userFbId)})};a.log_message_type=b("MercuryLogMessageType").SUBSCRIBE;return a}e.exports={transform:a}}),null);
__d("MercurySyncRTCEventLogTransformer",["MercuryActionType","MercuryIDs","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){var d=b("MercurySyncNewMessageTransformer").transform(a,c),e=c.messageMetadata.actorFbId;a=e===a?c.messageMetadata.threadKey.otherUserFbId:a;var f=c.eventType==="VOICE_EVENT"?b("MercuryLogMessageType").PHONE_CALL:b("MercuryLogMessageType").VIDEO_CALL;d.action_type=b("MercuryActionType").LOG_MESSAGE;d.log_message_body=c.messageMetadata.adminText;d.log_message_data={answered:c.duration>0,callee:b("MercuryIDs").getParticipantIDFromUserID(a),caller:b("MercuryIDs").getParticipantIDFromUserID(e)};d.log_message_type=f;return d}e.exports={transform:a}}),null);
__d("MercurySyncReadReceiptTransformer",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b={watermark:parseInt(a.watermarkTimestampMs,10),action:parseInt(a.actionTimestampMs,10)},c=a.threadKey.otherUserFbId||a.actorFbId;a=a.threadKey.otherUserFbId||a.threadKey.threadFbId;var d={roger:{}};d.roger[a]={};d.roger[a][c]=b;return d}e.exports={transform:a}}),null);
__d("MercurySyncReplaceMessageTransformer",["MercuryActionType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){c=Object.assign({},c.newMessage,c);return Object.assign(b("MercurySyncNewMessageTransformer").transform(a,c),{action_type:b("MercuryActionType").REPLACE_MESSAGE,replaced_message_id:c.replacedMessageId})}e.exports={transform:a}}),null);
__d("MercurySyncRtcCallDataTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){var c=a.messageMetadata.threadKey&&a.messageMetadata.threadKey.threadFbId?a.messageMetadata.threadKey.threadFbId.toString():undefined,d=a.initiator&&a.initiator.userFbId?a.initiator.userFbId.toString():undefined;return{action_type:b("MercuryActionType").UPDATE_RTC_CALL_DATA,thread_fbid:c,call_state:a.callState,server_info_data:a.serverInfoData,initiator_fbid:d}}e.exports={transform:a}}),null);
__d("MessagingThreadAction",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ACTION_INVALID:"ACTION_INVALID",ACTION_ARCHIVED:"ACTION_ARCHIVED",ACTION_UNARCHIVED:"ACTION_UNARCHIVED"})}),null);
__d("MercurySyncThreadActionTransformer",["MercuryActionType","MessagingThreadAction"],(function(a,b,c,d,e,f){"use strict";function a(a){a={action_type:b("MercuryActionType").CHANGE_ARCHIVED_STATUS,thread_fbid:a.threadKey.threadFbId,other_user_fbid:a.threadKey.otherUserFbId,archived:a.action===b("MessagingThreadAction").ACTION_ARCHIVED};return a}e.exports={transform:a}}),null);
__d("MercurySyncThreadAdminsAddToGroupTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").ADD_GROUP_ADMINS,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,added_admin_ids:a.addedAdmins.map(function(a){return a.userFbId})}}e.exports={transform:a}}),null);
__d("MercurySyncThreadAdminsRemovedFromGroupTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").REMOVE_GROUP_ADMINS,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,removed_admin_ids:a.removedAdminFbIds}}e.exports={transform:a}}),null);
__d("MessengerApprovalModeTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OPEN:0,APPROVALS:1})}),null);
__d("MercurySyncThreadApprovalModeTransformer",["MercuryActionType","MessengerApprovalModeTypes"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").APPROVAL_MODE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,approval_mode:b("MessengerApprovalModeTypes")[a.mode]}}e.exports={transform:a}}),null);
__d("MessengerApprovalQueueTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({REQUESTED:"REQUESTED",REMOVED:"REMOVED"})}),null);
__d("MessengerGroupRequestSource",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ADD:0,JOIN_THROUGH_LINK:1})}),null);
__d("MercurySyncThreadApprovalQueueTransformer",["MercuryActionType","MercuryIDs","MessengerApprovalQueueTypes","MessengerGroupRequestSource"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){if(a===null||a===undefined)return null;switch(a){case"ADD":return b("MessengerGroupRequestSource").ADD;case"JOIN_THROUGH_LINK":return b("MessengerGroupRequestSource").JOIN_THROUGH_LINK;default:return null}}function a(a){if(a.inviterFbId)return{action_type:b("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,removed_group_id:a.action===b("MessengerApprovalQueueTypes").REMOVED?a.recipientFbId:null,added_group_id:a.action===b("MessengerApprovalQueueTypes").REQUESTED?{requester:{id:a.recipientFbId},inviter:{id:a.inviterFbId},request_source:g(a.requestSource),request_timestamp:a.requestTimestamp}:null};var c=b("MercuryIDs").getParticipantIDFromUserID(a.recipientFbId);return{action_type:b("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,removed_id:a.action===b("MessengerApprovalQueueTypes").REMOVED?c:null,added_id:a.action===b("MessengerApprovalQueueTypes").REQUESTED?c:null}}e.exports={transform:a}}),null);
__d("MercurySyncThreadDeleteTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){return a.threadKeys.map(function(a){return{action_type:b("MercuryActionType").DELETE_THREAD,other_user_fbid:a.otherUserFbId,thread_fbid:a.threadFbId}})}e.exports={transform:a}}),null);
__d("MessengerJoinableModeType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PRIVATE:0,JOINABLE:1})}),null);
__d("MercurySyncThreadJoinableModeTransformer",["MercuryActionType","MessengerJoinableModeType"],(function(a,b,c,d,e,f){"use strict";function a(a){return{action_type:b("MercuryActionType").JOINABLE_MODE,action_id:null,thread_fbid:a.messageMetadata.threadKey.threadFbId,joinable_mode:{mode:b("MessengerJoinableModeType")[a.mode],link:a.link}}}e.exports={transform:a}}),null);
__d("MercurySyncThreadMuteSettingsTransformer",["MercuryActionType"],(function(a,b,c,d,e,f){"use strict";function a(a){a={action_type:b("MercuryActionType").CHANGE_MUTE_SETTINGS,thread_fbid:a.threadKey.threadFbId,other_user_fbid:a.threadKey.otherUserFbId,mute_until:parseInt(a.expireTime,10)};return a}e.exports={transform:a}}),null);
__d("MercurySyncThreadNameTransformer",["MercuryActionType","MercuryLogMessageType","MercurySyncNewMessageTransformer"],(function(a,b,c,d,e,f){"use strict";function a(a,c){a=b("MercurySyncNewMessageTransformer").transform(a,c);a.action_type=b("MercuryActionType").LOG_MESSAGE;a.log_message_body=c.messageMetadata.adminText;a.log_message_data={name:c.name};a.log_message_type=b("MercuryLogMessageType").THREAD_NAME;return a}e.exports={transform:a}}),null);
__d("MontageDispatcher",["ExplicitRegistrationDispatcher"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("ExplicitRegistrationDispatcher"));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=new a({strict:!1})}),null);
__d("MontageActions",["MontageDispatcher","keyMirror"],(function(a,b,c,d,e,f){"use strict";var g=b("keyMirror")({REQUEST_UPDATE:null,HAS_UPDATED:null});a={Types:g,requestUpdate:function(a){b("MontageDispatcher").dispatch({type:g.REQUEST_UPDATE,threadFBID:a})},hasUpdated:function(a){b("MontageDispatcher").dispatch({type:g.HAS_UPDATED,threadFBID:a})}};e.exports=a}),null);
__d("MercurySyncDispatcher",["MercuryDelayedDispatcher","MercuryGlobalActionType","MercuryPayloadSource","MercuryServerPayloadPreprocessor","MercurySyncThreadAdminsAddToGroupTransformer","MercurySyncThreadAdminsRemovedFromGroupTransformer","MercurySyncAdminTextMessageTransformer","MercurySyncClientPayloadTransformer","MercurySyncDeliveryReceiptTransformer","MercurySyncMarkFolderSeenTransformer","MercurySyncMarkReadTransformer","MercurySyncMarkUnreadTransformer","MercurySyncMessageDeleteTransformer","MercurySyncNewMessageTransformer","MercurySyncReadReceiptTransformer","MercurySyncPagesManagerEventTransformer","MercurySyncParticipantLeftGroupThreadTransformer","MercurySyncParticipantsAddedToGroupThreadTransformer","MercurySyncRTCEventLogTransformer","MercurySyncThreadDeleteTransformer","MercurySyncMarkFolderChangeTransformer","MercurySyncThreadMuteSettingsTransformer","MercurySyncThreadNameTransformer","MercurySyncThreadActionTransformer","MercurySyncReplaceMessageTransformer","MercurySyncThreadJoinableModeTransformer","MercurySyncThreadApprovalModeTransformer","MercurySyncThreadApprovalQueueTransformer","MercurySyncRtcCallDataTransformer","MercurySyncDeltaTypes","MercurySingletonProvider","MontageActions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="FOLDER_MONTAGE";a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$1=a,this.$2=b("MercuryDelayedDispatcher").getForFBID(this.$1),this.$3=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1)}a.prototype.process=function(a){__p&&__p();var c;void 0;var d=void 0;switch(a["class"]){case b("MercurySyncDeltaTypes").NewMessage:c=b("MercurySyncNewMessageTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ReplaceMessage:c=b("MercurySyncReplaceMessageTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").DeliveryReceipt:c=b("MercurySyncDeliveryReceiptTransformer").transform(a);this.$3.handleUpdate(c);break;case b("MercurySyncDeltaTypes").MarkRead:c=b("MercurySyncMarkReadTransformer").transform(a);var e=[],f=[];c.forEach(function(a){a.action_type===b("MercuryGlobalActionType").MARK_ALL_READ?e.push(a):f.push(a)});e.length&&this.$5(e);f.length&&this.$6(f);break;case b("MercurySyncDeltaTypes").MarkUnread:c=b("MercurySyncMarkUnreadTransformer").transform(a);this.$6(c);break;case b("MercurySyncDeltaTypes").ParticipantLeftGroupThread:c=b("MercurySyncParticipantLeftGroupThreadTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread:c=b("MercurySyncParticipantsAddedToGroupThreadTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").RTCEventLog:c=b("MercurySyncRTCEventLogTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ThreadName:c=b("MercurySyncThreadNameTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").ReadReceipt:c=b("MercurySyncReadReceiptTransformer").transform(a);this.$3.handleUpdate(c);break;case b("MercurySyncDeltaTypes").AdminTextMessage:c=b("MercurySyncAdminTextMessageTransformer").transform(this.$1,a);this.$4(c);break;case b("MercurySyncDeltaTypes").MessageDelete:d=a.threadKey.threadFbId;d&&a.folder&&a.folder===g?b("MontageActions").requestUpdate(d):(c=b("MercurySyncMessageDeleteTransformer").transform(a),this.$4(c));break;case b("MercurySyncDeltaTypes").ThreadAction:c=b("MercurySyncThreadActionTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ThreadDelete:c=b("MercurySyncThreadDeleteTransformer").transform(a);this.$6(c);break;case b("MercurySyncDeltaTypes").AdminAddedToGroupThread:c=b("MercurySyncThreadAdminsAddToGroupTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").AdminRemovedFromGroupThread:c=b("MercurySyncThreadAdminsRemovedFromGroupTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ThreadMuteSettings:c=b("MercurySyncThreadMuteSettingsTransformer").transform(a);this.$6([c]);break;case b("MercurySyncDeltaTypes").PagesManagerEvent:c=b("MercurySyncPagesManagerEventTransformer").transform(a);if(!c)return;this.$6([c]);break;case b("MercurySyncDeltaTypes").JoinableMode:c=b("MercurySyncThreadJoinableModeTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ApprovalMode:c=b("MercurySyncThreadApprovalModeTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ApprovalQueue:c=b("MercurySyncThreadApprovalQueueTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").ClientPayload:c=b("MercurySyncClientPayloadTransformer").transform(a,this.$1);if(!c)return;this.$4(c);break;case b("MercurySyncDeltaTypes").GenieMessage:c=b("MercurySyncNewMessageTransformer").transform(this.$1,a.deltaNewMessage);this.$4(c);break;case b("MercurySyncDeltaTypes").MontageMessage:d=a.newMessage.messageMetadata.actorFbId;d&&b("MontageActions").requestUpdate(d);break;case b("MercurySyncDeltaTypes").RtcCallData:c=b("MercurySyncRtcCallDataTransformer").transform(a);this.$4(c);break;case b("MercurySyncDeltaTypes").MarkFolderSeen:c=b("MercurySyncMarkFolderSeenTransformer").transform(a);this.$5(c);break;case b("MercurySyncDeltaTypes").ThreadFolder:c=b("MercurySyncMarkFolderChangeTransformer").transform(a);this.$6([c]);break;default:break}};a.prototype.$4=function(a){var c=a.other_user_fbid||a.thread_fbid;this.$2.handleUpdateWaitForThread({actions:[a],payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE},c)};a.prototype.$5=function(a){this.$3.handleUpdate({global_actions:a,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE})};a.prototype.$6=function(a){this.$3.handleUpdate({actions:a,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE})};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("MercurySyncForcedFetchHandler",["Promise","MercurySingletonProvider","MercurySyncDFFDataFetcher","MercuryMessages","MercuryThreadIDMap"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){return{getPayload:function(){return{sequence_id:a}}}}a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$1=a,this.$2=b("MercuryMessages").getForFBID(this.$1),this.$3=b("MercuryThreadIDMap").getForFBID(this.$1),this.$4=b("MercurySyncDFFDataFetcher").getForFBID(this.$1)}a.prototype.processMessageDFF=function(a,c,d,e){__p&&__p();if(e){e=c.otherUserFbId!==undefined?c.otherUserFbId.toString():c.threadFbId.toString();e=this.$3.getClientIDFromServerIDNow(e);if(e===undefined)return b("Promise").resolve(g(a));e=this.$2.getMessagesFromIDs([d]);if(e.length===0)return b("Promise").resolve(g(a))}return this.$4.fetchInvalidateMessage(c.otherUserFbId,c.threadFbId,d)};a.prototype.processThreadDFF=function(a,c,d){if(d){d=c.otherUserFbId!==undefined?c.otherUserFbId.toString():c.threadFbId.toString();d=this.$3.getClientIDFromServerIDNow(d);if(d===undefined)return b("Promise").resolve(g(a))}return this.$4.fetchInvalidateThreadState(c.otherUserFbId,c.threadFbId)};a.prototype.processGlobalDFFForGraphQL=function(){return this.$4.fetchInvalidateGlobalStateForGraphQL()};var h=new(b("MercurySingletonProvider"))(a);e.exports=a}),null);
__d("ContextualLayerAutoFlipHorizontal",["ContextualLayerAutoFlip"],(function(a,b,c,d,e,f){__p&&__p();var g;g=babelHelpers.inherits(a,b("ContextualLayerAutoFlip"));g&&g.prototype;a.prototype.getValidPositions=function(a){"use strict";return[a.getPosition()]};function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("MessengerContextualDialog.react",["cx","AccessibleLayer","ContextualLayerAutoFlipHorizontal","ContextualLayerUpdateOnScroll","LayerHideOnEscape","ReactAbstractContextualDialog","ReactLayer"],(function(a,b,c,d,e,f,g){"use strict";a=12;c=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({addedBehaviors:[b("ContextualLayerAutoFlipHorizontal"),b("ContextualLayerUpdateOnScroll"),b("LayerHideOnEscape"),b("AccessibleLayer")],displayName:"MessengerContextualDialog",shouldSetARIAProperties:!1,theme:{wrapperClassName:"_1r_9",arrowDimensions:{offset:a,length:16}}}));e.exports=c}),null);
__d("ImageReact.bs",["Image.react","ReasonReact.bs","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g,h,i){return b("ReasonReact.bs").wrapJsForReason(b("Image.react"),{className:b("bs_js_null_undefined").fromOption(a),alt:b("bs_js_null_undefined").fromOption(c),src:b("bs_js_null_undefined").fromOption(d),height:b("bs_js_null_undefined").fromOption(e),title:b("bs_js_null_undefined").fromOption(f),width:b("bs_js_null_undefined").fromOption(g),style:b("bs_js_null_undefined").fromOption(h)},i)}f.make=a}),null);
__d("MessengerSpinnerReact.bs",["cx","ix","fbt","React","ImageReact.bs","ReasonReact.bs","joinClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=h("86853"),k=h("86857"),l=h("86854"),m=b("ReasonReact.bs").statelessComponent("MessengerSpinnerReact");function n(a,c,d,e){__p&&__p();var f=a?a[0]:"",g=c?c[0]:"blue",h=d?d[0]:24,n=function(){var a=h===24;if(a){a=g==="blue";if(a)return j;else return k}else return l};return[m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],function(){return b("React").cloneElement(b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make([b("joinClasses")(f,"_3u55 _3qh2")],0,[n(0)],[h],0,[h],0,[])),{"aria-label":i._("Loading..."),"aria-busy":!0})},m[10],m[11],m[12],m[13]]}a=b("ReasonReact.bs").wrapReasonForJs(m,function(a){var b=a.className,c=a.color;a=a.size;return n([b==null?"":b],[c==null?"blue":c],[a==null?24:a],[])});c=32;d=24;f.large_size=c;f.medium_size=d;f.blue_src=j;f.grey_src=k;f.large_blue_src=l;f.component=m;f.make=n;f.jsComponent=a}),null);
__d("MessengerSpinner.react",["MessengerSpinnerReact.bs"],(function(a,b,c,d,e,f){e.exports=b("MessengerSpinnerReact.bs").jsComponent,e.exports.large_size=b("MessengerSpinnerReact.bs").large_size,e.exports.medium_size=b("MessengerSpinnerReact.bs").medium_size}),null);
__d("MNPlatformAttributionTags",[],(function(a,b,c,d,e,f){e.exports={ATTRIBUTION_TAGS_PREFIX:"bnp:trigger:",CUSTOMER_CHAT_PLUGIN:"customer_chat_plugin",MESSENGERDOTCOM:"messengerdotcom",MESSENGER_WEB:"messenger_web",MESSENGER_WEB_SEARCH:"messenger_web_search",M_DOT_ME:"m_dot_me"}}),null);
__d("MessengerDiscoveryLoggingEnums",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ENTRYPOINT_PREFIX:"entrypoint:"})}),null);
__d("MessengerDiscoveryEntryPointsLoggingHelper",["MessengerDiscoveryEntryPoint","MessengerDiscoveryLoggingEnums"],(function(a,b,c,d,e,f){"use strict";a={getEntryPointsLoggingTagStr:function(a){if(a.length==0||Object.values(b("MessengerDiscoveryEntryPoint")).indexOf(a[0])==-1)throw new Error("Please use enums in MessengerDiscoveryEntryPoints class");return b("MessengerDiscoveryLoggingEnums").ENTRYPOINT_PREFIX+a.join(":")}};e.exports=a}),null);
__d("LiveChatPluginConstants",[],(function(a,b,c,d,e,f){"use strict";a="LiveChatEvent/";b={DIALOG_TOGGLED:a+"dialog_toggled",STATE_UPDATE:a+"state",TYPING_UPDATE:a+"typing",UNREAD_COUNT_UPDATE:a+"unread_count",CONNECTED_STATE:"Connected",CONNECTING_STATE:"Connecting",DISCONNECTED_STATE:"Disconnected"};e.exports=b}),null);
__d("LiveChatPluginSessionUtil",["Arbiter","WebStorage","LiveChatPluginConstants"],(function(a,b,c,d,e,f){__p&&__p();var g={LIVECHAT_SESSION_PREFIX:"messenger_live_chat",LIVECHAT_SESSION_KEY:"messenger_live_chat_session_key",getChatStarted:function(){var a=this.getSessionState();return a&&a.chatStarted||!1},setChatStarted:function(a){var b=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},b,{chatStarted:a}))},setRefSent:function(a){var b=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},b,{refSent:a}))},getRefSent:function(){var a=this.getSessionState();return a&&a.refSent||!1},getIsDialogHidden:function(){var a=this.getSessionState();return a&&a.isDialogHidden||!1},setIsDialogHidden:function(a){var c=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},c,{isDialogHidden:a}));b("Arbiter").inform(b("LiveChatPluginConstants").DIALOG_TOGGLED,a)},getRequestID:function(){var a=this.getSessionState();return a&&a.requestID||""},setRequestID:function(a){var b=this.getSessionState();this.setSessionState(babelHelpers["extends"]({},b,{requestID:a}))},setCurrentSessionKey:function(a,c,d){var e=b("WebStorage").getSessionStorage();e&&e.setItem(g.LIVECHAT_SESSION_KEY,this.getSessionKey(a,c,d))},getCurrentSessionKey:function(){var a=b("WebStorage").getSessionStorage();return a?a.getItem(g.LIVECHAT_SESSION_KEY):null},getSessionState:function(){__p&&__p();try{var a=b("WebStorage").getSessionStorageForRead();if(a){var c=this.getCurrentSessionKey();if(!c)return null;a=a.getItem(c);if(a)return JSON.parse(a)}return null}catch(a){return null}},setSessionState:function(a){var c=b("WebStorage").getSessionStorage();if(c){var d=this.getCurrentSessionKey();d&&c.setItem(d,JSON.stringify(a))}},removeSessionState:function(a){var c=b("WebStorage").getSessionStorage();c&&a&&c.removeItem(a)},getSessionKey:function(a,b,c){return g.LIVECHAT_SESSION_PREFIX+"_"+a+"_"+b+"_"+c}};e.exports=g}),null);
__d("MessengerLiveChatPluginEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PLUGIN_REQUESTED:"plugin_requested",PLUGIN_REQUEST_BLOCKED:"plugin_request_blocked",PLUGIN_REQUEST_FAILED:"plugin_request_failed",PLUGIN_LOADED:"plugin_loaded",LOGGED_IN_CHAT_NOW_PROMPT_RENDERED:"logged_in_chat_now_prompt_rendered",ANONYMOUS_CHAT_NOW_PROMPT_RENDERED:"anonymous_chat_now_prompt_rendered",CHAT_DIALOG_RENDERED:"chat_dialog_rendered",RATE_LIMIT_REACHED:"rate_limit_reached",PLUGIN_TTI:"plugin_tti",CHAT_DISPLAY_DONE:"chat_display_done",LOG_IN_TO_MESSENGER_CLICKED:"log_in_to_messenger_clicked",CHAT_NOW_CLICKED:"chat_now_clicked",NOT_YOU_CLICKED:"not_you_clicked",M_DOT_ME_LINK_CLICKED:"m_dot_me_link_clicked",MOBILE_LOGIN_PROMPT_REQUESTED:"mobile_login_prompt_requested",CONTINUE_AS_CLICKED:"continue_as_clicked",CONTINUE_AS_PROMPT_REQUESTED:"continue_as_prompt_requested",CONTINUE_AS_SUCCEED:"continue_as_succeed",CHAT_NOW_PROMPT_CLOSED:"chat_now_prompt_closed",CHAT_NOW_PROMPT_OPENED:"chat_now_prompt_opened",CHAT_DIALOG_CLOSED:"chat_dialog_closed",CHAT_DIALOG_OPENED:"chat_dialog_opened",BOT_MENU_OPENED:"bot_menu_opened",BOT_MENU_CLOSED:"bot_menu_closed",BOT_MENU_POSTBACK_CLICKED:"bot_menu_postback_clicked",BOT_MENU_URL_REDIRECT_CLICKED:"bot_menu_url_redirect_clicked",MUTE_CONVERSATION_CLICKED:"mute_conversation_clicked",UNMUTE_CONVERSATION_CLICKED:"unmute_conversation_clicked",INFORMATION_BUTTON_OPENED:"information_button_opened",INFORMATION_BUTTON_CLOSED:"information_button_closed",BLOCK_MESSAGE_CLICKED:"block_message_clicked",UNBLOCK_MESSAGE_CLICKED:"unblock_message_clicked",VIEW_ON_MESSENGER_CLICKED:"view_on_messenger_clicked",VISIT_FACEBOOK_CLICKED:"visit_facebook_clicked",LANDING_PAGE_LINK_CLICKED:"landing_page_link_clicked",MESSAGE_SENT:"message_sent",LIKE_BUTTON_CLICKED:"like_button_clicked",QUICK_REPLY_CLICKED:"quick_reply_clicked",POSTBACK_CLICKED:"postback_clicked",REF_PARAM_SENT:"ref_param_sent",REF_PARAM_SEND_FAILED:"ref_param_send_failed",ADD_THREAD_ASSOC_FAILED:"add_thread_assoc_failed",REMOVE_THREAD_ASSOC_FAILED:"remove_thread_assoc_failed",MUTE_SETTTING_CHANGE_FAILED:"mute_setting_change_failed",IRIS_SUBSCRIBE_SUCCEED:"iris_subscribe_succeed",IRIS_SUBSCRIBE_FAILED:"iris_subscribe_failed",IRIS_UNSUBSCRIBE_SUCCEED:"iris_unsubscribe_succeed",IRIS_UNSUBSCRIBE_FAILED:"iris_unsubscribe_failed",AUTHENTICATION_FAILED:"authentication_failed",INIT_CONNECTION:"init_connection",DELTA_RECEIVED:"delta_received",DELTA_PARSING_ERROR:"delta_parsing_error",MQTT_CONNECTION_INITIATED:"mqtt_connection_initiated",MQTT_CONNECTION_STATE_CHANGED:"mqtt_connection_state_changed",CUSTOMER_CHAT_TAG_FOUND:"customer_chat_tag_found",CUSTOMER_CHAT_TAG_NOT_FOUND:"customer_chat_tag_not_found"})}),null);
__d("LiveChatPluginLoggerUtil",["BanzaiODS","LiveChatPluginSessionUtil","MessengerDiscoveryEntryPoint","MessengerDiscoveryEntryPointsLoggingHelper","MessengerLiveChatPluginEvent","MessengerLiveChatPluginTypedLogger","MNPlatformAttributionTags","emptyFunction","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={logAction:function(a,c,d,e){var f=arguments.length<=4||arguments[4]===undefined?null:arguments[4],g=arguments.length<=5||arguments[5]===undefined?null:arguments[5],h=arguments.length<=6||arguments[6]===undefined?null:arguments[6],i=b("LiveChatPluginSessionUtil").getRequestID();new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(c).setPageID(d).setRequestID(i).setEvent(a).setEventTimestamp(Date.now()).setDebugData(e).setThemeColor(f).setLoggedInGreeting(g).setLoggedOutGreeting(h).logVital()},logTTI:function(a,c,d){this.logTTI=b("emptyFunction");d=b("performanceAbsoluteNow")()-d;new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(a).setPageID(c).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setDuration(d).setEvent(b("MessengerLiveChatPluginEvent").PLUGIN_TTI).setEventTimestamp(Date.now()).logVital()},logDelta:function(a,c,d,e,f,g){new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(a).setPageID(c).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setDebugData(JSON.stringify({isShadow:f,seqId:g})).setEvent(b("MessengerLiveChatPluginEvent").DELTA_RECEIVED).setDeltaType(d).setGateway(e).setEventTimestamp(Date.now()).log(),b("BanzaiODS").bumpEntityKey("messenger_commerce","customer_chat_plugin.client."+e+".delta_received."+d)},logChatDisplayDone:function(a,c,d){this.logChatDisplayDone=b("emptyFunction");d=b("performanceAbsoluteNow")()-d;new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(a).setPageID(c).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setDuration(d).setEvent(b("MessengerLiveChatPluginEvent").CHAT_DISPLAY_DONE).setEventTimestamp(Date.now()).logVital()},getAttributionTags:function(){var a=[b("MessengerDiscoveryEntryPoint").CUSTOMER_CHAT_PLUGIN];return[b("MNPlatformAttributionTags").ATTRIBUTION_TAGS_PREFIX+b("MNPlatformAttributionTags").CUSTOMER_CHAT_PLUGIN,b("MessengerDiscoveryEntryPointsLoggingHelper").getEntryPointsLoggingTagStr(a)]}};e.exports=a}),null);
__d("MessengerLiveChatPluginGateway",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({MQTT:"mqtt",ICEBREAKER:"icebreaker"})}),null);
__d("LiveChatIcebreakerClient",["Arbiter","ChannelConstants","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MessengerLiveChatPluginEvent","MessengerLiveChatPluginGateway","MessengerLiveChatPluginTypedLogger","Random","URI","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=(b("Random").random()*2147483648|0).toString(16),h=20,i=2e3,j={CONNECTING:0,OPEN:1,CLOSED:2};function a(a,c,d,e){__p&&__p();this.$7=function(a){__p&&__p();try{a=JSON.parse(a.data);var c=a&&a.delta&&a.delta["class"]||"unknown",d=!this.$5&&!b("gkx")("AT7JCav-mnZaXvxvDZIStsaHGOzW3wm3IcqOSc7xoesh9oMNPR0bSOyfLxBj6PCvVKOi8MrYYxdqv_TpZOkUtcGctqpnKAug6HnuZMaG4wXC1Q");if(d){var e=b("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":b("ChannelConstants").getArbiterType("delta");b("Arbiter").inform(e,{obj:a})}e=a&&a.iseq;e&&(this.$2=e);b("LiveChatPluginLoggerUtil").logDelta(this.$4,this.$1,c,b("MessengerLiveChatPluginGateway").ICEBREAKER,!d,e)}catch(a){new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$4).setPageID(this.$1).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").DELTA_PARSING_ERROR).setEventTimestamp(Date.now()).logVital()}}.bind(this),this.$1=a,this.$2=0,this.$4=c,this.$5=e,this.$3=new(b("URI"))("https://streaming-graph.facebook.com/messenger_livechat").addQueryData("pageId",this.$1).addQueryData("appId",225396507985893).addQueryData("userId",c).addQueryData("accountId",c).addQueryData("deviceId",g).addQueryData("requestId",b("LiveChatPluginSessionUtil").getRequestID()).addQueryData("originDomain",d)}a.prototype.connectWithRetries=function(){__p&&__p();var a=arguments.length<=0||arguments[0]===undefined?0:arguments[0];try{if(!window.EventSource)return;if(a>h)return;this.$6=new EventSource(this.$3.addQueryData("irisSeqId",this.$2).toString(),{withCredentials:!0});this.$6.addEventListener("iris_delta",this.$7);this.$6.addEventListener("error",function(b){this.$6.readyState===j.CLOSED&&setTimeout(function(){this.connectWithRetries(a+1)}.bind(this),i)}.bind(this))}catch(b){this.disconnect(),setTimeout(function(){this.connectWithRetries(a+1)}.bind(this),i)}};a.prototype.disconnect=function(){this.$6&&this.$6.close()};e.exports=a}),null);
__d("MqttLogger",["BanzaiODS","Log","LogHistory","MarauderLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="mqtt_client",h=null,i={CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish"};j.getInstance=function(){h||(h=new j());return h};function j(){this.$1=b("LogHistory").getInstance(g),this.$2=null}j.prototype.setAppId=function(a){this.$2||(this.$2=a)};j.prototype.logConnect=function(a){this.bumpCounter(i.CONNECT+"."+a.status),this.$3(i.CONNECT,a)};j.prototype.logDisconnect=function(a){this.bumpCounter(i.DISCONNECT),this.$3(i.DISCONNECT,a)};j.prototype.logPublish=function(a){this.bumpCounter(i.PUBLISH+"."+a.topic),this.$3(i.PUBLISH,a)};j.prototype.logError=function(event,a){this.$1.error(event,a)};j.prototype.debugTrace=function(event,a){this.$1.debug(event,a)};j.prototype.bumpCounter=function(a){this.$2&&b("BanzaiODS").bumpEntityKey("mqtt_ws_client",this.$2+"."+a),b("BanzaiODS").bumpEntityKey("mqtt_ws_client",a)};j.prototype.$3=function(event,a){a.user_agent=navigator.userAgent;a.platform=navigator.platform;a.href=window.location.href;var c=JSON.stringify(a);this.$1.log(event,c);b("MarauderLogger").log(event,g,a)};e.exports=j}),null);
/**
 * License: https://www.facebook.com/legal/license/-SPK4hgBf7r/
 */
__d("paho-mqtt",[],(function(a,b,c,d,e,f){__p&&__p();(function(a,b){typeof f==="object"&&typeof e==="object"?e.exports=b():typeof define==="function"&&define.amd?define(b):typeof f==="object"?f=b():(typeof a.Paho==="undefined"&&(a.Paho={}),a.Paho.MQTT=b())})(this,function(){__p&&__p();var b=function(b){__p&&__p();var c="@VERSION@",d={CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,PUBREC:5,PUBREL:6,PUBCOMP:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14},e=function(a,b){__p&&__p();for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))if(Object.prototype.hasOwnProperty.call(b,c)){if(typeof a[c]!==b[c])throw new Error(i(g.INVALID_TYPE,[typeof a[c],c]))}else{var d="Unknown property, "+c+". Valid properties are:";for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&(d=d+" "+e);throw new Error(d)}},f=function(a,b){return function(){return a.apply(b,arguments)}},g={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed: code {0} reason {1} wasClean {2}."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."},BUFFER_FULL:{code:18,text:"AMQJS0018E Message buffer is full, maximum buffer size: {0}."}},h={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},i=function(a,b){__p&&__p();a=a.text;if(b){var c,d;for(var e=0;e<b.length;e++){c="{"+e+"}";d=a.indexOf(c);if(d>0){var f=a.substring(0,d);d=a.substring(d+c.length);a=f+b[e]+d}}}return a},j=[0,6,77,81,73,115,100,112,3],k=[0,4,77,81,84,84,4],l=function(a,b){this.type=a;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(this[c]=b[c])};l.prototype.encode=function(){__p&&__p();var a=(this.type&15)<<4,b=0,c=[],e=0,f;this.messageIdentifier!==undefined&&(b+=2);switch(this.type){case d.CONNECT:switch(this.mqttVersion){case 3:b+=j.length+3;break;case 4:b+=k.length+3;break}b+=r(this.clientId)+2;this.willMessage!==undefined&&(b+=r(this.willMessage.destinationName)+2,f=this.willMessage.payloadBytes,f instanceof Uint8Array||(f=new Uint8Array(h)),b+=f.byteLength+2);this.userName!==undefined&&(b+=r(this.userName)+2);this.password!==undefined&&(b+=r(this.password)+2);break;case d.SUBSCRIBE:a|=2;for(var g=0;g<this.topics.length;g++)c[g]=r(this.topics[g]),b+=c[g]+2;b+=this.requestedQos.length;break;case d.UNSUBSCRIBE:a|=2;for(var g=0;g<this.topics.length;g++)c[g]=r(this.topics[g]),b+=c[g]+2;break;case d.PUBREL:a|=2;break;case d.PUBLISH:this.payloadMessage.duplicate&&(a|=8);a=a|=this.payloadMessage.qos<<1;this.payloadMessage.retained&&(a|=1);e=r(this.payloadMessage.destinationName);b+=e+2;var h=this.payloadMessage.payloadBytes;b+=h.byteLength;h instanceof ArrayBuffer?h=new Uint8Array(h):h instanceof Uint8Array||(h=new Uint8Array(h.buffer));break;case d.DISCONNECT:break;default:break}var i=q(b),l=i.length+1;b=new ArrayBuffer(b+l);var m=new Uint8Array(b);m[0]=a;m.set(i,1);if(this.type==d.PUBLISH)l=o(this.payloadMessage.destinationName,e,m,l);else if(this.type==d.CONNECT){switch(this.mqttVersion){case 3:m.set(j,l);l+=j.length;break;case 4:m.set(k,l);l+=k.length;break}a=0;this.cleanSession&&(a=2);this.willMessage!==undefined&&(a|=4,a|=this.willMessage.qos<<3,this.willMessage.retained&&(a|=32));this.userName!==undefined&&(a|=128);this.password!==undefined&&(a|=64);m[l++]=a;l=n(this.keepAliveInterval,m,l)}this.messageIdentifier!==undefined&&(l=n(this.messageIdentifier,m,l));switch(this.type){case d.CONNECT:l=o(this.clientId,r(this.clientId),m,l);this.willMessage!==undefined&&(l=o(this.willMessage.destinationName,r(this.willMessage.destinationName),m,l),l=n(f.byteLength,m,l),m.set(f,l),l+=f.byteLength);this.userName!==undefined&&(l=o(this.userName,r(this.userName),m,l));this.password!==undefined&&(l=o(this.password,r(this.password),m,l));break;case d.PUBLISH:m.set(h,l);break;case d.SUBSCRIBE:for(var g=0;g<this.topics.length;g++)l=o(this.topics[g],c[g],m,l),m[l++]=this.requestedQos[g];break;case d.UNSUBSCRIBE:for(var g=0;g<this.topics.length;g++)l=o(this.topics[g],c[g],m,l);break;default:}return b};function m(a,b){__p&&__p();var c=b,e=a[b],f=e>>4;e=e&=15;b+=1;var g,h=0,i=1;do{if(b==a.length)return[null,c];g=a[b++];h+=(g&127)*i;i*=128}while((g&128)!==0);g=b+h;if(g>a.length)return[null,c];i=new l(f);switch(f){case d.CONNACK:h=a[b++];h&1&&(i.sessionPresent=!0);i.returnCode=a[b++];break;case d.PUBLISH:c=e>>1&3;f=p(a,b);b+=2;h=t(a,b,f);b+=f;c>0&&(i.messageIdentifier=p(a,b),b+=2);f=new y(a.subarray(b,g));(e&1)==1&&(f.retained=!0);(e&8)==8&&(f.duplicate=!0);f.qos=c;f.destinationName=h;i.payloadMessage=f;break;case d.PUBACK:case d.PUBREC:case d.PUBREL:case d.PUBCOMP:case d.UNSUBACK:i.messageIdentifier=p(a,b);break;case d.SUBACK:i.messageIdentifier=p(a,b);b+=2;i.returnCode=a.subarray(b,g);break;default:break}return[i,g]}function n(a,b,c){b[c++]=a>>8;b[c++]=a%256;return c}function o(a,b,c,d){d=n(b,c,d);s(a,c,d);return d+b}function p(a,b){return 256*a[b]+a[b+1]}function q(a){var b=new Array(1),c=0;do{var d=a%128;a=a>>7;a>0&&(d|=128);b[c++]=d}while(a>0&&c<4);return b}function r(a){var b=0;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);d>2047?(55296<=d&&d<=56319&&(c++,b++),b+=3):d>127?b+=2:b++}return b}function s(a,b,c){__p&&__p();c=c;for(var d=0;d<a.length;d++){var e=a.charCodeAt(d);if(55296<=e&&e<=56319){var f=a.charCodeAt(++d);if(isNaN(f))throw new Error(i(g.MALFORMED_UNICODE,[e,f]));e=(e-55296<<10)+(f-56320)+65536}e<=127?b[c++]=e:e<=2047?(b[c++]=e>>6&31|192,b[c++]=e&63|128):e<=65535?(b[c++]=e>>12&15|224,b[c++]=e>>6&63|128,b[c++]=e&63|128):(b[c++]=e>>18&7|240,b[c++]=e>>12&63|128,b[c++]=e>>6&63|128,b[c++]=e&63|128)}return b}function t(a,b,c){__p&&__p();var d="",e,f=b;while(f<b+c){var h=a[f++];if(h<128)e=h;else{var j=a[f++]-128;if(j<0)throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),""]));if(h<224)e=64*(h-192)+j;else{var k=a[f++]-128;if(k<0)throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),k.toString(16)]));if(h<240)e=4096*(h-224)+64*j+k;else{var l=a[f++]-128;if(l<0)throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),k.toString(16),l.toString(16)]));if(h<248)e=262144*(h-240)+4096*j+64*k+l;else throw new Error(i(g.MALFORMED_UTF,[h.toString(16),j.toString(16),k.toString(16),l.toString(16)]))}}}e>65535&&(e-=65536,d+=String.fromCharCode(55296+(e>>10)),e=56320+(e&1023));d+=String.fromCharCode(e)}return d}var u=function(a,b,c){__p&&__p();this._client=a;this._window=b;this._keepAliveInterval=c*1e3;this.isReset=!1;var e=new l(d.PINGREQ).encode(),f=function(a){return function(){return h.apply(a)}},h=function(){!this.isReset?(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(g.PING_TIMEOUT.code,i(g.PING_TIMEOUT))):(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(e),this.timeout=this._window.setTimeout(f(this),this._keepAliveInterval))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),this._keepAliveInterval>0&&(this.timeout=setTimeout(f(this),this._keepAliveInterval))};this.cancel=function(){this._window.clearTimeout(this.timeout)}},v=function(a,b,c,d,e){this._window=b;c||(c=30);b=function(b,a,c){return function(){return b.apply(a,c)}};this.timeout=setTimeout(b(d,a,e),c*1e3);this.cancel=function(){this._window.clearTimeout(this.timeout)}},w=function(a,c,d,e,f){__p&&__p();if(!("WebSocket"in b&&b.WebSocket!==null))throw new Error(i(g.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in b&&b.localStorage!==null))throw new Error(i(g.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in b&&b.ArrayBuffer!==null))throw new Error(i(g.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",a,c,d,e,f);this.host=c;this.port=d;this.path=e;this.uri=a;this.clientId=f;this._wsuri=null;this._localKey=c+":"+d+(e!="/mqtt"?":"+e:"")+":"+f+":";this._msg_queue=[];this._buffered_msg_queue=[];this._sentMessages={};this._receivedMessages={};this._notify_msg_sent={};this._message_identifier=1;this._sequence=0;for(var h in localStorage)(h.indexOf("Sent:"+this._localKey)===0||h.indexOf("Received:"+this._localKey)===0)&&this.restore(h)};w.prototype.host=null;w.prototype.port=null;w.prototype.path=null;w.prototype.uri=null;w.prototype.clientId=null;w.prototype.socket=null;w.prototype.connected=!1;w.prototype.maxMessageIdentifier=65536;w.prototype.connectOptions=null;w.prototype.hostIndex=null;w.prototype.onConnected=null;w.prototype.onConnectionLost=null;w.prototype.onMessageDelivered=null;w.prototype.onMessageArrived=null;w.prototype.traceFunction=null;w.prototype._msg_queue=null;w.prototype._buffered_msg_queue=null;w.prototype._connectTimeout=null;w.prototype.sendPinger=null;w.prototype.receivePinger=null;w.prototype._reconnectInterval=1;w.prototype._reconnecting=!1;w.prototype._reconnectTimeout=null;w.prototype.disconnectedPublishing=!1;w.prototype.disconnectedBufferSize=5e3;w.prototype.receiveBuffer=null;w.prototype._traceBuffer=null;w.prototype._MAX_TRACE_ENTRIES=100;w.prototype.connect=function(a){__p&&__p();var b=this._traceMask(a,"password");this._trace("Client.connect",b,this.socket,this.connected);if(this.connected)throw new Error(i(g.INVALID_STATE,["already connected"]));if(this.socket)throw new Error(i(g.INVALID_STATE,["already connected"]));this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1);this.connectOptions=a;this._reconnectInterval=1;this._reconnecting=!1;a.uris?(this.hostIndex=0,this._doConnect(a.uris[0])):this._doConnect(this.uri)};w.prototype.subscribe=function(a,b){__p&&__p();this._trace("Client.subscribe",a,b);if(!this.connected)throw new Error(i(g.INVALID_STATE,["not connected"]));var c=new l(d.SUBSCRIBE);c.topics=[a];b.qos!==undefined?c.requestedQos=[b.qos]:c.requestedQos=[0];b.onSuccess&&(c.onSuccess=function(a){b.onSuccess({invocationContext:b.invocationContext,grantedQos:a})});b.onFailure&&(c.onFailure=function(a){b.onFailure({invocationContext:b.invocationContext,errorCode:a,errorMessage:i(a)})});b.timeout&&(c.timeOut=new v(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:g.SUBSCRIBE_TIMEOUT.code,errorMessage:i(g.SUBSCRIBE_TIMEOUT)}]));this._requires_ack(c);this._schedule_message(c)};w.prototype.unsubscribe=function(a,b){__p&&__p();this._trace("Client.unsubscribe",a,b);if(!this.connected)throw new Error(i(g.INVALID_STATE,["not connected"]));var c=new l(d.UNSUBSCRIBE);c.topics=[a];b.onSuccess&&(c.callback=function(){b.onSuccess({invocationContext:b.invocationContext})});b.timeout&&(c.timeOut=new v(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:g.UNSUBSCRIBE_TIMEOUT.code,errorMessage:i(g.UNSUBSCRIBE_TIMEOUT)}]));this._requires_ack(c);this._schedule_message(c)};w.prototype.send=function(a){__p&&__p();this._trace("Client.send",a);wireMessage=new l(d.PUBLISH);wireMessage.payloadMessage=a;if(this.connected)a.qos>0?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),this._schedule_message(wireMessage);else if(this._reconnecting&&this.disconnectedPublishing){var b=Object.keys(this._sentMessages).length+this._buffered_msg_queue.length;if(b>this.disconnectedBufferSize)throw new Error(i(g.BUFFER_FULL,[this.disconnectedBufferSize]));else a.qos>0?this._requires_ack(wireMessage):(wireMessage.sequence=++this._sequence,this._buffered_msg_queue.push(wireMessage))}else throw new Error(i(g.INVALID_STATE,["not connected"]))};w.prototype.disconnect=function(){this._trace("Client.disconnect");this._reconnecting&&(this._reconnectTimeout.cancel(),this._reconnectTimeout=null,this._reconnecting=!1);if(!this.socket)throw new Error(i(g.INVALID_STATE,["not connecting or connected"]));wireMessage=new l(d.DISCONNECT);this._notify_msg_sent[wireMessage]=f(this._disconnected,this);this._schedule_message(wireMessage)};w.prototype.getTraceLog=function(){if(this._traceBuffer!==null){this._trace("Client.getTraceLog",new Date());this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var a in this._sentMessages)this._trace("_sentMessages ",a,this._sentMessages[a]);for(var a in this._receivedMessages)this._trace("_receivedMessages ",a,this._receivedMessages[a]);return this._traceBuffer}};w.prototype.startTrace=function(){this._traceBuffer===null&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date(),c)};w.prototype.stopTrace=function(){delete this._traceBuffer};w.prototype._doConnect=function(a){__p&&__p();if(this.connectOptions.useSSL){var b=a.split(":");b[0]="wss";a=b.join(":")}this._wsuri=a;this.connected=!1;this.connectOptions.ignoreSubProtocol?this.socket=new WebSocket(a):this.connectOptions.mqttVersion<4?this.socket=new WebSocket(a,["mqttv3.1"]):this.socket=new WebSocket(a,["mqtt"]);this.socket.binaryType="arraybuffer";this.socket.onopen=f(this._on_socket_open,this);this.socket.onmessage=f(this._on_socket_message,this);this.socket.onerror=f(this._on_socket_error,this);this.socket.onclose=f(this._on_socket_close,this);this.sendPinger=new u(this,window,this.connectOptions.keepAliveInterval);this.receivePinger=new u(this,window,this.connectOptions.keepAliveInterval);this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null);this._connectTimeout=new v(this,window,this.connectOptions.timeout,this._disconnected,[g.CONNECT_TIMEOUT.code,i(g.CONNECT_TIMEOUT)])};w.prototype._schedule_message=function(a){this._msg_queue.push(a),this.connected&&this._process_queue()};w.prototype.store=function(a,b){};w.prototype.restore=function(a){};w.prototype._process_queue=function(){var a=null,b=this._msg_queue.reverse();while(a=b.pop())this._socket_send(a),this._notify_msg_sent[a]&&(this._notify_msg_sent[a](),delete this._notify_msg_sent[a])};w.prototype._requires_ack=function(a){var b=Object.keys(this._sentMessages).length;if(b>this.maxMessageIdentifier)throw Error("Too many messages:"+b);while(this._sentMessages[this._message_identifier]!==undefined)this._message_identifier++;a.messageIdentifier=this._message_identifier;this._sentMessages[a.messageIdentifier]=a;a.type===d.PUBLISH&&this.store("Sent:",a);this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)};w.prototype._on_socket_open=function(){var a=new l(d.CONNECT,this.connectOptions);a.clientId=this.clientId;this._socket_send(a)};w.prototype._on_socket_message=function(event){this._trace("Client._on_socket_message",event.data);var a=this._deframeMessages(event.data);for(var b=0;b<a.length;b+=1)this._handleMessage(a[b])};w.prototype._deframeMessages=function(a){__p&&__p();a=new Uint8Array(a);var b=[];if(this.receiveBuffer){var c=new Uint8Array(this.receiveBuffer.length+a.length);c.set(this.receiveBuffer);c.set(a,this.receiveBuffer.length);a=c;delete this.receiveBuffer}try{c=0;while(c<a.length){var d=m(a,c),e=d[0];c=d[1];if(e!==null)b.push(e);else break}c<a.length&&(this.receiveBuffer=a.subarray(c))}catch(a){d=Object.prototype.hasOwnProperty.call(a,"stack")=="undefined"?a.stack.toString():"No Error Stack Available";this._disconnected(g.INTERNAL_ERROR.code,i(g.INTERNAL_ERROR,[a.message,d]));return}return b};w.prototype._handleMessage=function(a){__p&&__p();this._trace("Client._handleMessage",a);try{switch(a.type){case d.CONNACK:this._connectTimeout.cancel();this._reconnectTimeout&&this._reconnectTimeout.cancel();if(this.connectOptions.cleanSession){for(var b in this._sentMessages){var c=this._sentMessages[b];localStorage.removeItem("Sent:"+this._localKey+c.messageIdentifier)}this._sentMessages={};for(var b in this._receivedMessages){var e=this._receivedMessages[b];localStorage.removeItem("Received:"+this._localKey+e.messageIdentifier)}this._receivedMessages={}}if(a.returnCode===0)this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length);else{this._disconnected(g.CONNACK_RETURNCODE.code,i(g.CONNACK_RETURNCODE,[a.returnCode,h[a.returnCode]]));break}var f=[];for(var j in this._sentMessages)Object.prototype.hasOwnProperty.call(this._sentMessages,j)&&f.push(this._sentMessages[j]);if(this._buffered_msg_queue.length>0){var k=null,m=this._buffered_msg_queue.reverse();while(k=m.pop())f.push(k),this.onMessageDelivered&&(this._notify_msg_sent[k]=this.onMessageDelivered(k.payloadMessage))}var f=f.sort(function(a,b){return a.sequence-b.sequence});for(var m=0,k=f.length;m<k;m++){var c=f[m];if(c.type==d.PUBLISH&&c.pubRecReceived){var n=new l(d.PUBREL,{messageIdentifier:c.messageIdentifier});this._schedule_message(n)}else this._schedule_message(c)}this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext});m=!1;this._reconnecting&&(m=!0,this._reconnectInterval=1,this._reconnecting=!1);this._connected(m,this._wsuri);this._process_queue();break;case d.PUBLISH:this._receivePublish(a);break;case d.PUBACK:var c=this._sentMessages[a.messageIdentifier];c&&(delete this._sentMessages[a.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+a.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(c.payloadMessage));break;case d.PUBREC:var c=this._sentMessages[a.messageIdentifier];if(c){c.pubRecReceived=!0;var n=new l(d.PUBREL,{messageIdentifier:a.messageIdentifier});this.store("Sent:",c);this._schedule_message(n)}break;case d.PUBREL:var e=this._receivedMessages[a.messageIdentifier];localStorage.removeItem("Received:"+this._localKey+a.messageIdentifier);e&&(this._receiveMessage(e),delete this._receivedMessages[a.messageIdentifier]);k=new l(d.PUBCOMP,{messageIdentifier:a.messageIdentifier});this._schedule_message(k);break;case d.PUBCOMP:var c=this._sentMessages[a.messageIdentifier];delete this._sentMessages[a.messageIdentifier];localStorage.removeItem("Sent:"+this._localKey+a.messageIdentifier);this.onMessageDelivered&&this.onMessageDelivered(c.payloadMessage);break;case d.SUBACK:var c=this._sentMessages[a.messageIdentifier];c&&(c.timeOut&&c.timeOut.cancel(),a.returnCode[0]===128?c.onFailure&&c.onFailure(a.returnCode):c.onSuccess&&c.onSuccess(a.returnCode),delete this._sentMessages[a.messageIdentifier]);break;case d.UNSUBACK:var c=this._sentMessages[a.messageIdentifier];c&&(c.timeOut&&c.timeOut.cancel(),c.callback&&c.callback(),delete this._sentMessages[a.messageIdentifier]);break;case d.PINGRESP:this.sendPinger.reset();break;case d.DISCONNECT:this._disconnected(g.INVALID_MQTT_MESSAGE_TYPE.code,i(g.INVALID_MQTT_MESSAGE_TYPE,[a.type]));break;default:this._disconnected(g.INVALID_MQTT_MESSAGE_TYPE.code,i(g.INVALID_MQTT_MESSAGE_TYPE,[a.type]))}}catch(a){f=Object.prototype.hasOwnProperty.call(a,"stack")=="undefined"?a.stack.toString():"No Error Stack Available";this._disconnected(g.INTERNAL_ERROR.code,i(g.INTERNAL_ERROR,[a.message,f]));return}};w.prototype._on_socket_error=function(a){this._reconnecting||this._disconnected(g.SOCKET_ERROR.code,i(g.SOCKET_ERROR,[a.data]))};w.prototype._on_socket_close=function(event){this._reconnecting||this._disconnected(g.SOCKET_CLOSE.code,i(g.SOCKET_CLOSE,event!=null?[event.code,event.reason,event.wasClean]:[]))};w.prototype._socket_send=function(a){if(a.type==1){var b=this._traceMask(a,"password");this._trace("Client._socket_send",b)}else this._trace("Client._socket_send",a);this.socket.send(a.encode());this.sendPinger.reset()};w.prototype._receivePublish=function(a){__p&&__p();switch(a.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(a);break;case 1:var b=new l(d.PUBACK,{messageIdentifier:a.messageIdentifier});this._schedule_message(b);this._receiveMessage(a);break;case 2:this._receivedMessages[a.messageIdentifier]=a;this.store("Received:",a);b=new l(d.PUBREC,{messageIdentifier:a.messageIdentifier});this._schedule_message(b);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}};w.prototype._receiveMessage=function(a){this.onMessageArrived&&this.onMessageArrived(a.payloadMessage)};w.prototype._connected=function(a,b){this.onConnected&&this.onConnected(a,b)};w.prototype._reconnect=function(){this._trace("Client._reconnect"),this.connected||(this._reconnecting=!0,this.sendPinger.cancel(),this.receivePinger.cancel(),this._reconnectInterval<128&&(this._reconnectInterval=this._reconnectInterval*2),this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri))};w.prototype._disconnected=function(a,b){__p&&__p();this._trace("Client._disconnected",a,b);if(a!==undefined&&this._reconnecting){this._reconnectTimeout=new v(this,window,this._reconnectInterval,this._reconnect);return}this.sendPinger.cancel();this.receivePinger.cancel();this._connectTimeout&&(this._connectTimeout.cancel(),this._connectTimeout=null);this._msg_queue=[];this._buffered_msg_queue=[];this._notify_msg_sent={};this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.readyState===1&&this.socket.close(),delete this.socket);if(this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1)this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex]);else{a===undefined&&(a=g.OK.code,b=i(g.OK));if(this.connected){this.connected=!1;this.onConnectionLost&&this.onConnectionLost({errorCode:a,errorMessage:b,reconnect:this.connectOptions.reconnect,uri:this._wsuri});if(a!==g.OK.code&&this.connectOptions.reconnect){this._reconnectInterval=1;this._reconnect();return}}else this.connectOptions.mqttVersion===4&&this.connectOptions.mqttVersionExplicit===!1?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:a,errorMessage:b})}};w.prototype._trace=function(){if(this.traceFunction){for(var a in arguments)typeof arguments[a]!=="undefined"&&arguments.splice(a,1,JSON.stringify(arguments[a]));var b=Array.prototype.slice.call(arguments).join("");this.traceFunction({severity:"Debug",message:b})}if(this._traceBuffer!==null)for(var a=0,c=arguments.length;a<c;a++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),a===0?this._traceBuffer.push(arguments[a]):typeof arguments[a]==="undefined"?this._traceBuffer.push(arguments[a]):this._traceBuffer.push("  "+JSON.stringify(arguments[a]))};w.prototype._traceMask=function(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&(d==b?c[d]="******":c[d]=a[d]);return c};var x=function(a,b,c,d){__p&&__p();var f;if(typeof a!=="string")throw new Error(i(g.INVALID_TYPE,[typeof a,"host"]));if(arguments.length==2){d=b;f=a;var h=f.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(h)a=h[4]||h[2],b=parseInt(h[7]),c=h[8];else throw new Error(i(g.INVALID_ARGUMENT,[a,"host"]))}else{arguments.length==3&&(d=c,c="/mqtt");if(typeof b!=="number"||b<0)throw new Error(i(g.INVALID_TYPE,[typeof b,"port"]));if(typeof c!=="string")throw new Error(i(g.INVALID_TYPE,[typeof c,"path"]));var j=a.indexOf(":")!==-1&&a.slice(0,1)!=="["&&a.slice(-1)!=="]";f="ws://"+(j?"["+a+"]":a)+":"+b+c}var k=0;for(var l=0;l<d.length;l++){var m=d.charCodeAt(l);55296<=m&&m<=56319&&l++;k++}if(typeof d!=="string"||k>65535)throw new Error(i(g.INVALID_ARGUMENT,[d,"clientId"]));var n=new w(f,a,b,c,d);this._getHost=function(){return a};this._setHost=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getPort=function(){return b};this._setPort=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getPath=function(){return c};this._setPath=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getURI=function(){return f};this._setURI=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getClientId=function(){return n.clientId};this._setClientId=function(){throw new Error(i(g.UNSUPPORTED_OPERATION))};this._getOnConnected=function(){return n.onConnected};this._setOnConnected=function(a){if(typeof a==="function")n.onConnected=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onConnected"]))};this._getDisconnectedPublishing=function(){return n.disconnectedPublishing};this._setDisconnectedPublishing=function(a){n.disconnectedPublishing=a};this._getDisconnectedBufferSize=function(){return n.disconnectedBufferSize};this._setDisconnectedBufferSize=function(a){n.disconnectedBufferSize=a};this._getConnectOptions=function(){return n.connectOptions};this._getOnConnectionLost=function(){return n.onConnectionLost};this._setOnConnectionLost=function(a){if(typeof a==="function")n.onConnectionLost=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onConnectionLost"]))};this._getOnMessageDelivered=function(){return n.onMessageDelivered};this._setOnMessageDelivered=function(a){if(typeof a==="function")n.onMessageDelivered=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onMessageDelivered"]))};this._getOnMessageArrived=function(){return n.onMessageArrived};this._setOnMessageArrived=function(a){if(typeof a==="function")n.onMessageArrived=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onMessageArrived"]))};this._getTrace=function(){return n.traceFunction};this._setTrace=function(a){if(typeof a==="function")n.traceFunction=a;else throw new Error(i(g.INVALID_TYPE,[typeof a,"onTrace"]))};this.connect=function(d){__p&&__p();d=d||{};e(d,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",reconnect:"boolean",mqttVersion:"number",mqttVersionExplicit:"boolean",ignoreSubProtocol:"boolean",uris:"object"});d.keepAliveInterval===undefined&&(d.keepAliveInterval=60);if(d.mqttVersion>4||d.mqttVersion<3)throw new Error(i(g.INVALID_ARGUMENT,[d.mqttVersion,"connectOptions.mqttVersion"]));d.mqttVersion===undefined?(d.mqttVersionExplicit=!1,d.mqttVersion=4):d.mqttVersionExplicit=!0;if(d.password!==undefined&&d.userName===undefined)throw new Error(i(g.INVALID_ARGUMENT,[d.password,"connectOptions.password"]));if(d.willMessage){if(!(d.willMessage instanceof y))throw new Error(i(g.INVALID_TYPE,[d.willMessage,"connectOptions.willMessage"]));d.willMessage.stringPayload=null;if(typeof d.willMessage.destinationName==="undefined")throw new Error(i(g.INVALID_TYPE,[typeof d.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}typeof d.cleanSession==="undefined"&&(d.cleanSession=!0);if(d.hosts){if(!(d.hosts instanceof Array))throw new Error(i(g.INVALID_ARGUMENT,[d.hosts,"connectOptions.hosts"]));if(d.hosts.length<1)throw new Error(i(g.INVALID_ARGUMENT,[d.hosts,"connectOptions.hosts"]));var h=!1;for(var b=0;b<d.hosts.length;b++){if(typeof d.hosts[b]!=="string")throw new Error(i(g.INVALID_TYPE,[typeof d.hosts[b],"connectOptions.hosts["+b+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(d.hosts[b])){if(b===0)h=!0;else if(!h)throw new Error(i(g.INVALID_ARGUMENT,[d.hosts[b],"connectOptions.hosts["+b+"]"]))}else if(h)throw new Error(i(g.INVALID_ARGUMENT,[d.hosts[b],"connectOptions.hosts["+b+"]"]))}if(!h){if(!d.ports)throw new Error(i(g.INVALID_ARGUMENT,[d.ports,"connectOptions.ports"]));if(!(d.ports instanceof Array))throw new Error(i(g.INVALID_ARGUMENT,[d.ports,"connectOptions.ports"]));if(d.hosts.length!==d.ports.length)throw new Error(i(g.INVALID_ARGUMENT,[d.ports,"connectOptions.ports"]));d.uris=[];for(var b=0;b<d.hosts.length;b++){if(typeof d.ports[b]!=="number"||d.ports[b]<0)throw new Error(i(g.INVALID_TYPE,[typeof d.ports[b],"connectOptions.ports["+b+"]"]));h=d.hosts[b];var a=d.ports[b],j=h.indexOf(":")!==-1;f="ws://"+(j?"["+h+"]":h)+":"+a+c;d.uris.push(f)}}else d.uris=d.hosts}n.connect(d)};this.subscribe=function(a,b){if(typeof a!=="string")throw new Error("Invalid argument:"+a);b=b||{};e(b,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(b.timeout&&!b.onFailure)throw new Error("subscribeOptions.timeout specified with no onFailure callback.");if(typeof b.qos!=="undefined"&&!(b.qos===0||b.qos===1||b.qos===2))throw new Error(i(g.INVALID_ARGUMENT,[b.qos,"subscribeOptions.qos"]));n.subscribe(a,b)};this.unsubscribe=function(a,b){if(typeof a!=="string")throw new Error("Invalid argument:"+a);b=b||{};e(b,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"});if(b.timeout&&!b.onFailure)throw new Error("unsubscribeOptions.timeout specified with no onFailure callback.");n.unsubscribe(a,b)};this.send=function(a,b,c,d){__p&&__p();var e;if(arguments.length===0)throw new Error("Invalid argument.length");else if(arguments.length==1){if(!(a instanceof y)&&typeof a!=="string")throw new Error("Invalid argument:"+typeof a);e=a;if(typeof e.destinationName==="undefined")throw new Error(i(g.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]));n.send(e)}else e=new y(b),e.destinationName=a,arguments.length>=3&&(e.qos=c),arguments.length>=4&&(e.retained=d),n.send(e)};this.publish=function(a,b,c,d){__p&&__p();!1;var e;if(arguments.length===0)throw new Error("Invalid argument.length");else if(arguments.length==1){if(!(a instanceof y)&&typeof a!=="string")throw new Error("Invalid argument:"+typeof a);e=a;if(typeof e.destinationName==="undefined")throw new Error(i(g.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]));n.send(e)}else e=new y(b),e.destinationName=a,arguments.length>=3&&(e.qos=c),arguments.length>=4&&(e.retained=d),n.send(e)};this.disconnect=function(){n.disconnect()};this.getTraceLog=function(){return n.getTraceLog()};this.startTrace=function(){n.startTrace()};this.stopTrace=function(){n.stopTrace()};this.isConnected=function(){return n.connected}};Object.defineProperties(x.prototype,{host:{get:function(){return this._getHost()},set:function(a){this._setHost(a)}},port:{get:function(){return this._getPort()},set:function(a){this._setPort(a)}},path:{get:function(){return this._getPath()},set:function(a){this._setPath(a)}},clientId:{get:function(){return this._getClientId()},set:function(a){this._setClientId(a)}},onConnected:{get:function(){return this._getOnConnected()},set:function(a){this._setOnConnected(a)}},disconnectedPublishing:{get:function(){return this._getDisconnectedPublishing()},set:function(a){this._setDisconnectedPublishing(a)}},disconnectedBufferSize:{get:function(){return this._getDisconnectedBufferSize()},set:function(a){this._setDisconnectedBufferSize(a)}},onConnectionLost:{get:function(){return this._getOnConnectionLost()},set:function(a){this._setOnConnectionLost(a)}},connectOptions:{get:function(){return this._getConnectOptions()}},onMessageDelivered:{get:function(){return this._getOnMessageDelivered()},set:function(a){this._setOnMessageDelivered(a)}},onMessageArrived:{get:function(){return this._getOnMessageArrived()},set:function(a){this._setOnMessageArrived(a)}},trace:{get:function(){return this._getTrace()},set:function(a){this._setTrace(a)}}});var y=function(a){__p&&__p();var b;if(typeof a==="string"||a instanceof ArrayBuffer||a instanceof Int8Array||a instanceof Uint8Array||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array)b=a;else throw i(g.INVALID_ARGUMENT,[a,"newPayload"]);this._getPayloadString=function(){if(typeof b==="string")return b;else return t(b,0,b.length)};this._getPayloadBytes=function(){if(typeof b==="string"){var a=new ArrayBuffer(r(b));a=new Uint8Array(a);s(b,a,0);return a}else return b};var c;this._getDestinationName=function(){return c};this._setDestinationName=function(a){if(typeof a==="string")c=a;else throw new Error(i(g.INVALID_ARGUMENT,[a,"newDestinationName"]))};var d=0;this._getQos=function(){return d};this._setQos=function(a){if(a===0||a===1||a===2)d=a;else throw new Error("Invalid argument:"+a)};var e=!1;this._getRetained=function(){return e};this._setRetained=function(a){if(typeof a==="boolean")e=a;else throw new Error(i(g.INVALID_ARGUMENT,[a,"newRetained"]))};var f=!1;this._getDuplicate=function(){return f};this._setDuplicate=function(a){f=a}};Object.defineProperties(y.prototype,{payloadString:{get:function(){return this._getPayloadString()}},payloadBytes:{get:function(){return this._getPayloadBytes()}},destinationName:{get:function(){return this._getDestinationName()},set:function(a){this._setDestinationName(a)}},topic:{get:function(){return this._getDestinationName()},set:function(a){this._setDestinationName(a)}},qos:{get:function(){return this._getQos()},set:function(a){this._setQos(a)}},retained:{get:function(){return this._getRetained()},set:function(a){this._setRetained(a)}},duplicate:{get:function(){return this._getDuplicate()},set:function(a){this._setDuplicate(a)}}});return{Client:x,Message:y}}(window);return b})}),null);
__d("MqttConnection",["MqttLogger","Random","paho-mqtt"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=30,h="publish",i="subscribe",j=function(a){};function a(){this.$6=!1,this.$9=b("MqttLogger").getInstance(),this.$10="Disconnected",this.$15=new Set()}a.prototype.run=function(a){__p&&__p();var b=a.onStateChange,c=a.onError,d=a.onMessageReceived,e=a.endpoint,f=a.deviceId,g=a.userFbid;a=a.appId;if(this.$6){this.$9.logError("run","Run called while in running state.");return}this.$1=b;this.$2=c;this.$3=d;this.$4=e;this.$8=f;this.$11=g;this.$14=a;this.$6=!0;this.$12=0;this.$16()};a.prototype.shutdown=function(){this.$17(),this.$6=!1,this.$18("shutdown","Shutdown")};a.prototype.subscribe=function(a){this.$15.add(a);if(!this.$19(i))return!1;else{this.$5.subscribe(a,{});this.$18("subscribe","Subscribing to "+a);return!0}};a.prototype.publish=function(a,b,c){var d=this.$19(h);d&&this.$5.publish(a,b,c,!1);this.$9.logPublish({topic:a,qos:c,conn_state:d?1:0,status:""+(d?"succes_connected":"failed_notconnected")});return d};a.prototype.isRunning=function(){return this.$6};a.prototype.$17=function(){this.$6&&this.$5&&(this.$20("Disconnected"),this.$5.onMessageArrived=j,this.$5.onConnectionLost=j,this.$5.connectOptions.onSuccess=j,this.$5.connectOptions.onFailure=j,this.$5.isConnected()&&this.$5.disconnect(),this.$5=null)};a.prototype.$20=function(a){a!==this.$10&&(this.$10=a,this.$1(a))};a.prototype.$16=function(){__p&&__p();if(!this.$6)return;this.$20("Connecting");this.$5=new(b("paho-mqtt").Client)(this.$4,"mqttwsclient");this.$7=this.$21();var a=Date.now(),c=Array.from(this.$15);this.$5.onConnectionLost=function(a){a.errorCode&&this.$9.logDisconnect({session:this.$7,errno:a.errorCode,err_str:a.errorMessage,session_duration:Date.now()-this.$13}),this.$22()}.bind(this);this.$5.onMessageArrived=function(a){this.$18("onMessageArrived","Message received on "+a.destinationName),this.$9.bumpCounter("message_arrived."+a.destinationName),this.$3(a.destinationName,a.payloadBytes)}.bind(this);this.$5.connect({userName:JSON.stringify({u:this.$11,s:this.$7,cp:1,ecp:0,chat_on:!0,fg:1,d:this.$23(),ct:"websocket",mqtt_sid:"",aid:this.$14,st:c,dc:""}),mqttVersion:3,password:"",keepAliveInterval:g,onFailure:function(b){this.$18("connect","Connect failed "+b.errorMessage),this.$24("failed",Date.now()-a,c,b.errorCode,b.errorMessage),this.$22()}.bind(this),onSuccess:function(){this.$18("connect","Connect success"),this.$24("success",Date.now()-a,c),this.$20("Connected"),this.$12=0,this.$13=Date.now()}.bind(this),ignoreSubProtocol:!0})};a.prototype.$22=function(){if(!this.$6)return;this.$17();this.$7=-1;var a=Math.pow(2,Math.min(this.$12,9))*(1e3+Math.random()*200);this.$18("_scheduleReconnect","Reconnect in "+a+" ms");setTimeout(function(){return this.$16()}.bind(this),a);this.$12+=1};a.prototype.$21=function(){return Math.floor((1+b("Random").random())*Number.MAX_SAFE_INTEGER)};a.prototype.$23=function(){return this.$8};a.prototype.$19=function(a){__p&&__p();if(!this.$6){this.$18("_ensureConnected","Mqtt connection: "+a+" called when not running");return!1}if(this.$5==null){this.$18("_ensureConnected","Mqtt connection: "+a+" called when not connected, ignored");return!1}if(this.$10!=="Connected"){this.$18("_ensureConnected","Mqtt connection: "+a+" called with connection state "+this.$10);return!1}var b=this.$5.isConnected();if(!b){this.$18("_ensureConnected","Mqtt connection: "+a+" called with client connection state "+b);return!1}return!0};a.prototype.$18=function(event,a){this.$9.debugTrace(event,"MQTT connection "+this.$7+": "+JSON.stringify(a))};a.prototype.$24=function(a,b,c,d,e){__p&&__p();var f={};f.status=a;f.session=this.$7;f.duration=Date.now()-b;f.hostname=this.$4;f.attempt_number=this.$12;f.subscribed_topics=c.join(", ");d&&(f.errno=d);e&&(f.err_str=e);this.$9.logConnect(f)};e.exports=a}),null);
__d("MqttChannel",["MqttConnection","MqttLogger","uuid"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.$1="",this.$2=[],this.$3="Disconnected",this.$4=new Map(),this.$8=b("MqttLogger").getInstance(),this.$7=new(b("MqttConnection"))(),this.$5=b("uuid")(),this.$6=new Set()}a.prototype.run=function(a){__p&&__p();var b=a.endpoint,c=a.userFbid;a=a.appId;if(this.$7.isRunning()){this.$9("run","Connection started calling run again");return}this.$8.setAppId(a);this.$1=b;this.$7.run({onStateChange:function(a){this.$10(a)}.bind(this),onError:function(a){this.$11("connection","Error "+a)}.bind(this),onMessageReceived:function(a,b){this.$12(a,b)}.bind(this),deviceId:this.$5,endpoint:b,userFbid:c,appId:a})};a.prototype.shutdown=function(){this.$7&&this.$7.shutdown()};a.prototype.publish=function(a,b){this.$7.publish(a,b,1)};a.prototype.subscribe=function(a,b){var c=this.$7.subscribe(a);c||this.$6.add(a);c=this.$4.get(a);!c?(c=[b],this.$4.set(a,c)):c.push(b)};a.prototype.subscribeChannelEvents=function(a){this.$2.push(a)};a.prototype.getDeviceId=function(){return this.$5};a.prototype.getConnectionState=function(){return this.$3};a.prototype.$12=function(a,b){__p&&__p();var c=this.$4.get(a);if(!c)this.$11("_onMessageReceived",a+" being dropped, no listeners");else for(var a=c,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;e(b)}};a.prototype.$10=function(a){this.$3!=="Connected"&&a==="Connected"&&(this.$6.forEach(function(a){return this.$7.subscribe(a)}.bind(this)),this.$6.clear()),this.$3=a,this.$9("_changeState","Connection state = "+a),this.$13(a)};a.prototype.$13=function(a){__p&&__p();for(var b=this.$2,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.onMQTTStateChanged(a)}};a.prototype.$11=function(event,a){this.$8.logError(event,a)};a.prototype.$9=function(event,a){this.$8.debugTrace(event,"Mqtt channel: "+a)};c=new a();e.exports=c}),null);
__d("MessageEventStream",["invariant","Int64","MercurySingletonProvider","MqttChannel","MqttLogger","MqttWsClientTypedLogger"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();h.getForFBID=function(a){return i.getForFBID(a)};h.setup=function(a){var b=a.fbid,c=a.msgSequenceId,d=a.fbidThreadFilter;a=a.queuePosition;!b&&g(0);b=h.getForFBID(b);b.init(c,d,a)};function h(a){this.$2="Disconnected",this.$1=a,this.$3=[],this.$6=b("MqttLogger").getInstance()}h.prototype.init=function(a,c,d){__p&&__p();if(!a&&!d)return this;this.$4=a?b("Int64").fromString(a.toString()):null;this.$2=b("MqttChannel").getConnectionState();b("MqttChannel").subscribe("/t_ms",function(a){return this.$7(a)}.bind(this));b("MqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a){this.$2!=="Connected"&&a==="Connected"&&(this.$5?this.$8():this.$9(c,d)),this.$2=a}.bind(this)});b("MqttChannel").getConnectionState()==="Connected"&&this.$9(c,d);b("MqttChannel").subscribe("/notify_disconnect",function(a){var b="notify_disconnect";try{b=String.fromCharCode.apply(null,a)}catch(a){this.$6.logError("notify_disconnect",a)}b==="IRIS_CURSOR_LIMIT"&&(this.$5=null);this.$6.bumpCounter("notify_disconnect_request");this.$3.forEach(function(a){return a.onStreamDisconnect(b)})}.bind(this));return this};h.prototype.addDeltaStreamListener=function(a){this.$3.push(a)};h.prototype.$7=function(a){__p&&__p();var c=void 0;try{var d="";for(var e=0;e<a.length;e++)d+=escape(String.fromCharCode(a[e]));c=JSON.parse(decodeURIComponent(d))}catch(a){this.$6.logError("process_deltas",a);return}a=this.$1;e=this.$4;if(c.syncToken){this.$5||(this.$5=c.syncToken);this.$4||(this.$4=b("Int64").fromString(c.firstDeltaSeqId.toString()));return}else if(c.queueEntityId!=a){this.$6.bumpCounter("delta_for_other_fbid");return}else{d=c.deltas;a={seq_id:e&&e.toString(),first_seq_id:"",last_seq_id:"",deltas_in_batch:[]};if(d&&e){var f=c.firstDeltaSeqId.toString();c=c.lastIssuedSeqId.toString();var g=b("Int64").fromString(f),h=b("Int64").fromString(c);a.first_seq_id=f;a.last_seq_id=c;g.equals(e.add(b("Int64").ONE))?this.$10(g,h,d,a):g.compare(e)<0?(this.$6.bumpCounter("delta_batch_in_middle"),h.compare(e)>0&&this.$10(e.add(b("Int64").ONE),h,d,a)):(this.$6.bumpCounter("missing_deltas_get_diffs"),this.$8())}else this.$6.bumpCounter("process_deltas_invalid_state");this.$11(a)}};h.prototype.$10=function(a,c,d,e){__p&&__p();a=a;for(var f=0;f<d.length;f++){var g=d[f],h=g["class"]||"Missing",i={seqId:a.toString(),type:h,status:""},j=1;if(h!="Missing")try{j=this.$12(g,h,a,i)}catch(a){i.status="err:"+a.message}else i.status="no type",this.$6.bumpCounter("missing_delta_type");a=a.add(b("Int64").fromInt(j));e.deltas_in_batch.push(i)}this.$4=c};h.prototype.$12=function(a,c,d,e){__p&&__p();var f=1,g="";c==="NoOp"&&(f=a.numNoOps||f,g+="n:"+f);a.irisSeqId||(a.irisSeqId=d.toString(),g+="missing seq id");var h=b("Int64").fromString(a.irisSeqId.toString())||d;h.equals(d)?g+=" seqId match":(g+=" seqId mismatch",this.$6.bumpCounter("seq_id_running_id_mismatch"));var i={type:c,payload:a};this.$3.forEach(function(a){return a.onDeltaReceived(i)});e.status=g;return f};h.prototype.$9=function(a,c){var d=void 0;a&&(d={thread_filter:[{other_user_fbid:a}]});a={sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,initial_titan_sequence_id:this.$4&&this.$4.toString(),deviceParams:d,queue_position:c};b("MqttChannel").publish("/messenger_sync_create_queue",JSON.stringify(a))};h.prototype.$8=function(){__p&&__p();if(!this.$4){this.$6.bumpCounter("get_diffs_no_seq_id");return}if(!this.$5){this.$6.bumpCounter("get_diffs_no_sync_token");return}var a={sync_token:this.$5,sync_api_version:10,max_deltas_able_to_process:1e3,delta_batch_size:500,encoding:"JSON",entity_fbid:this.$1,last_seq_id:this.$4.toString()};b("MqttChannel").publish("/messenger_sync_get_diffs",JSON.stringify(a))};h.prototype.$11=function(a){new(b("MqttWsClientTypedLogger"))().setSeqID(a.seq_id).setFirstSeqID(a.first_seq_id).setLastSeqID(a.last_seq_id).setDeltasInBatch(JSON.stringify(a.deltas_in_batch)).log()};var i=new(b("MercurySingletonProvider"))(h);e.exports=h}),null);
__d("LiveChatMqttClient",["Arbiter","ChannelConstants","LiveChatPluginConstants","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MercurySingletonProvider","MessageEventStream","MessengerLiveChatPluginEvent","MessengerLiveChatPluginGateway","MessengerLiveChatPluginTypedLogger","MqttChannel","Network","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=225396507985893,h="n",i="wss://edge-chat.facebook.com/chat/";function j(a){this.$1=a}j.getForFBID=function(a){return k.getForFBID(a)};j.setUp=function(a,c,d,e,f){var h=j.getForFBID(c);h.init(a,c,d,e,f);b("MqttChannel").run({endpoint:i,userFbid:c,appId:g})};j.prototype.init=function(a,c,d,e,f){this.$2=a,this.$3=d,!e?b("MessageEventStream").getForFBID(c).init(null,a,h).addDeltaStreamListener(this):b("MessageEventStream").getForFBID(c).init(e,a).addDeltaStreamListener(this),new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$1).setPageID(this.$2).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").MQTT_CONNECTION_INITIATED).setEventTimestamp(Date.now()).log(),b("MqttChannel").subscribeChannelEvents({onMQTTStateChanged:function(a){a===b("LiveChatPluginConstants").CONNECTED_STATE&&(f&&f()),(b("Network").isOnline()||a!=="Connecting")&&b("Arbiter").inform(b("LiveChatPluginConstants").STATE_UPDATE,a),new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$1).setPageID(this.$2).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").MQTT_CONNECTION_STATE_CHANGED).setDebugData(a).setEventTimestamp(Date.now()).log()}.bind(this)}),b("Network").addListener("offline",function(){b("MqttChannel").getConnectionState()!==b("LiveChatPluginConstants").DISCONNECTED_STATE&&b("Arbiter").inform(b("LiveChatPluginConstants").STATE_UPDATE,b("LiveChatPluginConstants").DISCONNECTED_STATE)}),b("Network").addListener("online",function(){b("MqttChannel").getConnectionState()===b("LiveChatPluginConstants").CONNECTED_STATE&&b("Arbiter").inform(b("LiveChatPluginConstants").STATE_UPDATE,b("LiveChatPluginConstants").CONNECTED_STATE)}),b("gkx")("AT4hiGbYW4ngk-zCbv637k7zHe48oayAR-hwVjfFjj9QDQBSaXTOse2zT6Fc6PIRdBe5pXveGfEGG-3IpWR254hU")&&b("MqttChannel").subscribe("/orca_typing_notifications",function(a){b("Arbiter").inform(b("LiveChatPluginConstants").TYPING_UPDATE,JSON.parse(new TextDecoder("utf-8").decode(a)).state)})};j.prototype.onDeltaReceived=function(a){__p&&__p();var c=a.type;a=a.payload;try{c=c.replace(/^delta/,"unknown");var d=Number(a.irisSeqId);a={delta:babelHelpers["extends"]({},a,{"class":c}),iseq:d,type:"delta"};var e=this.$3||b("gkx")("AT7JCav-mnZaXvxvDZIStsaHGOzW3wm3IcqOSc7xoesh9oMNPR0bSOyfLxBj6PCvVKOi8MrYYxdqv_TpZOkUtcGctqpnKAug6HnuZMaG4wXC1Q");if(e){var f=b("gkx")("AT4L8DlAE0WEKOKYkeJWzHDsRi3-ZWFYr4agMbkLtMUBERlxiBLblqdrc15ka2y0CqeZkLHc9yfq9QS1H3akL6e9")?"messenger-mqtt-delta":b("ChannelConstants").getArbiterType("delta");b("Arbiter").inform(f,{obj:a})}b("LiveChatPluginLoggerUtil").logDelta(this.$1,this.$2,c,b("MessengerLiveChatPluginGateway").MQTT,!e,d)}catch(a){new(b("MessengerLiveChatPluginTypedLogger"))().setUserFbid(this.$1).setPageID(this.$2).setRequestID(b("LiveChatPluginSessionUtil").getRequestID()).setEvent(b("MessengerLiveChatPluginEvent").DELTA_PARSING_ERROR).setEventTimestamp(Date.now()).logVital()}};j.prototype.onStreamDisconnect=function(a){};var k=new(b("MercurySingletonProvider"))(j);e.exports=j}),null);
__d("isReactClassComponent",[],(function(a,b,c,d,e,f){function a(a){return Boolean(typeof a==="function"&&a.prototype&&a.prototype.isReactComponent)}e.exports=a}),null);
__d("LazyComponent.react",["React","isReactClassComponent"],(function(a,b,c,d,e,f){__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.getComponent=function(){"use strict";return this.$1};a.prototype.render=function(){"use strict";var a=this.props,c=a.LazyLoadedComponent;a=babelHelpers.objectWithoutProperties(a,["LazyLoadedComponent"]);var d=b("isReactClassComponent")(c)?function(a){return this.$1=a}.bind(this):null;return b("React").createElement(c,babelHelpers["extends"]({ref:d},a))};function a(){"use strict";g.apply(this,arguments)}a.defaultProps={LazyLoadedComponent:function(){return null}};e.exports=a}),null);
__d("LiveChatPluginCloseButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"10px",height:"10px",viewBox:"0 0 14 14"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{transform:"translate(-419.000000, -413.000000)"},b("React").createElement("g",{transform:"translate(164.000000, 396.000000)"},b("React").createElement("g",null,b("React").createElement("g",{transform:"translate(250.000000, 12.000000)"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("rect",{opacity:"0.200000003",x:"0",y:"0",width:"24",height:"24"}),b("React").createElement("g",{transform:"translate(4.000000, 4.000000)",fill:"#000000"},b("React").createElement("rect",{transform:"translate(8.000000, 8.000000) rotate(45.000000) translate(-8.000000, -8.000000) ",x:"7",y:"-1",width:"2",height:"18",rx:"1"}),b("React").createElement("rect",{transform:"translate(8.000000, 8.000000) rotate(135.000000) translate(-8.000000, -8.000000) ",x:"7",y:"-1",width:"2",height:"18",rx:"1"}))))))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("PrivacyTransparentOverlay.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_4cqr"},this.props.children,b("React").createElement("div",{className:"clearfix"}))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginAnonymousUserPrompt.react",["cx","fbt","Image.react","Link.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginLoggerUtil","MessengerLiveChatPluginEvent","MessengerTextWithEntities.react","PluginOptin","PrivacyTransparentOverlay.react","React","ReactDOM","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=124;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){this.$3(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").LOG_IN_TO_MESSENGER_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$2=function(){this.$3(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").CHAT_NOW_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.componentDidMount=function(){var a=b("ReactDOM").findDOMNode(this);a=a&&a.offsetHeight>j?a.offsetHeight:j;this.props.anchorIframeResizeFn(a);b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").ANONYMOUS_CHAT_NOW_PROMPT_RENDERED,this.props.viewerID,this.props.pageID)};a.prototype.componentDidUpdate=function(){var a=b("ReactDOM").findDOMNode(this);a=a&&a.offsetHeight>j?a.offsetHeight:j;this.props.anchorIframeResizeFn(a)};a.prototype.render=function(){return b("React").createElement("div",{className:"_j68"},b("React").createElement("div",{className:"promptHeaderContainer"},b("React").createElement("div",{className:"promptTextContainer"},b("React").createElement("div",{className:"promptHeader"},this.props.loggedOutGreeting?b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,renderEmoticons:!0,text:this.props.loggedOutGreeting}):h._("Hi! We're here to answer any questions you may have.")),b("React").createElement("div",{className:"promptSubheader"},b("React").createElement(b("Link.react"),{className:"notYouLink",onClick:this.$1},h._("Log in to Messenger to chat.")))),b("React").createElement(b("PrivacyTransparentOverlay.react"),null,b("React").createElement(b("Image.react"),{className:"profilePicture",src:this.props.pageProfilePictureUri})),b("React").createElement("div",{className:"closeButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.props.onCloseButtonClick},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null)))),b("React").createElement("div",{className:"promptButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf promptButton",onClick:this.$2,style:{color:this.props.threadColor}},h._("Chat"))))};a.prototype.$3=function(){new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:this.props.pageID,switch_user:!1}).addReturnParams({referer_uri:this.props.refererUri}).start()};e.exports=a}),null);
__d("LiveChatPluginInformationButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{transform:"translate(-413.000000, -56.000000)"},b("React").createElement("g",{transform:"translate(90.000000, 44.000000)"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("g",{transform:"translate(324.000000, 13.000000)"},b("React").createElement("circle",{fill:this.props.informationViewOpen?this.props.threadColor:"#FFFFFF",stroke:this.props.threadColor,cx:"11",cy:"11",r:"11"}),b("React").createElement("path",{d:"M11,9 L12,9 L12,17 L13,17 L13,17.5 L9,17.5 L9,17 L10,17 L10,9.5 L9,9.5 L9,9 L11,9 Z M11,4.5 C11.8284271,4.5 12.5,5.17157288 12.5,6 C12.5,6.82842712 11.8284271,7.5 11,7.5 C10.1715729,7.5 9.5,6.82842712 9.5,6 C9.5,5.17157288 10.1715729,4.5 11,4.5 Z",fill:this.props.informationViewOpen?"#FFFFFF":this.props.threadColor}))))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginDialogHeader.react",["cx","LineClamp.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginInformationButtonSVG.react","React","ShimButton.react"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_f_0"},b("React").createElement("div",{className:"_1qd1"},b("React").createElement(b("ShimButton.react"),{className:"_2t-5 _4bqf",onClick:this.props.onCloseButtonClick},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null))),b("React").createElement("div",{className:"_hov"},b("React").createElement(b("LineClamp.react"),{className:"_how",lines:1},this.props.pageName),b("React").createElement(b("LineClamp.react"),{className:"_hox",lines:1},this.props.pageResponsivenessText)),b("React").createElement("div",{className:"_1qd3"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _17l7",onClick:this.props.onInformationButtonClick},b("React").createElement(b("LiveChatPluginInformationButtonSVG.react"),{informationViewOpen:this.props.informationViewOpen,threadColor:this.props.threadColor}))))};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginQEUniverse",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CUSTOMER_CHAT_PLUGIN_GREETING_TEXT_QE_UNIVERSE:"customer_chat_plugin_greeting_text_qe",CUSTOMER_CHAT_PLUGIN_QE_UNIVERSE:"customer_chat_plugin_qe"})}),null);
__d("XMNLiveChatConnectController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/connect/",{from_interstitial:{type:"Bool",defaultValue:!1},page_id:{type:"String",required:!0}})}),null);
__d("LiveChatPluginLoggedInUserPrompt.react",["cx","fbt","Arbiter","AsyncRequest","CurrentUser","Image.react","Link.react","LiveChatPluginCloseButtonSVG.react","LiveChatPluginLoggerUtil","LiveChatPluginQEUniverse","LiveChatPluginSessionUtil","MessengerLiveChatPluginEvent","MessengerLiveChatSettings","MessengerTextWithEntities.react","Plugin","PluginOptin","PrivacyTransparentOverlay.react","QE2Logger","React","ReactDOM","ShimButton.react","XMNLiveChatConnectController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=124;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$4=function(){new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!1,page_id:this.props.pageID,switch_user:!0}).addReturnParams({referer_uri:this.props.refererUri}).start(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").NOT_YOU_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$5=function(){__p&&__p();if(!b("CurrentUser").isLoggedInNow())return;if(this.props.hasMessagingPermission)this.props.onChatNowClick();else if(this.props.canSkipContinuousAs){var a=b("XMNLiveChatConnectController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$1=new(b("AsyncRequest"))().setURI(a).setMethod("POST").setAllowCrossPageTransition(!0).setHandler(this.props.onChatNowClick);this.$1.send()}else new(b("PluginOptin"))("customer_chat").addLoginParams({logged_in:!0,page_id:this.props.pageID,request_id:b("LiveChatPluginSessionUtil").getRequestID(),switch_user:!1}).start(),b("Arbiter").subscribe(b("Plugin").CONNECT,this.props.onChatNowClick);b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").CHAT_NOW_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.componentDidMount=function(){var a=b("ReactDOM").findDOMNode(this);a=a&&a.offsetHeight>j?a.offsetHeight:j;this.props.anchorIframeResizeFn(a);!this.props.loggedInGreeting&&this.$2()&&b("QE2Logger").logExposureForUser(b("LiveChatPluginQEUniverse").CUSTOMER_CHAT_PLUGIN_GREETING_TEXT_QE_UNIVERSE);b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").LOGGED_IN_CHAT_NOW_PROMPT_RENDERED,this.props.viewerID,this.props.pageID,JSON.stringify({hasMessagingPermission:this.props.hasMessagingPermission}))};a.prototype.componentDidUpdate=function(){var a=b("ReactDOM").findDOMNode(this);a=a&&a.offsetHeight>j?a.offsetHeight:j;this.props.anchorIframeResizeFn(a)};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.abandon()};a.prototype.render=function(){return b("React").createElement("div",{className:"_j68"},b("React").createElement("div",{className:"promptHeaderContainer"},b("React").createElement("div",{className:"promptTextContainer"},b("React").createElement("div",{className:"promptHeader"},this.$3()),b("React").createElement("div",{className:"promptSubheader"},b("React").createElement("div",{className:"profilePictureContainer"},b("React").createElement(b("PrivacyTransparentOverlay.react"),null,b("React").createElement(b("Image.react"),{className:"profilePicture",src:this.props.viewerProfilePictureUri}))),b("React").createElement("div",{className:"username"},b("CurrentUser").getName()),b("React").createElement(b("Link.react"),{className:"notYouLink",onClick:this.$4},h._("Not you?")))),b("React").createElement(b("PrivacyTransparentOverlay.react"),null,b("React").createElement(b("Image.react"),{className:"profilePicture",src:this.props.pageProfilePictureUri})),b("React").createElement("div",{className:"closeButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf _2t-5",onClick:this.props.onCloseButtonClick},b("React").createElement(b("LiveChatPluginCloseButtonSVG.react"),null)))),b("React").createElement("div",{className:"promptButtonContainer"},b("React").createElement(b("ShimButton.react"),{className:"_4bqf promptButton",onClick:this.$5,style:{color:this.props.threadColor}},h._("Chat Now"))))};a.prototype.$3=function(){if(this.props.loggedInGreeting)return b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,renderEmoticons:!0,text:this.props.loggedInGreeting});else if(this.$2()&&b("MessengerLiveChatSettings").qeSettings)return b("React").createElement("div",null,b("MessengerLiveChatSettings").qeSettings.greetingTextFbt);else return b("React").createElement("div",null,h._("Hi! How can we help you?"))};a.prototype.$2=function(){var a=["en_US","es_LA","pl_PL","th_TH","vi_VN"];return this.props.sdkLocale!==null&&a.includes(this.props.sdkLocale)};e.exports=a}),null);
__d("LiveChatPluginBotMenuButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{fill:this.props.threadColor},b("React").createElement("rect",{x:"2",y:"3",width:"20",height:"1"}),b("React").createElement("rect",{x:"2",y:"11",width:"20",height:"1"}),b("React").createElement("rect",{x:"2",y:"19",width:"20",height:"1"}))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginArrowButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a=this.props.direction==="left"?b("React").createElement("g",{fill:this.props.threadColor},b("React").createElement("polygon",{points:"5.5 12 16 1.5 18 3.5 9.5 12 18 20.5 16 22.5"})):b("React").createElement("g",{fill:this.props.threadColor},b("React").createElement("polygon",{points:"8 7 9.5 5.5 16 12 9.5 18.5 8 17 13 12"}));return b("React").createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("XMNCommercePostbackCTAController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/commerce/postback/",{cta_id:{type:"String",required:!0},message_id:{type:"String"},ref:{type:"String"},ref_source:{type:"Enum",enumType:1},ref_type:{type:"Enum",enumType:1}})}),null);
__d("LiveChatPluginBotMenuDialog.react",["cx","fbt","AsyncRequest","Link.react","LiveChatPluginArrowButtonSVG.react","LiveChatPluginLoggerUtil","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercurySourceType","MessengerLiveChatPluginEvent","MNCommerceCallToActionType","React","ShimButton.react","Tooltip.react","XMNCommercePostbackCTAController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.state={navigationPath:[]},this.$11=function(){this.props.closeDialogFn(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").BOT_MENU_URL_REDIRECT_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$1=b("MercuryMessageActions").getForFBID(this.props.viewerID),this.$2=new(b("MercuryMessageObject"))(this.props.viewerID),this.$3=b("LiveChatPluginLoggerUtil").getAttributionTags(),this.$4=b("MercuryIDs").getThreadIDFromUserID(this.props.pageID)}a.prototype.render=function(){var a=h._("Menu"),c=[],d=this.props.menuItems;for(var e=0;e<this.state.navigationPath.length;e++){var f=this.state.navigationPath[e];a=d[f].title;d=d[f].nested_ctas}c=d.map(function(b,a){return this.$5(b,a)}.bind(this));return b("React").createElement("div",{className:"_3qta"},this.$6(a),c)};a.prototype.$6=function(a){var c=this.state.navigationPath.length!==0?b("React").createElement(b("Link.react"),{className:"_4bqf _3qtb",onClick:function(a){this.setState(function(a){return{navigationPath:a.navigationPath.slice(0,-1)}})}.bind(this)},b("React").createElement(b("LiveChatPluginArrowButtonSVG.react"),{direction:"left",threadColor:this.props.threadColor})):null;return b("React").createElement("div",{className:"_3quo _3qup"},c,a)};a.prototype.$5=function(a,c){__p&&__p();var d=void 0;switch(a.action_type){case b("MNCommerceCallToActionType").POSTBACK:d=this.$7(a);break;case b("MNCommerceCallToActionType").OPEN_URL:d=this.$8(a);break;case b("MNCommerceCallToActionType").NAVIGATION:d=this.$9(a,c);break;default:d=this.$10(a);break}return b("React").createElement("div",{className:"_3quq",key:a.id},b("React").createElement("div",{className:"_3qup _4bqf"},d))};a.prototype.$10=function(a){return b("React").createElement(b("Tooltip.react"),{className:"_3qut",tooltip:h._("To use this feature, use the Messenger app.")},a.title)};a.prototype.$8=function(a){return b("React").createElement(b("Link.react"),{className:"_3qux",href:a.action_link,onClick:this.$11,style:{color:this.props.threadColor},target:"_blank"},a.title)};a.prototype.$9=function(a,c){var d=function(a){this.setState(function(a){return{navigationPath:a.navigationPath.concat(c)}})}.bind(this);return b("React").createElement(b("ShimButton.react"),{className:"_3quz",onClick:d},b("React").createElement(b("Link.react"),{style:{color:this.props.threadColor}},a.title),b("React").createElement("div",{className:"_3qu-"},b("React").createElement(b("LiveChatPluginArrowButtonSVG.react"),{direction:"right",threadColor:this.props.threadColor})))};a.prototype.$7=function(a){var c=function(c){this.props.closeDialogFn();this.$1.send(this.$2.constructCTAConfirmationMessageObject(a.title,b("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$4,null,this.$3));c=b("XMNCommercePostbackCTAController").getURIBuilder().setString("cta_id",a.id).getURI();new(b("AsyncRequest"))().setURI(c).setAllowCrossPageTransition(!0).setMethod("POST").send();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").BOT_MENU_POSTBACK_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this);return b("React").createElement(b("Link.react"),{className:"_3qux",onClick:c,style:{color:this.props.threadColor}},a.title)};e.exports=a}),null);
__d("XMessengerBotsMenuController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messenger/commerce/bots/menu/",{page_id:{type:"String",required:!0}})}),null);
__d("LiveChatPluginBotMenuButton.react",["csx","cx","AsyncRequest","LiveChatPluginBotMenuButtonSVG.react","LiveChatPluginBotMenuDialog.react","LiveChatPluginLoggerUtil","MessengerContextualDialog.react","MessengerLiveChatPluginEvent","Parent","React","ReactDOM","ShimButton.react","Style","XMessengerBotsMenuController"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={flyoutOpen:!1,menuItems:null},this.$4=function(){this.setState(function(a){return{flyoutOpen:!a.flyoutOpen}},this.$8)}.bind(this),this.$7=function(){this.setState({flyoutOpen:!1})}.bind(this),this.$6=function(){this.state.flyoutOpen&&this.$3()}.bind(this),this.$8=function(){b("LiveChatPluginLoggerUtil").logAction(this.state.flyoutOpen?b("MessengerLiveChatPluginEvent").BOT_MENU_OPENED:b("MessengerLiveChatPluginEvent").BOT_MENU_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){this.$2()};a.prototype.componentWillUnmount=function(){this.$1&&(this.$1.abort(),this.$1=null),this.state.flyoutOpen&&this.$3()};a.prototype.render=function(){return b("React").createElement(b("ShimButton.react"),{className:"_661n",onClick:this.$4,ref:"botMenuContainer"},b("React").createElement(b("LiveChatPluginBotMenuButtonSVG.react"),{threadColor:this.props.threadColor}),this.$5())};a.prototype.$5=function(){return!this.state.flyoutOpen||!this.state.menuItems?null:b("React").createElement(b("MessengerContextualDialog.react"),{alignment:"right",contextRef:function(){return this.refs.botMenuContainer}.bind(this),hideOnBlur:!0,onBeforeHide:this.$6,position:"above",ref:function(a){if(this.props.isMobile&&a){a=b("Parent").bySelector(b("ReactDOM").findDOMNode(a),"._1r_9");var c=window.innerWidth<310?window.innerWidth-10:300;b("Style").set(a,"max-width",c+"px");b("Style").set(a,"-webkit-tap-highlight-color","transparent")}}.bind(this),shown:this.state.flyoutOpen,width:window.innerWidth<310?window.innerWidth-10:300},b("React").createElement(b("LiveChatPluginBotMenuDialog.react"),{closeDialogFn:this.$7,menuItems:this.state.menuItems,pageID:this.props.pageID,threadColor:this.props.threadColor,viewerID:this.props.viewerID}))};a.prototype.$2=function(){var a=b("XMessengerBotsMenuController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.$1=new(b("AsyncRequest"))().setURI(a).setHandler(function(a){this.setState({menuItems:a.payload.menu})}.bind(this)).setErrorHandler(function(a){this.setState({menuItems:[]})}.bind(this));this.$1.send()};a.prototype.$3=function(){this.setState({flyoutOpen:!1},this.$8)};e.exports=a}),null);
__d("LiveChatPluginLikeButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{height:"24px",preserveAspectRatio:"xMinYMax meet",viewBox:"0 0 40.16 42.24",width:"22px"},b("React").createElement("path",{d:"M935.36,1582.44a0,0,0,0,0,0,.06,3.59,3.59,0,0,1-.72,6.53,0,0,0,0,0,0,0,3.56,3.56,0,0,1,.71,2.13,3.6,3.6,0,0,1-3,3.54, 0,0,0,0,0,0,.05,3.56,3.56,0,0,1,.38,1.61,3.61,3.61,0,0,1-3.42,3.6H910v-19.6l5.27-7.9a4,4,0,0,0,.66-2.31l-0.1-4c-0.22-2.4-.09-2.06, 1.13-2.37,2-.51,7.16,1.59,5.13,12.17h11.06A3.59,3.59,0,0,1,935.36,1582.44ZM899,1581h7v22h-7v-22Z",transform:"translate(-898.5 -1563.26)",fill:"none",fillRule:"evenodd",stroke:this.props.threadColor,strokeLinecap:"round",strokeWidth:"2"}))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginSendButtonSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("svg",{width:"22px",height:"22px",viewBox:"0 0 22 22"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",{transform:"translate(-5.000000, -5.000000)",fill:this.props.threadColor},b("React").createElement("g",null,b("React").createElement("g",{transform:"translate(5.000000, 5.000000)"},b("React").createElement("path",{d:"M2.0300068,0.145970044 L20.9662955,9.37015518 C22.3445682,10.0420071 22.3445682,11.9582654 20.9662955,12.6296618 L2.0300068,21.853847 C1.09728834,22.3084288 0,21.6475087 0,20.6317597 L0.806953417,13.8945654 C0.882225434,13.2659853 1.39089595,12.7699536 2.03608467,12.6957083 L12.0229514,11.6795038 C12.8612292,11.5943266 12.8612292,10.4054904 12.0229514,10.3203132 L2.03608467,9.30410872 C1.39089595,9.23031889 0.882225434,8.7342872 0.806953417,8.10525162 L0,1.36805729 C0,0.352308292 1.09728834,-0.3081563 2.0300068,0.145970044"}))))))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginMessageComposer.react",["cx","fbt","AbstractTextInput.react","Keys","LiveChatPluginBotMenuButton.react","LiveChatPluginLikeButtonSVG.react","LiveChatPluginLoggerUtil","LiveChatPluginSendButtonSVG.react","MessengerLiveChatPluginEvent","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MercurySourceType","React","ShimButton.react","StickerConstants","emptyFunction","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){i.constructor.call(this,a),this.state={inputValue:""},this.$12=function(a){this.setState({inputValue:a.target.value})}.bind(this),this.$13=function(a){a.keyCode===b("Keys").RETURN&&(a.preventDefault(),this.$10())}.bind(this),this.$10=function(){var a=this.state.inputValue.trim();a&&a.length>0&&(this.$2.send(this.$3.constructUserGeneratedMessageObject(a,b("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$4,null,null,this.$5)),this.setState({inputValue:""}),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").MESSAGE_SENT,this.props.viewerID,this.props.pageID))}.bind(this),this.$11=function(){this.$2.send(this.$3.constructStickerMessageObject(b("StickerConstants").HOT_LIKE_SMALL_STICKER_ID,b("MercurySourceType").CUSTOMER_CHAT_PLUGIN,this.$4,this.$5)),this.setState({inputValue:""}),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").LIKE_BUTTON_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$2=b("MercuryMessageActions").getForFBID(this.props.viewerID),this.$3=b("MercuryMessageObject").getForFBID(this.props.viewerID),this.$4=b("MercuryIDs").getThreadIDFromUserID(this.props.pageID),this.$5=b("LiveChatPluginLoggerUtil").getAttributionTags()}a.prototype.render=function(){return b("React").createElement("div",{className:"_336a"+(this.props.disableInput?" _664i":"")},b("React").createElement("div",{className:"_4zbw"},this.$6(),this.$7(),b("React").createElement("div",{className:"_kmd"},this.$8(),this.$9())))};a.prototype.$8=function(){if(this.props.isMobile||!b("gkx")("AT5dKiuDLHEbKNlZIeU6zNyBdQvXXQ7ilO9T-lT7Q1Uke6_8n44AO8gJU_6mrJi2U8g_Kn1Nm7YwdiOLHe8ZTYXdd-Pd358VWPsGIoBtXuCdzQ"))return null;return this.state.inputValue.length>0?null:b("React").createElement(b("ShimButton.react"),{className:"_4bqf _64mk _68s_",onClick:b("emptyFunction")})};a.prototype.$9=function(){if(this.props.disableInput)return null;if(this.state.inputValue.length>0)return b("React").createElement(b("ShimButton.react"),{className:"_4bqf _64mk _64ml",onClick:this.$10},b("React").createElement(b("LiveChatPluginSendButtonSVG.react"),{threadColor:this.props.threadColor}));else return b("React").createElement(b("ShimButton.react"),{className:"_4bqf _64mk _68t0",onClick:this.$11},b("React").createElement(b("LiveChatPluginLikeButtonSVG.react"),{threadColor:this.props.threadColor}))};a.prototype.$7=function(){return this.props.disableInput?b("React").createElement("div",{className:"_664k"},h._("Composer is disabled for this thread.")):b("React").createElement("div",{className:"_4fwe"},b("React").createElement(b("AbstractTextInput.react"),{onBlur:this.props.onBlur,onChange:this.$12,onFocus:this.props.onFocus,onKeyDown:this.$13,ref:function(a){this.$1=a}.bind(this),placeholder:h._("Type a message...").toString(),value:this.state.inputValue}))};a.prototype.$6=function(){return this.props.hasMenu?b("React").createElement(b("LiveChatPluginBotMenuButton.react"),{isMobile:this.props.isMobile,threadColor:this.props.threadColor,pageID:this.props.pageID,viewerID:this.props.viewerID}):null};a.prototype.focus=function(){this.$1&&this.$1.focusInput()};e.exports=a}),null);
__d("LoadOnRender.react",["React","createCancelableFunction"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this,a),this.$1=function(a){this.setState({Component:a})}.bind(this),this.state={Component:null,cancelableOnComponentLoad:b("createCancelableFunction")(this.$1)}}a.prototype.UNSAFE_componentWillMount=function(){"use strict";this.props.loader(this.state.cancelableOnComponentLoad)};a.prototype.componentWillUnmount=function(){"use strict";this.state.cancelableOnComponentLoad.cancel()};a.prototype.render=function(){"use strict";var a=this.state.Component;return!a||this.props.forcePlaceholder?this.props.placeholder:b("React").cloneElement(this.props.component,{LazyLoadedComponent:a})};a.defaultProps={forcePlaceholder:!1};e.exports=a}),null);
__d("XMNLiveChatBlockMessageController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/block/",{page_id:{type:"String",required:!0}})}),null);
__d("XMNLiveChatUnblockMessageController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/unblock/",{page_id:{type:"String",required:!0}})}),null);
__d("LiveChatPluginDialogContainer.react",["cx","AsyncRequest","JSResource","LazyComponent.react","LiveChatPluginAnonymousUserPrompt.react","LiveChatPluginDialogHeader.react","LiveChatPluginLoggedInUserPrompt.react","LiveChatPluginLoggerUtil","LiveChatPluginMessageComposer.react","LoadOnRender.react","MercuryIDs","MercuryThreadActions","MessengerLiveChatPluginEvent","MessengerSpinner.react","MessengerState.bs","React","ReactDOM","UnverifiedXD","XMNLiveChatBlockMessageController","XMNLiveChatUnblockMessageController","emptyFunction","gkx","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MercuryThreadActions").get();c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(a){__p&&__p();h.constructor.call(this,a),this.state={dialogBodyHeight:-1,informationViewOpen:!1,isPageBlocked:!1},this.$1=b("gkx")("AT40Mh9SubM_kRAr4kiHqcSt3uR4c5ylsKL-SlFW3YXSJ8ORT7NbWQOfuR1vSslnGZKrbs0tHveldYFsyAdZ-YoeQbN0C__XbaHj-ScLiFUkOA"),this.$11=function(a){b("JSResource").loadAll([b("JSResource")("LiveChatPluginDialogBody.react").__setRef("LiveChatPluginDialogContainer.react")],function(c){a(c),b("LiveChatPluginLoggerUtil").logChatDisplayDone(this.props.viewerID,this.props.pageID,this.$2)}.bind(this))}.bind(this),this.$9=function(){var a=b("XMNLiveChatBlockMessageController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.setState({isPageBlocked:!0});new(b("AsyncRequest"))().setURI(a).setAllowCrossPageTransition(!0).send();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").BLOCK_MESSAGE_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$10=function(){var a=b("XMNLiveChatUnblockMessageController").getURIBuilder().setString("page_id",this.props.pageID).getURI();this.setState({isPageBlocked:!1});new(b("AsyncRequest"))().setURI(a).setAllowCrossPageTransition(!0).send();b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").UNBLOCK_MESSAGE_CLICKED,this.props.viewerID,this.props.pageID)}.bind(this),this.$5=function(){var a=b("ReactDOM").findDOMNode(this),c=b("ReactDOM").findDOMNode(this.$3),d=b("ReactDOM").findDOMNode(this.$4);if(a&&a instanceof HTMLElement&&c&&c instanceof HTMLElement&&d&&d instanceof HTMLElement){a=a.getBoundingClientRect().height-c.getBoundingClientRect().height-d.getBoundingClientRect().height;a!==this.state.dialogBodyHeight&&this.setState({dialogBodyHeight:a})}}.bind(this),this.$8=function(){this.setState(function(a){return{informationViewOpen:!a.informationViewOpen}},this.$15)}.bind(this),this.$15=function(){b("LiveChatPluginLoggerUtil").logAction(this.state.informationViewOpen?b("MessengerLiveChatPluginEvent").INFORMATION_BUTTON_OPENED:b("MessengerLiveChatPluginEvent").INFORMATION_BUTTON_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),this.$2=b("performanceAbsoluteNow")()}a.prototype.componentDidMount=function(){this.props.isMobile&&window.addEventListener("resize",this.$5);if(this.props.chatStarted&&this.props.hasMessagingPermission&&this.props.isLoggedIn){var a=b("ReactDOM").findDOMNode(this);a&&a instanceof HTMLElement&&(a.addEventListener("click",function(){this.$6()}.bind(this)),this.props.isMobile||a.addEventListener("click",function(){this.$7()}.bind(this)))}};a.prototype.render=function(){return!this.props.chatStarted||!this.props.hasMessagingPermission?this.props.isLoggedIn?b("React").createElement(b("LiveChatPluginLoggedInUserPrompt.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,canSkipContinuousAs:this.props.canSkipContinuousAs,hasMessagingPermission:this.props.hasMessagingPermission,loggedInGreeting:this.props.loggedInGreeting,onChatNowClick:this.props.onChatNowClick,onCloseButtonClick:this.props.onCloseButtonClick,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,refererUri:this.props.refererUri,sdkLocale:this.props.sdkLocale,threadColor:this.props.threadColor,viewerID:this.props.viewerID,viewerProfilePictureUri:this.props.viewerProfilePictureUri}):b("React").createElement(b("LiveChatPluginAnonymousUserPrompt.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,loggedOutGreeting:this.props.loggedOutGreeting,onCloseButtonClick:this.props.onCloseButtonClick,pageID:this.props.pageID,pageProfilePictureUri:this.props.pageProfilePictureUri,refererUri:this.props.refererUri,threadColor:this.props.threadColor,viewerID:this.props.viewerID}):this.props.isLoggedIn?b("React").createElement("div",{className:"_3gog",style:this.props.isMobile?null:{borderRadius:"9pt"}},b("React").createElement(b("LiveChatPluginDialogHeader.react"),{informationViewOpen:this.state.informationViewOpen,onCloseButtonClick:this.props.onCloseButtonClick,onInformationButtonClick:this.$8,pageID:this.props.pageID,pageName:this.props.pageName,pageResponsivenessText:this.props.pageResponsivenessText,ref:function(a){return this.$3=a}.bind(this),threadColor:this.props.threadColor,viewerID:this.props.viewerID}),b("React").createElement("div",{className:"_424s"},b("React").createElement(b("LoadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{blockMessage:this.$9,deliveryReceipt:this.$1?b("MessengerState.bs").deliveryReceipts(this.props.messengerState):{},dialogBodyHeight:this.state.dialogBodyHeight,isMobile:this.props.isMobile,isMuted:this.props.isMuted,isPageBlocked:this.state.isPageBlocked,informationViewOpen:this.state.informationViewOpen,messengerState:this.props.messengerState,pageID:this.props.pageID,pageName:this.props.pageName,pageProfilePictureUri:this.props.pageProfilePictureUri,readReceipt:this.props.readReceipt,threadColor:this.props.threadColor,unblockMessage:this.$10,viewerID:this.props.viewerID}),loader:this.$11,placeholder:b("React").createElement("div",{className:"spinner"},b("React").createElement(b("MessengerSpinner.react"),{color:"blue",size:b("MessengerSpinner.react").large_size}))})),b("React").createElement(b("LiveChatPluginMessageComposer.react"),{disableInput:this.props.disableInput,hasMenu:this.props.hasMenu,isMobile:this.props.isMobile,onBlur:this.$12()&&b("gkx")("AT7hhNkUCsrH-WQwqPlkVR6rxIH4s31Hwi85MD_2LXYVR9YP4OQnHMjUXVLCsk9uQ8WZtQWtCc1jqeEmvM9S2ebGIBfTB8W8Vp3LTkXFFb3dzg")?this.$13:b("emptyFunction"),onFocus:this.$12()&&b("gkx")("AT7hhNkUCsrH-WQwqPlkVR6rxIH4s31Hwi85MD_2LXYVR9YP4OQnHMjUXVLCsk9uQ8WZtQWtCc1jqeEmvM9S2ebGIBfTB8W8Vp3LTkXFFb3dzg")?this.$14:b("emptyFunction"),pageID:this.props.pageID,ref:function(a){return this.$4=a}.bind(this),threadColor:this.props.threadColor,viewerID:this.props.viewerID})):null};a.prototype.$6=function(){i.markRead(b("MercuryIDs").getThreadIDFromUserID(this.props.pageID))};a.prototype.$7=function(){this.$4&&this.$4.focus()};a.prototype.$13=function(){b("UnverifiedXD").send({type:"liveChatPluginBlurComposer"})};a.prototype.$14=function(){b("UnverifiedXD").send({type:"liveChatPluginFocusComposer"})};a.prototype.$12=function(){return/iPhone|iPad|iPod/.test(navigator.userAgent)};e.exports=a}),null);
__d("XMNPlatformCustomerChatPluginOpenThreadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/commerce/customer_chat_plugin/open_thread/",{page_id:{type:"FBID",required:!0},request_id:{type:"String",required:!0},referer_uri:{type:"String",required:!0},ref:{type:"String"}})}),null);
__d("LiveChatPlugin.react",["cx","Arbiter","AsyncRequest","CurrentUser","LiveChatIcebreakerClient","LiveChatMqttClient","LiveChatPluginDialogContainer.react","LiveChatPluginLoggerUtil","LiveChatPluginSessionUtil","MessengerLiveChatPluginEvent","MessengerState.bs","React","XMNPlatformCustomerChatPluginOpenThreadController","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MessengerState.bs").jsComponent;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={chatStarted:b("LiveChatPluginSessionUtil").getChatStarted(),hasMessagingPermission:this.props.hasMessagingPermission,loggedInGreeting:this.props.loggedInGreeting,loggedOutGreeting:this.props.loggedOutGreeting,refParam:this.props.refParam},this.$6=function(){this.props.onCloseButtonClick(),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").CHAT_DIALOG_CLOSED,this.props.viewerID,this.props.pageID)}.bind(this),this.$5=function(){this.props.onChatNowClick(),this.$3(),this.setState({chatStarted:!0,hasMessagingPermission:!0},function(){b("LiveChatPluginSessionUtil").setChatStarted(!0)})}.bind(this),this.$7=function(){var a=b("LiveChatPluginSessionUtil").getRefSent();if(!a){a=b("XMNPlatformCustomerChatPluginOpenThreadController").getURIBuilder().setFBID("page_id",this.props.pageID).setString("ref",this.state.refParam).setString("referer_uri",this.props.refererUri).setString("request_id",b("LiveChatPluginSessionUtil").getRequestID()).getURI();new(b("AsyncRequest"))().setURI(a).setAllowCrossPageTransition(!0).setMethod("POST").send();b("LiveChatPluginSessionUtil").setRefSent(!0)}}.bind(this),c}a.prototype.componentDidMount=function(){b("CurrentUser").isLoggedIn()||(this.setState({chatStarted:!1}),b("LiveChatPluginSessionUtil").setChatStarted(!1)),this.state.chatStarted&&this.state.hasMessagingPermission&&(this.$3(),b("LiveChatPluginSessionUtil").setChatStarted(!0)),this.$2=b("Arbiter").subscribe("Connect.Unsafe.updateCustomerChat",function(a,b){a={};var c=this.$4(b.logged_in_greeting),d=this.$4(b.logged_out_greeting);c!==null&&(a.loggedInGreeting=c);d!==null&&(a.loggedOutGreeting=d);b.ref&&(a.refParam=b.ref);this.setState(a)}.bind(this)),b("LiveChatPluginLoggerUtil").logAction(b("MessengerLiveChatPluginEvent").PLUGIN_LOADED,this.props.viewerID,this.props.pageID,JSON.stringify({greetingDialogDisplay:this.props.greetingDialogDisplay,greetingDialogDelay:this.props.greetingDialogDelay,isMobile:this.props.isMobile,reloaded:this.props.reloaded,isDialogHidden:b("LiveChatPluginSessionUtil").getIsDialogHidden(),isMuted:this.props.isMuted}),this.props.threadColor,this.state.loggedInGreeting,this.state.loggedOutGreeting)};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.disconnect(),this.$2&&b("Arbiter").unsubscribe(this.$2)};a.prototype.render=function(){return b("React").createElement("div",{className:"_30ss"},b("React").createElement(i,{fbid:this.props.viewerID},function(a){return b("React").createElement(b("LiveChatPluginDialogContainer.react"),{anchorIframeResizeFn:this.props.anchorIframeResizeFn,canSkipContinuousAs:this.props.canSkipContinuousAs,chatStarted:this.state.chatStarted,disableInput:this.props.disableInput,hasMenu:this.props.hasMenu,hasMessagingPermission:this.state.hasMessagingPermission,isLoggedIn:this.props.isLoggedIn,isMobile:this.props.isMobile,isMuted:this.props.isMuted,loggedInGreeting:this.state.loggedInGreeting,loggedOutGreeting:this.state.loggedOutGreeting,messengerState:a,onChatNowClick:this.$5,onCloseButtonClick:this.$6,pageID:this.props.pageID,pageName:this.props.pageName,pageProfilePictureUri:this.props.pageProfilePictureUri,pageResponsivenessText:this.props.pageResponsivenessText,readReceipt:this.props.readReceipt,refererUri:this.props.refererUri,sdkLocale:this.props.sdkLocale,threadColor:this.props.threadColor?this.props.threadColor:"#0084FF",viewerID:this.props.viewerID,viewerProfilePictureUri:this.props.viewerProfilePictureUri})}.bind(this)))};a.prototype.$3=function(){var a=b("gkx")("AT6c5YHVCTUix5Gwa--s9AxFgQaFVEg5JPpv1CaOrBZjkjH4j_C1GcnXrwDtlCc2JBmNslLjxJtrBz_0zcfaXV9_ZItnXCskBu0gl-oBcItejg"),c=this.props.isIESupported||b("gkx")("AT7JCav-mnZaXvxvDZIStsaHGOzW3wm3IcqOSc7xoesh9oMNPR0bSOyfLxBj6PCvVKOi8MrYYxdqv_TpZOkUtcGctqpnKAug6HnuZMaG4wXC1Q");a&&b("LiveChatMqttClient").setUp(this.props.pageID,this.props.viewerID,this.props.isIESupported,null,c?this.$7:null);this.$8();c||this.$7()};a.prototype.$8=function(){this.$1=new(b("LiveChatIcebreakerClient"))(this.props.pageID,this.props.viewerID,this.props.originDomain,this.props.isIESupported),this.$1&&this.$1.connectWithRetries()};a.prototype.$4=function(a){if(!a)return null;else if(Array.from(a).length>80)return null;else return a};e.exports=a}),null);
__d("LiveChatPluginBadgeSVG.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a={fontSize:"8px",text:this.props.unreadCount,cx:"12",cy:"8",rx:"8",ry:"8"};if(this.props.unreadCount===0)return null;else this.props.unreadCount>20?(a.text="20+",a.cx="11",a.rx="9"):this.props.unreadCount<10&&(a.fontSize="9px");return b("React").createElement("svg",{x:"40",y:"0",width:"20",height:"20"},b("React").createElement("ellipse",{cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry,fill:"#e8423e"}),b("React").createElement("text",{x:"12",y:"8",textAnchor:"middle",fill:"#ffffff",fontSize:a.fontSize,fontFamily:"Arial",dy:".4em"},a.text))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("LiveChatPluginMessengerIconSVG.react",["Arbiter","LiveChatPluginBadgeSVG.react","LiveChatPluginConstants","LiveChatPluginSessionUtil","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={unreadCount:this.props.unreadCount},this.$1=null,b}a.prototype.componentDidMount=function(){this.$1=b("Arbiter").subscribe(b("LiveChatPluginConstants").UNREAD_COUNT_UPDATE,function(a,b){this.setState({unreadCount:b})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1&&b("Arbiter").unsubscribe(this.$1)};a.prototype.render=function(){var a=this.props.threadColor?b("React").createElement("svg",{x:"0",y:"0",width:"60",height:"60"},b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("circle",{fill:this.props.threadColor,cx:"30",cy:"30",r:"30"}),b("React").createElement("g",{transform:"translate(10.000000, 11.000000)",fill:"#FFFFFF"},b("React").createElement("path",{d:"M0,18.7150914 C0,8.37723141 8.956743,0 20,0 C31.043257,0 40,8.37723141 40,18.7150914 C40,29.0529515 31.043257,37.4301829 20,37.4301829 C18,37.4301829 16.0763359,37.1551856 14.2544529,36.6459314 L6.95652174,40 L6.95652174,33.0434783 C2.44929143,29.6044708 0,24.5969773 0,18.7150914 Z M16.9276495,19.6993886 L22.109375,25.0798234 L33.0434783,13.4782609 L23.0672554,18.9962636 L17.890625,13.6158288 L6.95652174,25.2173913 L16.9276495,19.6993886 Z"})))))):b("React").createElement("svg",{x:"0",y:"0",width:"60",height:"60"},b("React").createElement("defs",null,b("React").createElement("linearGradient",{x1:"50%",y1:"100%",x2:"50%",y2:"0.000340050378%",id:"linearGradient-1"},b("React").createElement("stop",{stopColor:"#0068FF",offset:"4.5%"}),b("React").createElement("stop",{stopColor:"#00C6FF",offset:"95.5%"}))),b("React").createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},b("React").createElement("g",null,b("React").createElement("g",null,b("React").createElement("circle",{fill:"#FFFFFF",cx:"30",cy:"30",r:"30"}),b("React").createElement("g",{transform:"translate(10.000000, 11.000000)"},b("React").createElement("path",{d:"M0,18.7150914 C0,24.5969773 2.44929143,29.6044708 6.95652174,33.0434783 L6.95652174,40 L14.2544529,36.6459314 C16.0763359,37.1551856 18,37.4301829 20,37.4301829 C31.043257,37.4301829 40,29.0529515 40,18.7150914 C40,8.37723141 31.043257,0 20,0 C8.956743,0 0,8.37723141 0,18.7150914 Z",fill:"url(#linearGradient-1)"}),b("React").createElement("polygon",{fill:"#FFFFFF",points:"16.9378907 19.359375 7 25 17.8976562 13.140625 23.0570312 18.640625 33 13 22.1023437 24.859375"})))))),c=null;b("LiveChatPluginSessionUtil").getChatStarted()&&b("LiveChatPluginSessionUtil").getIsDialogHidden()&&(c=b("React").createElement(b("LiveChatPluginBadgeSVG.react"),{unreadCount:this.state.unreadCount}));return b("React").createElement("svg",{width:"60px",height:"60px",viewBox:"0 0 60 60"},a,c)};e.exports=a}),null);
__d("LiveChatGreetingDialogDisplayMode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({UNSET:"unset",SHOW:"show",HIDE:"hide",FADE:"fade"})}),null);
__d("LiveChatPluginMount",["Arbiter","Bootloader","CurrentUser","LiveChatGreetingDialogDisplayMode","LiveChatPlugin.react","LiveChatPluginLoggerUtil","LiveChatPluginMessengerIconSVG.react","LiveChatPluginQEUniverse","LiveChatPluginSessionUtil","MessengerLiveChatSettings","MessengerLiveChatPluginEvent","QE2Logger","React","ReactDOM","ShimButton.react","Style","UnverifiedXD","performanceAbsoluteNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.container,d=a.canSkipContinuousAs,e=a.disableInput,f=a.greetingDialogDisplay,g=a.greetingDialogDelay,h=a.greetingDialogFadeDelay,i=a.hasMenu,j=a.hasMessagingPermission,k=a.isIESupported,l=a.initSeqID,m=a.isMuted,n=a.loggedInGreeting,o=a.loggedOutGreeting,p=a.originDomain,q=a.pageID,r=a.pageName,s=a.pageProfilePictureUri,t=a.pageResponsivenessText;a.qeParameters;var u=a.readReceipt,v=a.refererUri,w=a.refParam,x=a.reloaded,y=a.requestID,z=a.sdkLocale,A=a.soundURLs,B=a.threadCSSColor,C=a.unreadCount;a=a.viewerProfilePictureUri;this.$13=function(){this.$16(),this.$15()}.bind(this);this.$12=function(){this.$16(),b("UnverifiedXD").send({type:this.$3?"liveChatPluginExpandMobileDialogIframe":"liveChatPluginExpandDesktopDialogIframe"})}.bind(this);var D=b("performanceAbsoluteNow")(),E=!b("LiveChatPluginSessionUtil").getSessionState();this.$3=/iPhone|iPod|iPad|Android|Mobile/i.test(navigator.userAgent);l||(l=0);var F=b("CurrentUser").isLoggedIn(),G=b("CurrentUser").getID();this.$7(j,p,q,x,y,G,f,g);F&&b("Bootloader").loadModules(["LiveChatPluginAlerts","MercurySyncDeltaHandler"],function(a,c){a.init(G,q,r,A,m,C),c.get(),b("Arbiter").inform("MercurySyncDeltaHandler/initSeqID",{fbid:G,seqID:l})},"LiveChatPluginMount");b("UnverifiedXD").send({type:this.$3?"liveChatPluginPrepareMobileAnchorIframe":"liveChatPluginPrepareDesktopAnchorIframe",chatStarted:b("LiveChatPluginSessionUtil").getChatStarted(),dialogHidden:this.$2});var H=b("React").createElement(b("ShimButton.react"),{onClick:function(){this.$8(G,q)}.bind(this),style:{cursor:"pointer",outline:"none"}},b("React").createElement(b("LiveChatPluginMessengerIconSVG.react"),{threadColor:B,unreadCount:C}));b("Arbiter").subscribeOnce("blankIframeAck",function(a,c){this.$1=c,b("ReactDOM").render(H,c.document.body),b("Style").set(c.document.body,"margin","0"),this.$9(C),this.$10(g,f,h,E)}.bind(this));b("ReactDOM").render(b("React").createElement(b("LiveChatPlugin.react"),{anchorIframeResizeFn:this.$11,canSkipContinuousAs:d,disableInput:e,greetingDialogDelay:g,greetingDialogDisplay:f,hasMenu:i,hasMessagingPermission:j,isIESupported:k,isLoggedIn:F,isMobile:this.$3,isMuted:m,loggedInGreeting:n,loggedOutGreeting:o,onChatNowClick:this.$12,onCloseButtonClick:this.$13,originDomain:p,pageID:q,pageName:r,pageProfilePictureUri:s,pageResponsivenessText:t,readReceipt:u!=null?Array.from(u).reduce(function(a,b){var c=b[0];b=b[1];return Object.assign(a,(a={},a[c]=b,a))},{}):null,refererUri:v,refParam:w,reloaded:x,sdkLocale:z,threadColor:B,viewerID:G,viewerProfilePictureUri:a}),c);this.$9(C);b("LiveChatPluginLoggerUtil").logTTI(G,q,D)}a.prototype.$10=function(a,c,d,e){__p&&__p();if(!e)return;e=!1;switch(c){case b("LiveChatGreetingDialogDisplayMode").FADE:e=!this.$3&&a>0;break;case b("LiveChatGreetingDialogDisplayMode").SHOW:e=a>0;break;case b("LiveChatGreetingDialogDisplayMode").UNSET:c=b("MessengerLiveChatSettings").qeSettings;if(!c||this.$3)break;b("QE2Logger").logExposureForUser(b("LiveChatPluginQEUniverse").CUSTOMER_CHAT_PLUGIN_QE_UNIVERSE);e=c.shouldPrompt&&c.promptDelayMs>0;a=c.promptDelayMs;break;case b("LiveChatGreetingDialogDisplayMode").HIDE:break;default:break}if(!e)return;this.$6=setTimeout(function(){this.$14(d)}.bind(this),a)};a.prototype.$14=function(a){this.$2&&(this.$15(),a&&(this.$5=setTimeout(function(){this.$2||this.$15()}.bind(this),a)))};a.prototype.$11=function(a){b("UnverifiedXD").send({type:"liveChatPluginResizeAnchorIframe",height:a})};a.prototype.$9=function(a){if(this.$1){b("UnverifiedXD").send({type:"liveChatPluginShowBubbleIframe",showBadge:a>0&&b("LiveChatPluginSessionUtil").getIsDialogHidden()});return}b("UnverifiedXD").send({type:"liveChatPluginGetBubbleIframe",isHTTPS:window.location.protocol==="https:",fromIframe:window.name})};a.prototype.$8=function(a,c){this.$16();this.$15();var d=b("LiveChatPluginSessionUtil").getChatStarted(),event=void 0;d?event=this.$2?b("MessengerLiveChatPluginEvent").CHAT_DIALOG_CLOSED:b("MessengerLiveChatPluginEvent").CHAT_DIALOG_OPENED:event=this.$2?b("MessengerLiveChatPluginEvent").CHAT_NOW_PROMPT_CLOSED:b("MessengerLiveChatPluginEvent").CHAT_NOW_PROMPT_OPENED;b("LiveChatPluginLoggerUtil").logAction(event,a,c)};a.prototype.$15=function(){this.$2=!this.$2,b("UnverifiedXD").send({type:this.$2?"liveChatPluginHideDialogIframe":"liveChatPluginShowDialogIframe",chatStarted:b("LiveChatPluginSessionUtil").getChatStarted(),isMobile:this.$3}),b("LiveChatPluginSessionUtil").setIsDialogHidden(this.$2)};a.prototype.$16=function(){this.$6&&clearTimeout(this.$6),this.$5&&clearTimeout(this.$5)};a.prototype.$7=function(a,c,d,e,f,g,h,i){e&&(f=b("LiveChatPluginSessionUtil").getRequestID(),b("LiveChatPluginSessionUtil").removeSessionState(b("LiveChatPluginSessionUtil").getCurrentSessionKey()));b("LiveChatPluginSessionUtil").setCurrentSessionKey(c,d,g);c=b("LiveChatPluginSessionUtil").getSessionState();!c?(e?this.$2=!1:h!==b("LiveChatGreetingDialogDisplayMode").UNSET?this.$2=h===b("LiveChatGreetingDialogDisplayMode").HIDE||i>0:!this.$3&&b("MessengerLiveChatSettings").qeSettings&&b("MessengerLiveChatSettings").qeSettings.promptDelayMs>0?this.$2=b("MessengerLiveChatSettings").qeSettings.shouldPrompt:this.$2=this.$3,b("LiveChatPluginSessionUtil").setSessionState({chatStarted:e,isDialogHidden:this.$2,requestID:f,refSent:!1})):(this.$2=b("LiveChatPluginSessionUtil").getIsDialogHidden(),a||b("LiveChatPluginSessionUtil").setChatStarted(!1),b("LiveChatPluginSessionUtil").setRequestID(f))};e.exports=a}),null);